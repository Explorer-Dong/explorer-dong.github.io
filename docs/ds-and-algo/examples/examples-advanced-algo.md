---
title: è¿›é˜¶ç®—æ³•ä¾‹é¢˜ç²¾è®²
---

!!! warning "æ–½å·¥ä¸­"
    æœªçº³å…¥å‰è¨€å¯¼è¯»è¡¨ä¸­çš„é¢˜ç›®è¡¨ç¤ºè¿˜æ²¡æœ‰æ›´æ–°ã€‚è®¡åˆ’åœ¨ 2025 å¹´ 5 æœˆå‰æ›´æ–°å®Œ [é…å¥—ä¹ é¢˜](./index.md) éƒ¨åˆ†çš„æ‰€æœ‰é¢˜è§£ã€‚

## å‰è¨€

æœ¬æ–‡ç²¾é€‰ä¸€äº›ã€Œè¿›é˜¶ç®—æ³•ã€çš„ä¾‹é¢˜å¹¶è¿›è¡Œè¯¦ç»†çš„åŸç†è®²è§£ä¸ä»£ç å®ç°ã€‚ç®—æ³•æ ‡ç­¾ä¸»è¦æ˜¯ã€ŒåŠ¨æ€è§„åˆ’ã€å­—ç¬¦ä¸²ã€è®¡ç®—å‡ ä½•ã€å›¾è®ºã€åšå¼ˆè®ºã€æ•°å­¦ã€ã€‚é¢˜ç›®æ¥æºä¸»è¦æ˜¯ Codeforcesã€æ´›è°·ã€LeetCodeã€‚

ä¸ºäº†æå‡é˜…è¯»æ•ˆç‡ï¼Œæˆ‘å°†é¢˜ç›®çš„é‡è¦å…ƒä¿¡æ¯å•ç‹¬ç½—åˆ—ä¸ºäº†ä¸€å¼ è¡¨æ ¼ï¼Œå¯ä»¥æŒ‰ç…§è‡ªå·±çš„å®é™…éœ€æ±‚æŒ‰éœ€è·³è½¬é˜…è¯»ã€‚

| æ ‡ç­¾ ğŸ· | éš¾åº¦ ğŸ”¥ |                       é“¾æ¥ ğŸ”—                        |        é”šç‚¹ âš“         | å¤‡æ³¨ â­ |
| :----: | :----: | :-------------------------------------------------: | :-------------------: | :----: |

/// caption | <
è¿›é˜¶ç®—æ³•ä¾‹é¢˜å¯¼è¯»è¡¨ï¼ˆæ‰“ * è¡¨ç¤ºè‡ªå·±é¢„ä¼°çš„éš¾åº¦ï¼‰
///

## åŠ¨æ€è§„åˆ’

![è¢«åŠ¨è½¬ç§» vs ä¸»åŠ¨è½¬ç§»](https://cdn.dwj601.cn/images/202408291538900.png)

åŠ¨æ€è§„åˆ’çš„ã€Œä¾‹é¢˜è§£æã€ã€‚

åŠ¨æ€è§„åˆ’åˆ†ä¸ºè¢«åŠ¨è½¬ç§»å’Œä¸»åŠ¨è½¬ç§»ï¼Œè€Œå…¶æ ¹æœ¬åœ¨äºçŠ¶æ€è¡¨ç¤ºå’ŒçŠ¶æ€è½¬ç§»ã€‚å¦‚ä½• **å®Œæ•´è¡¨ç¤º** æ‰€æœ‰çŠ¶æ€ï¼Ÿå¦‚ä½• **ä¸é‡ä¸æ¼** åˆ’åˆ†å­é›†ä»è€Œè¿›è¡ŒçŠ¶æ€è½¬ç§»ï¼Ÿ

### é€’æ¨

åè½¬å­—ç¬¦ä¸²ï¼š<https://www.acwing.com/problem/content/5574/>

> é¢˜æ„ï¼šç»™å®š n ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹åº”ä¸€ä¸ªä»£ä»· $w_i$ï¼Œç°åœ¨éœ€è¦å¯¹è¿™ n ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå¯èƒ½çš„ç¿»è½¬æ“ä½œä½¿å¾—æœ€ç»ˆçš„ n ä¸ªå­—ç¬¦ä¸²å‘ˆç°å­—å…¸åºä¸Šå‡çš„çŠ¶æ€ï¼Œç»™å‡ºæœ€å°ç¿»è½¬ä»£ä»·ã€‚
>
> æ€è·¯ï¼šå¾ˆæ˜¾ç„¶æ¯ä¸€ä¸ªå­—ç¬¦ä¸²éƒ½æœ‰ä¸¤ç§çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡ŒäºŒå‰æœç´¢æˆ–è€…äºŒè¿›åˆ¶æšä¸¾ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›è¡Œ dp å—ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹äºç¬¬ i ä¸ªå­—ç¬¦ä¸²ï¼Œæ˜¯å¦éœ€è¦ç¿»è½¬ä»…ä»…å–å†³äºç¬¬ i-1 ä¸ªå­—ç¬¦ä¸²çš„å¤§å°ï¼Œæ— åæ•ˆæ€§ï¼Œå¯ä»¥è¿›è¡Œé€’æ¨ã€‚æˆ‘ä»¬å®šä¹‰çŠ¶æ€æ•°ç»„ `f[i][j]` è¿›è¡ŒçŠ¶æ€æ ‡è¯†ã€‚å…¶ä¸­
>
> - `f[i][0]` è¡¨ç¤ºç¬¬ i ä¸ªå­—ç¬¦ä¸²ä¸éœ€è¦ç¿»è½¬æ—¶çš„æœ€å°ä»£ä»·
> - `f[i][1]` è¡¨ç¤ºç¬¬ i ä¸ªå­—ç¬¦ä¸²éœ€è¦ç¿»è½¬æ—¶çš„æœ€å°ä»£ä»·
>
> çŠ¶æ€è½¬ç§»å°±æ˜¯å½“å‰ä¸€ä¸ªå­—ç¬¦ä¸²æ¯”å½“å‰å­—ç¬¦ä¸²çš„å­—å…¸åºå°æ—¶è¿›è¡Œè½¬ç§»ï¼Œå³å½“å‰æœ€å°ä»£ä»·æ˜¯å‰ä¸€ä¸ªçŠ¶æ€çš„æœ€å°ä»£ä»·åŠ ä¸Šå½“å‰ç¿»è½¬çŠ¶æ€çš„ä»£ä»·ã€‚è‡³äºä»€ä¹ˆæ—¶å€™å¯ä»¥è¿›è¡ŒçŠ¶æ€è½¬ç§»ï¼Œä¸€å…±æœ‰ 4 ç§æƒ…å†µï¼Œå³ï¼š
>
> - `s[i-1]` ä¸ç¿»è½¬ï¼Œ`s[i]` ä¸ç¿»è½¬ã€‚æ­¤æ—¶ `f[i][0] = min(f[i][0], f[i-1][0])`
> - `s[i-1]` ç¿»è½¬ï¼Œ`s[i]` ä¸ç¿»è½¬ã€‚æ­¤æ—¶ `f[i][0] = min(f[i][0], f[i-1][1])`
> - `s[i-1]` ä¸ç¿»è½¬ï¼Œ`s[i]` ç¿»è½¬ã€‚æ­¤æ—¶ `f[i][1] = min(f[i][1], f[i-1][0] + w[i])`
> - `s[i-1]` ç¿»è½¬ï¼Œ`s[i]` ç¿»è½¬ã€‚æ­¤æ—¶ `f[i][1] = min(f[i][1], f[i-1][1] + w[i])`
>
> æœ€ç»ˆç­”æ¡ˆå°±åœ¨ `f[n][0]` å’Œ `f[n][1]` ä¸­å– `min` å³å¯
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
#include <iostream>
#include <cstring>
#include <algorithm>
using namespace std;
using ll = long long;

const int N = 100010;

int n, w[N];
string s[N][2];  // s[i][0] è¡¨ç¤ºåŸå§‹å­—ç¬¦ä¸²ï¼Œs[i][1] è¡¨ç¤ºåè½¬åçš„å­—ç¬¦ä¸²
ll f[N][2];      // f[i][j] è¡¨ç¤ºç¬¬iä¸ªå­—ç¬¦ä¸²åœ¨ç¿»è½¬çŠ¶æ€ä¸ºjçš„æƒ…å†µä¸‹çš„æœ€å°ä»£ä»·

ll dp() {
    f[1][0] = 0, f[1][1] = w[1];
    for (int i = 2; i <= n; i++) {
        if (s[i - 1][0] <= s[i][0]) f[i][0] = min(f[i][0], f[i - 1][0]);
        if (s[i - 1][1] <= s[i][0]) f[i][0] = min(f[i][0], f[i - 1][1]);
        if (s[i - 1][0] <= s[i][1]) f[i][1] = min(f[i][1], f[i - 1][0] + w[i]);
        if (s[i - 1][1] <= s[i][1]) f[i][1] = min(f[i][1], f[i - 1][1] + w[i]);
    }
    return min(f[n][0], f[n][1]);
}

int main() {
    cin >> n;
    for (int i = 1; i <= n; i++) cin >> w[i];
    for (int i = 1; i <= n; i++) {
        cin >> s[i][0];
        s[i][1] = s[i][0];
        reverse(s[i][1].begin(), s[i][1].end());
    }
    memset(f, 0x3f, sizeof f);
    
    ll res = dp();
    if (res == 0x3f3f3f3f3f3f3f3fll) res = -1;
    cout << res << "\n";
    
    return 0;
}
```

æœ€å¤§åŒ–å­æ•°ç»„çš„æ€»æˆæœ¬ï¼š<https://leetcode.cn/problems/maximize-total-cost-of-alternating-subarrays/>

> é¢˜æ„ï¼šç»™å®šé•¿åº¦ä¸º n çš„åºåˆ—ï¼Œç°åœ¨éœ€è¦å°†å…¶åˆ†å‰²ä¸ºå­æ•°ç»„ï¼Œå¹¶å®šä¹‰æ¯ä¸€ä¸ªå­æ•°ç»„çš„ä»·å€¼ä¸ºã€Œå¥‡æ•°ä½ç½®ä¸ºåŸæ•°å€¼ï¼Œå¶æ•°ä½ç½®ä¸ºç›¸åæ•°ã€ï¼Œè¿”å›æœ€å¤§åˆ†å‰²ä»·å€¼
>
> æ€è·¯ï¼š~~ä¸€å¼€å§‹è¿˜åœ¨æƒ³ç€å¦‚ä½•è´ªå¿ƒï¼Œå³ä»…è€ƒè™‘è¿ç»­çš„è´Ÿæ•°åŒºé—´ï¼Œä½†æ˜¯æ˜¾ç„¶çš„è´ªä¸å‡ºå…¨å±€æœ€ä¼˜è§£ã€‚~~ äºæ˜¯è½¬è€Œè€ƒè™‘æš´åŠ› dpã€‚æ€è·¯å’Œæœ´ç´  01 èƒŒåŒ…æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚
>
> - çŠ¶æ€å®šä¹‰ã€‚é¦–å…ˆæˆ‘ä»¬ä¸€å®šéœ€è¦æŒ‰ç…§å…ƒç´ è¿›è¡Œæšä¸¾ï¼Œå› æ­¤ç¬¬ä¸€ç»´åº¦æˆ‘ä»¬å°±å®šä¹‰ä¸ºåºåˆ—é•¿åº¦ï¼Œä½†æ˜¯ä»…ä»…è¿™æ ·å®šä¹‰å°±èƒ½è¡¨ç¤ºå…¨éƒ¨çš„çŠ¶æ€äº†å—ï¼Ÿæ˜¾ç„¶ä¸è¡Œã€‚æ ¹æ®é¢˜ç›®çš„å¥‡å¶ä»·å€¼çº¦æŸï¼Œæˆ‘ä»¬åœ¨åˆ¤å®šæ¯ä¸€ä¸ª **è´Ÿæ•°** æ˜¯å¦å¯ä»¥ã€Œå–ç›¸åæ•°ã€ä»·å€¼æ—¶ï¼Œæ˜¯å–å†³äºä¸Šä¸€ä¸ªè´Ÿæ•°æ˜¯å¦å–äº†ç›¸åæ•°ä»·å€¼ã€‚ä¸ºäº†ç»Ÿä¸€åŒ–ï¼Œæˆ‘ä»¬å°†æ­£è´Ÿæ•°ä¸€èµ·è€ƒè™‘å‰ä¸€ä¸ªæ•°æ˜¯å¦å–äº†ç›¸åä»·å€¼çš„æƒ…å†µï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å†å¢åŠ ã€Œå‰ä¸€ä¸ªæ•°æ˜¯å¦å–äº†ç›¸åä»·å€¼ã€çš„çŠ¶æ€è¡¨ç¤ºï¼Œè€Œè¿™ä»…ä»…æ˜¯ä¸€ä¸ªäºŒå€¼é€»è¾‘ï¼Œç›´æ¥å¼€ä¸¤ä¸ªç©ºé—´å³å¯ã€‚äºæ˜¯çŠ¶æ€å®šä¹‰å‘¼ä¹‹æ¬²å‡ºï¼š
>
>     - `f[i][0]` è¡¨ç¤ºç¬¬ `i` ä¸ªæ•°å– **åŸå§‹ä»·å€¼** çš„æƒ…å†µä¸‹ï¼Œåºåˆ— `[0, i-1]` çš„æœ€å¤§ä»·å€¼
>     - `f[i][1]` è¡¨ç¤ºç¬¬ `i` ä¸ªæ•°å– **ç›¸åä»·å€¼** çš„æƒ…å†µä¸‹ï¼Œåºåˆ— `[0, i-1]` çš„æœ€å¤§ä»·å€¼
>
> - çŠ¶æ€è½¬ç§»ã€‚æ˜¾ç„¶å¯¹äºä¸Šè¿°çŠ¶æ€å®šä¹‰ï¼Œä»…ä»…éœ€è¦å¯¹ã€Œè¿ç»­è´Ÿæ•°åŒºé—´ã€è¿›è¡Œè€ƒè™‘ï¼Œå› æ­¤å¯¹äº `nums[i] >= 0` çš„æƒ…å†µæ˜¯æ²¡æœ‰é€‰æ‹©çº¦æŸçš„ï¼ŒåŸå§‹ä»·å€¼å’Œç›¸åä»·å€¼éƒ½æ˜¯å¯è¡Œçš„æ–¹æ¡ˆé‚£ä¹ˆä¸ºäº†æœ€å¤§åŒ–æœ€ç»ˆæ”¶ç›Šæ˜¾ç„¶é€‰æ‹©åŸå§‹æ­£ä»·å€¼ï¼Œå¹¶ä¸”å¯ä»¥ä»ä¸Šä¸€ä¸ªæƒ…å†µçš„ä»»æ„çŠ¶æ€è½¬ç§»è¿‡æ¥é‚£ä¹ˆåŒæ ·ä¸ºäº†æœ€å¤§åŒ–æœ€ç»ˆå—ç›Šæ˜¾ç„¶é€‰æ‹©æœ€å¤§çš„åŸºçŠ¶æ€ï¼Œäºæ˜¯å¯å¾—ï¼š
>
>     - `f[i][0] = max(f[i-1][0], f[i-1][1]) + nums[i]`
>     - `f[i][1] = max(f[i-1][0], f[i-1][1]) - nums[i]`
>
>     è€Œå¯¹äº `nunms[i] < 0` çš„æƒ…å†µï¼Œèƒ½å¦é€‰æ‹©ç›¸åæ•°å–å†³äºå‰ä¸€ä¸ªæ•°çš„æ­£è´Ÿæ€§ã€‚å½“å‰ä¸€ä¸ªæ•° `nums[i-1] >= 0` æ—¶ï¼Œæ˜¾ç„¶å½“å‰è´Ÿæ•°åŸå§‹ä»·å€¼å’Œç›¸åä»·å€¼éƒ½å¯ä»¥å–åˆ°ï¼›å½“å‰ä¸€ä¸ªæ•° `nums[i-1] < 0` æ—¶ï¼Œåˆ™å½“å‰è´Ÿæ•°ä»…æœ‰åœ¨å‰ä¸€ä¸ªè´Ÿæ•°å–åŸå§‹ä»·å€¼çš„æƒ…å†µä¸‹æ‰èƒ½å–ç›¸åä»·å€¼ï¼Œäºæ˜¯å¯å¾—ï¼š
>
>     `if nums[i-1] >= 0`
>
>     - `f[i][0] = max(f[i-1][0], f[i-1][1]) + nums[i]`
>     - `f[i][1] = max(f[i-1][0], f[i-1][1] - nums[i])`
>
>     `if nums[i-1] < 0`
>
>     - `f[i][0] = max(f[i-1][0], f[i-1][1] + nums[i])`
>     - `f[i][1] = f[i-1][0] - nums[i]`
>
> - ç­”æ¡ˆè¡¨ç¤ºã€‚`max(f[n-1][0], f[n-1][1])`
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
class Solution {
public:
    long long maximumTotalCost(vector<int>& nums) {
        using ll = long long;

        int n =  nums.size();

        vector<vector<ll>> f(n, vector<ll>(2, 0));
        f[0][0] = f[0][1] = nums[0];
        for (int i = 1; i < n; i++) {
            if (nums[i] >= 0 || nums[i-1] >= 0) {
                f[i][0] = max(f[i-1][0], f[i-1][1]) + nums[i];
                f[i][1] = max(f[i-1][0], f[i-1][1]) - nums[i];
            } else {
                f[i][0] = max(f[i-1][0], f[i-1][1]) + nums[i];
                f[i][1] = f[i-1][0] - nums[i];
            }
        }

        return max(f[n-1][0], f[n-1][1]);
    }
};
```

```python
class Solution:
    def maximumTotalCost(self, nums: List[int]) -> int:
        n = len(nums)

        f = [[0] * 2 for _ in range(n)]
        f[0][0] = f[0][1] = nums[0]
        for i in range(1, n):
            if nums[i] >= 0 or nums[i-1] >= 0:
                f[i][0] = max(f[i-1][0], f[i-1][1]) + nums[i]
                f[i][1] = max(f[i-1][0], f[i-1][1]) - nums[i]
            else:
                f[i][0] = max(f[i-1][0], f[i-1][1]) + nums[i]
                f[i][1] = f[i-1][0] - nums[i]

        return max(f[n-1][0], f[n-1][1])
```

è´¹è§£çš„å¼€å…³

<https://www.acwing.com/problem/content/97/>

> é¢˜æ„ï¼šç»™å®š n ä¸ª `5*5` çš„çŸ©é˜µï¼Œä»£è¡¨å½“å‰å±€é¢ã€‚çŸ©é˜µä¸­æ¯ä¸€ä¸ªå…ƒç´ è¦ä¹ˆæ˜¯ 0 è¦ä¹ˆæ˜¯ 1ï¼Œç°åœ¨éœ€è¦è®¡ç®—ä»å½“å‰çŠ¶æ€æ“ä½œåˆ°å…¨ 1 çŠ¶æ€æœ€å°‘éœ€è¦å‡ æ¬¡æ“ä½œï¼Ÿæ“ä½œæè¿°ä¸ºæ”¹å˜å½“å‰çŠ¶æ€ä¸ºç›¸åçŠ¶æ€åï¼Œå››å‘¨çš„å››ä¸ªå…ƒç´ ä¹Ÿéœ€è¦æ”¹å˜ä¸ºç›¸åçš„çŠ¶æ€
>
> æ€è·¯ï¼šæˆ‘ä»¬é‡‡ç”¨é€’æ¨çš„æ€è·¯ã€‚ä¸ºäº†å°½å¯èƒ½å°‘çš„è¿›è¡ŒæŒ‰ç¯æ“ä½œï¼Œæˆ‘ä»¬ä»ç¬¬äºŒè¡Œå¼€å§‹è€ƒè™‘ï¼Œè‹¥å‰ä¸€è¡Œçš„æŸä¸€å…ƒç´ ä¸º 0ï¼Œåˆ™ä¸‹ä¸€è¡Œçš„åŒä¸€åˆ—ä½ç½®å°±éœ€è¦æŒ‰ä¸€ä¸‹ï¼Œä»¥æ­¤ç±»æ¨å°† $2 \to 5$ è¡Œå…¨éƒ¨æŒ‰å®Œã€‚ç°åœ¨è€ƒè™‘ä¸¤ç‚¹ï¼Œå½“å‰æŒ‰ä¸‹çŠ¶æ€æ˜¯å¦åˆæ³•ï¼Ÿå½“å‰æŒ‰ä¸‹çŠ¶æ€æ˜¯æ˜¯å¦æœ€ä¼˜ï¼Ÿ
> 1. å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼šä»ä¸Šè¿°æ€è·¯å¯ä»¥çœ‹å‡ºï¼Œ$1 \to n-1$ è¡Œä¸€å®šå…¨éƒ¨éƒ½æ˜¯ 1 çš„çŠ¶æ€ï¼Œä½†æ˜¯ç¬¬ $n-1$ è¡Œä¸ä¸€å®šå…¨ 1ï¼Œå› æ­¤ä¸åˆæ³•çŠ¶æ€å°±æ˜¯ç¬¬ $n-1$ è¡Œä¸å…¨ä¸º 1
> 2. å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼šå¯ä»¥å‘ç°ï¼Œä¸Šè¿°ç®—æ³•æ€è·¯ä¸­ï¼Œå¯¹äºç¬¬ä¸€è¡Œæ˜¯æ²¡æœ‰ä»»ä½•æ“ä½œçš„ï¼ˆå¯ä»¥å°†ç¬¬ä¸€è¡Œçœ‹åšé€’æ¨çš„åˆå§‹åŒ–æ¡ä»¶ï¼‰ï¼Œç¬¬ä¸€è¡Œçš„çŠ¶æ€å½±å“å…¨å±€çš„æ€»æ“ä½œæ•°ï¼Œæˆ‘ä»¬ä¸èƒ½ç¡®å®šä¸å¯¹ç¬¬ä¸€è¡Œè¿›è¡Œä»»ä½•æ“ä½œå¾—åˆ°çš„æ€»æ“ä½œæ•°å°±æ˜¯æœ€ä¼˜çš„ï¼Œæ•…æˆ‘ä»¬éœ€è¦å¯¹ç¬¬ä¸€è¡Œ 5 ä¸ªç¯è¿›è¡Œ **æšä¸¾** æŒ‰ä¸‹ã€‚æˆ‘ä»¬é‡‡ç”¨ 5 ä½äºŒè¿›åˆ¶çš„æ–¹æ³•å¯¹ç¬¬ä¸€è¡Œçš„ 5 ä¸ªç¯è¿›è¡Œæšä¸¾æŒ‰ä¸‹æ“ä½œï¼Œç„¶åå¯¹äºå½“å‰ç¬¬ä¸€è¡Œçš„æŒ‰ä¸‹å±€é¢ï¼ˆé€’æ¨åˆå§‹åŒ–çŠ¶æ€ï¼‰è¿›è¡Œ $2 \to n$ è¡Œçš„æŒ‰ä¸‹é€’æ¨æ“ä½œã€‚å¯¹äºæ¯ä¸€ç§åˆæ³•çŠ¶æ€æ›´æ–°æœ€å°çš„æ“ä½œæ•°å³å¯
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(T \times 2^5 \times 25 \times 5)$

```cpp
#include <bits/stdc++.h>
#define int long long
using namespace std;

const int N = 10;

char g[N][N], now[N][N];
int dx[] = {0, 1, -1, 0, 0}, dy[] = {0, 0, 0, 1, -1};

void turn(int x, int y) {
    for (int k = 0; k < 5; k++) {
        int nx = x + dx[k], ny = y + dy[k];
        now[nx][ny] ^= 1;
    }
}

void solve() {
    for (int i = 1; i <= 5; i++) {
        cin >> (g[i] + 1);
    }

    int res = 30;

    for (int op = 0; op < (1 << 5); op++) {
        memcpy(now, g, sizeof g);
        int step = 0;
        
        // ç»Ÿè®¡ç¬¬ 1 è¡Œçš„æŒ‰ä¸‹æ¬¡æ•°
        for (int i = 0; i < 5; i++) {
            if (op & (1 << i)) {
                step++;
                turn(1, 5 - i);
            }
        }
        
        // ç»Ÿè®¡ 2 ~ 5 è¡Œçš„æŒ‰ä¸‹æ¬¡æ•°
        for (int i = 1; i <= 4; i++) {
            for (int j = 1; j <= 5; j++) {
                if (now[i][j] == '0') {
                    step++;
                    turn(i + 1, j);
                }
            }
        }
        
        // åˆ¤æ–­å½“å‰æ“ä½œæ–¹æ¡ˆæ˜¯å¦åˆæ³•
        bool ok = true;
        for (int j = 1; j <= 5; j++) {
            if (now[5][j] == '0') {
                ok = false;
            }
        }
        
        // è‹¥å½“å‰æ“ä½œæ–¹æ¡ˆåˆæ³•åˆ™æ›´æ–°æœ€å°æ“ä½œæ¬¡æ•°
        if (ok) {
            res = min(res, step);
        }
    }
    
    cout << (res > 6 ? -1 : res) << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
    cin >> T;
    while (T--) solve();
    return 0;
}
```

Decode

<https://codeforces.com/contest/1996/problem/E>

> æ ‡ç­¾ï¼šé€’æ¨/çº¿æ€§ dp/å“ˆå¸Œ
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ª 01 å­—ç¬¦ä¸²ï¼Œé—®æ‰€æœ‰åŒºé—´ä¸­ 01 æ•°é‡ç›¸ç­‰çš„å­ä¸²æ€»å…±æœ‰å¤šå°‘ä¸ªã€‚
>
> æ€è·¯ï¼š
>
> - æˆ‘ä»¬å¯ä»¥æœ€ç›´æ¥çš„æƒ³åˆ° $O(n^5)$ çš„æš´åŠ›åšæ³•ï¼Œå³ $O(n^2)$ æšä¸¾åŒºé—´çš„å·¦å³ç«¯ç‚¹ï¼Œ$O(n^2)$ æšä¸¾åŒºé—´ä¸­å­ä¸²çš„å·¦å³ç«¯ç‚¹ï¼Œæœ€å $O(n)$ è¿›è¡Œæ£€æŸ¥è®¡æ•°ã€‚å½“ç„¶å¯ä»¥ç”¨å‰ç¼€å’Œä¼˜åŒ–æ‰ $O(n)$ çš„æ£€æŸ¥è®¡æ•°ã€‚ä½†è¿™æ ·åšæ˜¾ç„¶æ— æ³•é€šè¿‡ $10^5$ çš„æ•°æ®é‡ã€‚è€ƒè™‘åˆ«çš„æ€è·¯ã€‚
> - å®¹æ˜“æƒ³åˆ°åŠ¨æ€è§„åˆ’çš„æ€è·¯ã€‚æˆ‘ä»¬å®šä¹‰ `dp[i]` è¡¨ç¤ºå³ç«¯ç‚¹æ˜¯ `s[i]` çš„æ‰€æœ‰åŒºé—´ä¸­ï¼Œåˆæ³• 01 å­ä¸²çš„æ•°é‡ï¼Œé‚£ä¹ˆæ˜¾ç„¶ `dp[0] = s[i] == '1'`ã€‚ç°åœ¨è€ƒè™‘ `dp[i]` å¦‚ä½•è½¬ç§»ã€‚ä¸éš¾å‘ç°ä»¥ `s[i]` ä¸ºå³ç«¯ç‚¹çš„æ‰€æœ‰åŒºé—´ä¸€å®šåŒ…å«ä»¥ `s[i - 1]` ä¸ºå³ç«¯ç‚¹çš„æ‰€æœ‰åŒºé—´ï¼Œå¤šå‡ºæ¥çš„åˆæ³•å­ä¸²è¿›å­˜åœ¨äºä»¥ `s[i]` ç»“å°¾çš„å­ä¸²ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ä»¥ `s[i]` ç»“å°¾çš„åˆæ³•å­ä¸²æ•°é‡ä¸º `t`ï¼Œåˆ™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š`dp[i] = dp[i - 1] + t`ã€‚æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ»šåŠ¨å˜é‡æ¥ä»£æ›¿ dp æ•°ç»„ï¼Œè®°ä½œ nowï¼Œæ¯æ¬¡ç»´æŠ¤å®Œ now ä»¥åï¼Œå°†å…¶ç´¯åŠ åˆ°ç­”æ¡ˆå³å¯ã€‚ç°åœ¨æˆ‘ä»¬å°†æšä¸¾åŒºé—´ä» $O(n^2)$ é€šè¿‡é€’æ¨çš„æ€è·¯ä¼˜åŒ–åˆ°äº† $O(n)$ã€‚é‚£ä¹ˆå¦‚ä½•æ±‚è§£é€’æ¨å¼ä¸­çš„ `t` å‘¢ï¼Ÿ
> - é€šè¿‡ä¸€ä¸ªå° trick æ±‚è§£ã€Œä»¥ `s[i]` ç»“å°¾çš„åˆæ³•å­ä¸²ã€çš„æ•°é‡ã€‚æ˜¾ç„¶å¯ä»¥é€šè¿‡å‰ç¼€å’Œæšä¸¾ $j \in [1,i]$ ç»Ÿè®¡ä½¿å¾— `i - j + 1 == 2 * (pre[i] - pre[j - 1])` çš„æ•°é‡ã€‚ä½†æ˜¯è¿™æ ·å°±æ˜¯ $O(n^2)$ çš„äº†ï¼Œä»ç„¶æ— æ³•é€šè¿‡æœ¬é¢˜ã€‚å¼•å…¥ trickï¼šæˆ‘ä»¬ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å‰ç¼€å’Œçš„ç»´æŠ¤é€»è¾‘ï¼Œå³å½“ `s[i] == '0'` æ—¶ï¼Œå°†å…¶è®°ä½œ `-1`ï¼Œå½“ `s[i] == '1'` æ—¶ï¼Œä¿æŒä¸å˜ä»ç„¶è®°ä½œ `1`ã€‚è¿™æ ·æˆ‘ä»¬åœ¨å‘å‰æšä¸¾ `j` å¯»æ‰¾åˆæ³•åŒºé—´æ—¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åœ¨å¯»æ‰¾ `pre[i] - pre[j - 1] == 0`ï¼Œå³ `pre[j - 1] == pre[i]` çš„ä¸ªæ•°ã€‚å‡è®¾ä¸‹æ ‡ä» 0 å¼€å§‹ï¼Œåˆ™æ¯æ‰¾åˆ°ä¸€ä¸ªåˆæ³•çš„ `j`ï¼Œéƒ½ä¼šå¯¹ç­”æ¡ˆè´¡çŒ® `j + 1`ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦å“ˆå¸Œå­˜å‚¨æ¯ä¸€ä¸ªå‰ç¼€å’Œå¯¹åº”çš„ä¸‹æ ‡ç´¯è®¡å€¼å³å¯ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
#include <bits/stdc++.h>

using ll = long long;
using namespace std;

void solve() {
    string s;
    cin >> s;
    
    int n = s.size();
    vector<ll> pre(n + 1);
    for (int i = 0; i < n; i++) {
        pre[i + 1] = pre[i] + (s[i] == '0' ? -1 : 1);
    }
    
    auto add = [&](ll x, ll y) {
        ll mod = 1e9 + 7;
        return ((x % mod) + (y % mod)) % mod;
    };
    
    ll res = 0, now = 0;
    unordered_map<ll, ll> f;
    for (ll i = 0; i <= n; i++) {
        now = add(now, f[pre[i]]);
        res = add(res, now);
        f[pre[i]] += i + 1;
    }
    
    cout << res << "\n";
}

signed main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    int T = 1;
    std::cin >> T;
    while (T--) solve();
    return 0;
}
```

Squaring

<https://codeforces.com/contest/1995/problem/C>

> æ ‡ç­¾ï¼šé€’æ¨ã€æ•°å­¦
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªåºåˆ—ï¼Œå¯ä»¥å¯¹å…¶ä¸­ä»»ä½•ä¸€ä¸ªæ•°è¿›è¡Œä»»æ„æ¬¡å¹³æ–¹æ“ä½œï¼Œå³ $a_i \to a_i^2$ï¼Œé—®æœ€å°‘éœ€è¦æ‰§è¡Œå¤šå°‘æ¬¡æ“ä½œå¯ä»¥ä½¿å¾—åºåˆ—ä¸å‡ã€‚
>
> æ€è·¯ï¼š
>
> - é¦–å…ˆæ˜¾ç„¶çš„æˆ‘ä»¬ä¸å¸Œæœ›ç¬¬ä¸€ä¸ªæ•° $a_0$ å˜å¤§ï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥ä»ç¬¬äºŒä¸ªæ•°å¼€å§‹å’Œå‰ä¸€ä¸ªæ•°è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œè¿›è¡Œå¯èƒ½çš„å¹³æ–¹æ“ä½œå¹¶è®¡æ•°ã€‚ä½†æ˜¯ç”±äºæ•°å­—å¯èƒ½ä¼šå¾ˆå¤§ï¼Œä½¿ç”¨é«˜ç²¾åº¦æ˜¾ç„¶ä¼šè¶…æ—¶ï¼Œè€Œè¿™äº›æ•°å­—æœ¬èº«çš„æ„ä¹‰æ˜¯ç”¨æ¥å’Œå‰ä¸€ä¸ªæ•°è¿›è¡Œå¤§å°æ¯”è¾ƒçš„ï¼Œå¹¶ä¸”å˜åŒ–çš„å½¢å¼ä¹Ÿä»…ä»…æ˜¯å¹³æ–¹æ“ä½œã€‚æˆ‘ä»¬ä¸å¦¨ç»´æŠ¤å…¶æŒ‡æ•°ï¼Œè¿™æ ·æ—¢å¯ä»¥è¿›è¡Œå¤§å°æ¯”è¾ƒï¼Œä¹Ÿä¸ç”¨å­˜å‚¨æ•°å­—æœ¬èº«è€Œé€ æˆæº¢å‡ºã€‚å½“ç„¶å˜ä¸ºä½¿ç”¨æŒ‡æ•°å­˜å‚¨ä»¥åå¦‚ä½•è¿›è¡Œå¤§å°æ¯”è¾ƒä»¥åŠå¦‚ä½•ç»´æŠ¤æŒ‡æ•°åºåˆ—æœ‰æ‰€ä¸åŒï¼Œæˆ‘ä»¬å…ˆä»ä¸€èˆ¬çš„è§’åº¦å‡ºå‘ï¼Œè¿›è€Œä»è¡¨è¾¾å¼æœ¬èº«çš„æ•°å­¦è§’åº¦è®¨è®ºç‰¹æ®Šæƒ…å†µçš„å¤„ç†ã€‚
>
> - å¯¹äºå½“å‰æ•°å­— $a_i$ å’Œå‰ä¸€ä¸ªæ•°å­— $a_{i-1}$ åŠå…¶æŒ‡æ•° $z_{i-1}$ï¼Œå¦‚æœæƒ³è¦å½“å‰æ•°å­—ç»è¿‡å¯èƒ½çš„ k æ¬¡å¹³æ–¹æ“ä½œåä¸å°äºå‰ä¸€ä¸ªæ•°ï¼Œå³ $\displaystyle a_{i-1}^{2^{z_{i-1}}}\le a_i^{2^{k}}$ï¼Œåˆ™æ˜“å¾—ä¸‹é¢çš„è¡¨è¾¾å¼ï¼š
>
>     $$
>     k:= z_{i-1}+ \left\lceil \log_2(\frac{\log_2 {a_{i-1}}}{\log_2{a_i}}) \right \rceil
>     $$
>
>     ç”±äº $a_j \in [1, 10^6],z_j\ge 0,k \ge 0$ï¼Œå› æ­¤æˆ‘ä»¬æœ‰å¿…è¦ï¼š
>
>     1. è®¨è®º $a_i$ å’Œ $a_{i-1}$ å’Œ $1$ çš„å¤§å°å…³ç³»ã€‚å› ä¸ºå®ƒä»¬çš„å¯¹æ•°è®¡ç®—ç»“æœåœ¨çœŸæ•°éƒ¨åˆ†ã€‚
>     2. è®¨è®º $k$ å’Œ $0$ çš„å¤§å°å…³ç³»ã€‚å› ä¸ºä¸€æ—¦ $a_{i-1} < a_i$ï¼Œåˆ™æœ‰å¯èƒ½å‡ºç°è®¡ç®—ç»“æœä¸ºè´Ÿçš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µè¡¨æ˜éœ€è¦å¯¹å½“å‰æ•° $a_i$ è¿›è¡Œå¼€æ ¹çš„æ“ä½œã€‚åˆç”±äº $a_i\ge1$ï¼Œå› æ­¤å¼€æ ¹æ“ä½œå°±è¡¨æ˜å‡å°å½“å‰çš„æ•°ï¼Œä¹Ÿå°±è¡¨æ˜å½“å‰æ•°åœ¨ä¸è¿›è¡Œå¹³æ–¹æ“ä½œçš„æƒ…å†µä¸‹å°±å·²ç»æ»¡è¶³ä¸å‡çš„æ¡ä»¶äº†ï¼Œä¹Ÿå°±ä¸éœ€è¦æ“ä½œäº†ã€‚æ­¤æ—¶å¯¹åº”çš„æŒ‡æ•° $z_i$ å°±æ˜¯ $0$ï¼Œå¯¹äºç­”æ¡ˆçš„è´¡çŒ®ä¹Ÿæ˜¯ $0$ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
#include <bits/stdc++.h>

using ll = long long;
using namespace std;

void solve() {
    int n;
    cin >> n;
    
    vector<int> a(n);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }
    
    vector<ll> z(n, 0);
    ll res = 0;
    for (int i = 1; i < n; i++) {
        if (a[i] == 1 && a[i - 1] > 1) {
            cout << -1 << "\n";
            return;
        } else if (a[i] == 1 && a[i - 1] == 1 || a[i - 1] == 1) {
            continue;
        }
        ll t = z[i - 1] + ceil(log2(log2(a[i - 1]) / log2(a[i])));
        z[i] = max(0ll, t);
        res += z[i];
    }
    
    cout << res << "\n";
}

signed main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    int T = 1;
    std::cin >> T;
    while (T--) solve();
    return 0;
}
```

```python
from typing import List, Tuple
from collections import defaultdict, deque
from itertools import combinations, permutations
import math, heapq, queue

II = lambda: int(input())
FI = lambda: float(input())
MII = lambda: tuple(map(int, input().split()))
LII = lambda: list(map(int, input().split()))


def solve() -> None:
    n = II()
    a = LII()
    
    z = [0] * n
    for i in range(1, n):
        if a[i] == 1 and a[i - 1] > 1:
            print(-1)
            return
        elif a[i] == 1 and a[i - 1] == 1 or a[i - 1] == 1:
            continue
        t = z[i - 1] + math.ceil(math.log2(math.log2(a[i - 1]) / math.log2(a[i])))
        z[i] = max(0, t)
        
    print(sum(z))


if __name__ == '__main__':
    T = 1
    T = II()
    while T: solve(); T -= 1
```

ç‰›çš„è¯­è¨€å­¦

<https://www.acwing.com/problem/content/description/5559/>

> æ ‡ç­¾ï¼šé€’æ¨ã€dfs
>
> é¢˜æ„ï¼šå·²çŸ¥ä¸€ä¸ªå­—ç¬¦ä¸²ç”±å‰æ®µçš„ä¸€ä¸ªè¯æ ¹å’Œåæ®µçš„å¤šä¸ªè¯ç¼€ç»„æˆã€‚è¯æ ¹çš„è¦æ±‚æ˜¯é•¿åº¦è‡³å°‘ä¸º 5ï¼Œè¯ç¼€çš„è¦æ±‚æ˜¯é•¿åº¦è¦ä¹ˆæ˜¯ 2, è¦ä¹ˆæ˜¯ 3ï¼Œä»¥åŠä¸å…è®¸è¿ç»­çš„ç›¸åŒè¯ç¼€ç»„æˆåæ®µã€‚ç°åœ¨ç»™å®šæœ€ç»ˆçš„å­—ç¬¦ä¸²ï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ç§è¯ç¼€ï¼ŸæŒ‰ç…§å­—å…¸åºè¾“å‡ºæ‰€æœ‰å¯èƒ½çš„è¯ç¼€
>
> - æ€è·¯ä¸€ï¼š**æœç´¢**ã€‚å¾ˆæ˜¾ç„¶æˆ‘ä»¬åº”è¯¥ä»å­—ç¬¦ä¸²çš„æœ€åå¼€å§‹æšä¸¾è¯ç¼€è¿›è¡Œæœç´¢ï¼Œå› ä¸ºè¯ç¼€å‰é¢çš„æ‰€æœ‰å­—ç¬¦å…¨éƒ¨éƒ½å¯ä»¥ä½œä¸ºè¯æ ¹åˆæ³•å­˜åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘å½“å‰åˆ’åˆ†å‡ºæ¥çš„è¯ç¼€æ˜¯å¦åˆæ³•å³å¯ã€‚çº¦æŸåªæœ‰ä¸€ä¸ªï¼Œä¸èƒ½ä¸åé¢åˆ’åˆ†å‡ºæ¥çš„è¯ç¼€ç›¸åŒå³å¯ï¼Œç”±äºæˆ‘ä»¬æ˜¯ä»åå¾€å‰æœç´¢ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æœç´¢æ—¶ä¿ç•™åä¸€ä¸ªè¯ç¼€å³å¯ã€‚å¦‚æœå½“å‰è¯ç¼€å’Œä¸Šä¸€ä¸ªè¯ç¼€ç›¸åŒåˆ™è¿”å›ï¼Œåä¹‹å¦‚æœåˆæ³•åˆ™åŠ å…¥ set è‡ªåŠ¨è¿›è¡Œå­—å…¸åºæ’åºã€‚
>
>     æ—¶é—´å¤æ‚åº¦ï¼š$O(2^{\frac{n}{2}})$
>
> - æ€è·¯äºŒï¼š**åŠ¨æ€è§„åˆ’ï¼ˆé€’æ¨ï¼‰**ã€‚åŠ¨è§„å…¶å®å°±æ˜¯ **dfs çš„é€†è¿‡ç¨‹**ï¼Œæˆ‘ä»¬ä»å·²çŸ¥ç»“æœåˆ¤æ–­å½“å‰å±€é¢æ˜¯å¦åˆæ³•ã€‚å¾ˆæ˜¾ç„¶è¯æ ¹æ˜¯åŒ…ç½—ä¸‡è±¡çš„ï¼Œåªè¦é•¿åº¦åˆæ³•ï¼Œä¸ç®¡ä»€ä¹ˆæ ·çš„éƒ½æ˜¯å¯è¡Œçš„ï¼Œæ•…æˆ‘ä»¬åœ¨åˆ¤æ–­å½“å‰å±€é¢æ˜¯å¦åˆæ³•æ—¶ï¼Œåªéœ€è¦åˆ¤æ–­å½“å‰è¯ç¼€æ˜¯å¦åˆæ³•å³å¯ã€‚äºæ˜¯ä¾¿å¯çŸ¥å½“å‰çŠ¶æ€æ˜¯ä»åé¢çš„å­—ç¬¦ä¸²è½¬ç§»è¿‡æ¥çš„ã€‚æˆ‘ä»¬å®šä¹‰çŠ¶æ€è½¬ç§»è®°å¿†æ•°ç»„ `f[i]` è¡¨ç¤ºå­—ç¬¦ä¸² `s[1,i]` æ˜¯å¦å¯ä»¥ç»„æˆè¯æ ¹ã€‚å¦‚æœ `f[i]` ä¸ºçœŸï¼Œåˆ™è¡¨ç¤º `s[1,i]` ä¸ºä¸€ä¸ªåˆæ³•çš„è¯æ ¹ï¼Œ`s[i+1,n]` ä¸ºä¸€ä¸ªåˆæ³•çš„è¯ç¼€ä¸²ï¼Œé‚£ä¹ˆè¯æ ¹åé¢ç´§è·Ÿç€çš„ä¸€å®šæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 2 æˆ– 3 çš„åˆæ³•è¯ç¼€ã€‚
>
>     - æˆ‘ä»¬ä»¥ç´§è·Ÿç€é•¿åº¦ä¸º 2 çš„åˆæ³•è¯ç¼€ä¸ºä¾‹ã€‚å¦‚æœ `s[i+1,i+2]` ä¸ºä¸€ä¸ªåˆæ³•çš„è¯ç¼€ï¼Œåˆ™å¿…é¡»è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€
>         1. `s[i+1,i+2]` ä¸ `s[i+3,i+4]` ä¸ç›¸ç­‰ï¼Œå³åé¢çš„åé¢æ˜¯ä¸€ä¸ªé•¿åº¦ä¹Ÿä¸º **2** ä¸”åˆæ³•çš„è¯ç¼€
>         2. `s[1,i+5]` æ˜¯ä¸€ä¸ªåˆæ³•çš„è¯æ ¹ï¼Œå³ `f[i+5]` æ ‡è®°ä¸ºçœŸï¼Œå³åé¢çš„åé¢æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º **3** ä¸”åˆæ³•çš„è¯ç¼€
>
>     - ä»¥ç´§è·Ÿç€é•¿åº¦ä¸º 3 çš„å“ˆæ³•è¯ç¼€åŒç†ã€‚å¦‚æœ `s[i+1,i+3]` ä¸ºä¸€ä¸ªåˆæ³•çš„è¯ç¼€ï¼Œåˆ™å¿…é¡»è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€
>         1. `s[i+1,i+3]` ä¸ `s[i+4,i+6]` ä¸ç›¸ç­‰ï¼Œå³åé¢çš„åé¢æ˜¯ä¸€ä¸ªé•¿åº¦ä¹Ÿä¸º **3** ä¸”åˆæ³•çš„è¯ç¼€
>         2. `s[1,i+5]` æ˜¯ä¸€ä¸ªåˆæ³•çš„è¯æ ¹ï¼Œå³ `f[i+5]` æ ‡è®°ä¸ºçœŸï¼Œå³åé¢çš„åé¢æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º **2** ä¸”åˆæ³•çš„è¯ç¼€
>
>     æ—¶é—´å¤æ‚åº¦ï¼š$O(n \log n)$ - `dp` çš„è¿‡ç¨‹æ˜¯çº¿æ€§çš„ï¼Œä¸»è¦æ—¶é—´å¼€é”€åœ¨ `set` çš„è‡ªåŠ¨æ’åºä¸Š

dfs ä»£ç 

```cpp
#include <iostream>
#include <cstring>
#include <vector>
#include <queue>
#include <stack>
#include <algorithm>
#include <unordered_map>
#include <set>
using namespace std;

string s;
set<string> res;

// å½“å‰è¯ç¼€èµ·å§‹ä¸‹æ ‡ idxï¼Œå½“å‰è¯ç¼€é•¿åº¦ lengthï¼Œåæ–¹ç›¸é‚»çš„è¯ç¼€ post
void dfs(int idx, int length, string post) {
    if (idx <= 5) return;
    
    string now = s.substr(idx, length);

    if (now == post) {
        // ä¸åˆæ³•ç›´æ¥è¿”å›
        return;
    } else {
        // åˆæ³•åˆ™å°†å½“å‰è¯ç¼€åŠ å…¥é›†åˆè‡ªåŠ¨æ’åºï¼Œå¹¶ç»§ç»­æœç´¢æ¥ä¸‹æ¥å¯èƒ½çš„è¯ç¼€
        res.insert(now);
        dfs(idx - 2, 2, now);
        dfs(idx - 3, 3, now);
    }
}

void solve() {
    cin >> s;
    s = "$" + s;
    
    int tail_point = s.size();

    dfs(tail_point - 2, 2, "");
    dfs(tail_point - 3, 3, "");
    
    cout << res.size() << "\n";
    for (auto& str: res) cout << str << "\n";
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

dp ä»£ç 

```cpp
#include <iostream>
#include <cstring>
#include <vector>
#include <queue>
#include <stack>
#include <algorithm>
#include <unordered_map>
#include <set>
using namespace std;

const int N = 50010;

string s;
set<string> res;
bool f[N]; // f[i] è¡¨ç¤º s[1,i] æ˜¯å¦å¯ä»¥ä½œä¸ºè¯æ ¹å­˜åœ¨

void solve() {
    cin >> s;
    s = "$" + s;
    
    // å­—ç¬¦ä¸²å®šä¹‰åœ¨ [1,n] ä¸Š
    int n = s.size() - 1;
    
    // é•¿åº¦ä¸º n çš„å­—ç¬¦ä¸²ä¸€å®šå¯ä»¥ä½œä¸ºè¯æ ¹
    f[n] = true;
    
    for (int i = n; i >= 5; i--) {
        for (int len = 2; len <= 3; len++) {
            if (f[i + len]) {
                string a = s.substr(i + 1, len);
                string b = s.substr(i + 1 + len, len);
                if (a != b || f[i + 5]) {
                    res.insert(a);
                    f[i] = true;
                }
            }
        }
    }
    
    cout << res.size() << "\n";
    
    for (auto& x: res) cout << x << "\n";
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

### çº¿æ€§ dp

æœ€å°åŒ–ç½‘ç»œå¹¶å‘çº¿ç¨‹åˆ†é…

<https://vijos.org/d/nnu_contest/p/1492>

> é¢˜æ„ï¼šç°åœ¨æœ‰ä¸€ä¸ªçº¿æ€§ç½‘ç»œéœ€è¦åˆ†é…å¹¶å‘çº¿ç¨‹ï¼Œæ¯ä¸€ä¸ªç½‘ç»œæœ‰ä¸€ä¸ªæƒé‡ï¼Œç°åœ¨æœ‰ä¸€ä¸ªçº¿ç¨‹åˆ†é…è§„åˆ™ã€‚å¯¹äºå½“å‰ç½‘ç»œï¼Œå¦‚æœæƒé‡æ¯”ç›¸é‚»çš„ç½‘ç»œå¤§ï¼Œåˆ™çº¿ç¨‹å°±å¿…é¡»æ¯”ç›¸é‚»çš„ç½‘ç»œå¤§ã€‚
>
> æ€è·¯ï¼šæˆ‘ä»¬ä»ç­”æ¡ˆè§’åº¦æ¥çœ‹ï¼Œå¯¹äºä¸€ä¸ªç½‘ç»œï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å®ƒçš„ç›¸é‚»çš„å·¦è¾¹çº¿ç¨‹æ•°å’Œå³è¾¹çº¿ç¨‹æ•°ï¼Œå¦‚æœå½“å‰ç½‘ç»œæ¯”å·¦è¾¹å’Œå³è¾¹çš„æƒé‡éƒ½å¤§ï¼Œåˆ™å°±æ˜¯å·¦å³çº¿ç¨‹æ•°çš„æœ€å¤§å€¼+1ï¼Œå½“ç„¶è¿™äº›çš„ **å‰ææ˜¯å·¦å³çº¿ç¨‹æ•°å·²ç»æ˜¯æœ€ä¼˜çš„çŠ¶æ€**ï¼Œå› æ­¤æˆ‘ä»¬è¦å…ˆæ±‚â€œå·¦å³çº¿ç¨‹â€ã€‚åˆ†æå¯çŸ¥ï¼Œå·¦çº¿ç¨‹åªå–å†³äºå·¦è¾¹çš„æƒé‡ä¸çº¿ç¨‹æ•°ï¼Œå³çº¿ç¨‹åŒæ ·åªå–å†³äºå³è¾¹çš„æƒé‡å’Œçº¿ç¨‹æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åŒå‘æ‰«æä¸€éå³å¯æ±‚å¾—â€œå·¦å³çº¿ç¨‹â€ã€‚æœ€åæ ¹æ®â€œå·¦å³çº¿ç¨‹â€å³å¯æ±‚å¾—æ¯ä¸€ä¸ªç‚¹çš„æœ€ä¼˜çŠ¶æ€ã€‚

```cpp
void solve() {
    int n; cin >> n;
    vector<int> w(n + 1), l(n + 1, 1), r(n + 1, 1);
    for (int i = 1; i <= n; i++) {
        cin >> w[i];
    }
    for (int i = 2, j = n - 1; i <= n && j >= 1; i++, j--) {
        if (w[i] > w[i - 1]) {
            l[i] = l[i - 1] + 1;
        }
        if (w[j] > w[j + 1]) {
            r[j] = r[j + 1] + 1;
        }
    }
    int res = 0;
    for (int i = 1; i <= n; i++) {
        res += max(l[i], r[i]);
    }
    cout << res << "\n";
}
```

Block Sequence

<https://codeforces.com/contest/1881/problem/E>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªé•¿ä¸º $n\le 2\times 10^5$ çš„æ•°ç»„ aï¼Œé—®æœ€å°‘å¯ä»¥åˆ é™¤å…¶ä¸­çš„å‡ ä¸ªå…ƒç´ ï¼Œä½¿å¾—æœ€ç»ˆçš„æ•°ç»„å¯ä»¥è¢«åˆ’åˆ†ä¸ºè¿ç»­çš„å­æ•°ç»„ä¸”æ¯ä¸€ä¸ªå­æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å‡ä¸ºã€Œå­æ•°ç»„é¦–å…ƒç´ æ•°å€¼ $-1$ã€çš„å½¢å¼ã€‚
>
> æ€è·¯ï¼š
>
> - é¦–å…ˆå¯ä»¥çœ‹å‡ºï¼Œåºåˆ—çš„é¦–å…ƒç´ ä¸€å®šæ˜¯å¯¹åº”å­æ•°ç»„å‰©ä½™å…ƒç´ çš„ä¸ªæ•°ã€‚æˆ‘ä»¬ä¸å¦¨å€’åºæšä¸¾æ¯ä¸€ä¸ªå…ƒç´ å¹¶å®šä¹‰ `f[i]` è¡¨ç¤ºä½¿æ•°ç»„ `a[i:]` ç¬¦åˆå®šä¹‰çš„æœ€å°åˆ é™¤æ¬¡æ•°ï¼Œè¿™æ ·æ¯æ¬¡æšä¸¾åˆ°çš„å…ƒç´ éƒ½ä¸€å®šæ˜¯æ‰€åœ¨å­æ•°ç»„çš„é¦–å…ƒç´ ã€‚
> - æ¥ä¸‹æ¥è€ƒè™‘çŠ¶æ€è½¬ç§»ã€‚å¯¹äºå½“å‰æšä¸¾åˆ°çš„å…ƒç´  `a[i]`ï¼Œå¦‚æœä¸åˆ é™¤ï¼Œåˆ™ `f[i]` å°†ä» `f[i+a[i]+1]` è½¬ç§»è¿‡æ¥ï¼›å¦‚æœåˆ é™¤ï¼Œåˆ™ `f[i]` å°†ä» `f[i+1]` è½¬ç§»è¿‡æ¥ã€‚ä¸¤è€…å–æœ€å°å€¼å³å¯ã€‚
>
> æ—¶é—´å¤æ‚åº¦ $O(n)$

```python
def solve() -> Optional:
    n = II()
    a = LII()
    f = [INF] * (n + 1)
    f[n] = 0
    for i in range(n - 1, -1, -1):
        f[i] = f[i + 1] + 1
        if i + a[i] + 1 <= n:
            f[i] = min(f[i], f[i + a[i] + 1])
    return f[0]
```

è¦†ç›–å¢™å£

<https://www.luogu.com.cn/problem/P1990>

> é¢˜æ„ï¼šç»™å®šä¸¤ç§ç –å—ï¼Œåˆ†åˆ«ä¸ºæ—¥å­—å‹ä¸ L å‹ï¼Œé—®é“ºæ»¡ $2*n$ çš„åœ°æ¿ä¸€å…±æœ‰å¤šå°‘ç§é“ºæ³•
>
> æ€è·¯ï¼š
>
> - æˆ‘ä»¬é‡‡ç”¨é€’æ¨çš„æ€è·¯
> - $define:$ `f[i]` è¡¨ç¤ºé“ºæ»¡å‰ $2*i$ ä¸ªåœ°æ¿çš„æ–¹æ¡ˆæ•°ï¼Œ`g[i]` è¡¨ç¤ºé“ºæ»¡å‰ $2*i+1$ å—åœ°æ¿çš„æ–¹æ¡ˆæ•°
> - $base:$ `f[0] = 1, f[1] = 1, g[0] = 0, g[1] = 1`
> - $dp:$ `f[i] = f[i-1] + f[i-2] + g[i-1]` $||$ `g[i] = f[i-1] + g[i-1]`
> - $result:$ `f[n]`
>
> æ‰‹ç»˜ï¼š
>
> ![å›¾ä¾‹](https://cdn.dwj601.cn/images/202402012332894.png)
>
> ![å›¾ä¾‹](https://cdn.dwj601.cn/images/202403181626377.png)

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 1000010, mod = 10000;

int n;
int f[N], g[N];

void solve() {
    cin >> n;

    // base
    f[0] = 1, f[1] = 1;
    g[0] = 0, g[1] = 1;

    // dp
    for (int i = 2; i <= n; i++) {
        f[i] = (f[i - 1] + f[i - 2] + 2 * g[i - 2]) % mod;
        g[i] = (f[i - 1] + g[i - 1]) % mod;
    }

    // result
    cout << f[n] << "\n";
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

æ–½å’’çš„æœ€å¤§æ€»ä¼¤å®³

<https://leetcode.cn/problems/maximum-total-damage-with-spell-casting/>

> æ ‡ç­¾ï¼šçº¿æ€§ dp
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œé€‰æ‹©ä¸€ä¸ªå­åºåˆ—ä½¿å¾—æ€»å’Œæœ€å¤§ã€‚çº¦æŸä¸ºï¼šå¦‚æœé€‰æ‹©äº†å€¼ä¸º $x$ çš„å…ƒç´ ï¼Œåˆ™ä¸å…è®¸é€‰æ‹©å€¼ä¸º $x-2,x-1,x+1,x+2$ çš„å…ƒç´ 
>
> æ€è·¯ï¼š
>
> - å“ˆå¸Œè®¡æ•°ã€‚é¦–å…ˆå¾ˆæ˜¾ç„¶çš„æˆ‘ä»¬éœ€è¦è¿›è¡Œå“ˆå¸Œè®¡æ•°ï¼Œä¾¿äºæŒ‰æ•°å€¼å‡åºæšä¸¾å…ƒç´ ã€‚æˆ‘ä»¬å®šä¹‰å“ˆå¸Œåçš„åºåˆ—ä¸º `v`ï¼Œå¤§å°ä¸º `m`ï¼Œå­˜å‚¨æ¯ä¸€ç§æ•°çš„æ•°å€¼ `val: int` å’Œä¸ªæ•° `cnt: int`
> - çŠ¶æ€å®šä¹‰ã€‚æˆ‘ä»¬å®šä¹‰çŠ¶æ€ `f[i]` è¡¨ç¤ºå“ˆå¸Œåºåˆ— `[1,i]` ä¸­å­åºåˆ—æ€»å’Œçš„æœ€å¤§å€¼ï¼Œåˆ™æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ `f[m]`
> - çŠ¶æ€è½¬ç§»ã€‚å¯¹äºæ¯ä¸€ä¸ªå“ˆå¸Œå…ƒç´ ï¼Œéƒ½æœ‰é€‰æ‹©å’Œä¸é€‰ä¸¤ç§çŠ¶æ€ã€‚å‡è®¾å½“å‰æšä¸¾åˆ°çš„å“ˆå¸Œå…ƒç´ ä¸º `i`ï¼Œ
>     - ä¸é€‰å½“å‰å…ƒç´ ã€‚å°±ç›¸å½“äºæ²¡æœ‰å½“å‰å…ƒç´ ï¼Œåˆ™ `f[i] = f[i-1]`
>     - é€‰æ‹©å½“å‰å…ƒç´ ã€‚æˆ‘ä»¬å°±éœ€è¦ä»å“ˆå¸Œåºåˆ— `[1,i-1]` ä¸­ï¼Œæ¯”å½“å‰å“ˆå¸Œå…ƒç´  `v[i].val` å° 2 ä¸”å¯¹åº”å­åºåˆ—ä¹‹å’Œæœ€å¤§çš„é‚£ä¸ªçŠ¶æ€ `f[j]` è½¬ç§»è¿‡æ¥ã€‚æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥ç›´æ¥æšä¸¾å“ˆå¸Œåºåˆ— `[1,i-1]`ï¼Œä½†æ˜¯è¿™æ ·å°±æ˜¯ $O(n^2)$ å¿…ç„¶è¶…æ—¶ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚ä¸éš¾å‘ç° `f[]` æ•°ç»„æ˜¯å•è°ƒé€’å¢çš„å¹¶ä¸”å“ˆå¸Œåºåˆ—çš„å…ƒç´ æ•°å€¼ `v[].val` ä¹Ÿæ˜¯å•è°ƒé€’å¢çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¯¹äºå½“å‰çŠ¶æ€ `f[i]`ï¼Œåœ¨æšä¸¾å“ˆå¸Œåºåˆ— `[1,i-1]` æ—¶ï¼Œå…¶å®å¹¶ä¸éœ€è¦ä» `1` å¼€å§‹æšä¸¾ï¼Œå¯ä»¥ä»ä¸Šä¸€ä¸ªçŠ¶æ€æšä¸¾åˆ°çš„çŠ¶æ€ï¼ˆè®°ä½œ `j`ï¼‰å¼€å§‹æšä¸¾ï¼ˆå› ä¸ºä¸Šä¸€ä¸ªçŠ¶æ€å¯¹åº”çš„ `f[j]` æ˜¯ä¸Šä¸€ä¸ªçŠ¶æ€å¯è½¬ç§»çš„æ–¹æ¡ˆä¸­æœ€å¤§çš„å¹¶ä¸” `v[j].val` ä¸€å®šæ¯”å½“å‰æ–¹æ¡ˆçš„å“ˆå¸Œæ•°å€¼ `v[i].val` å° 2ï¼‰ã€‚äºæ˜¯çŠ¶æ€è½¬ç§»çš„æ—¶é—´å¼€é”€å°±ä» $O(n)$ ä¼˜åŒ–åˆ° $O(1)$ï¼Œå¯ä»¥é€šè¿‡æ­¤é¢˜
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$
>
> ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
class Solution {
public:
    long long maximumTotalDamage(vector<int>& power) {
        using ll = long long;

        // hash
        map<int, int> a;
        for (int x: power) {
            a[x]++;
        }
        int m = a.size(), idx = 1;
        struct node { ll val, cnt; };
        vector<node> v(m + 1);
        for (auto it: a) {
            v[idx++] = {it.first, it.second};
        }

        // dp
        vector<ll> f(m + 1);
        f[1] = v[1].val * v[1].cnt;
        for (int i = 2, j = 1; i <= m; i++) {
            while (j < i && v[j].val < v[i].val - 2) {
                j++;
            }
            j--;
            
            f[i] = max(f[i - 1], f[j] + v[i].val * v[i].cnt);
        }

        return f[m];
    }
};
```

```python
class Solution:
    def maximumTotalDamage(self, power: List[int]) -> int:
        from collections import defaultdict

        # hash
        a = defaultdict(int)
        for x in power:
            a[x] += 1
        a = sorted(a.items(), key=lambda x: x[0])

        class node:
            def __init__(self, val: int, cnt: int) -> None:
                self.val = val
                self.cnt = cnt
        
        m, idx = len(a), 1
        v = [node(0, 0)] * (m + 1)
        for it in a:
            v[idx] = node(it[0], it[1])
            idx += 1

        # dp
        f = [0] * (m + 1)
        f[1], j = v[1].val * v[1].cnt, 1
        for i in range(2, m + 1):
            while j < i and v[j].val < v[i].val - 2:
                j += 1
            j -= 1

            f[i] = max(f[i - 1], f[j] + v[i].val * v[i].cnt)

        return f[m]
```

å¥‡æ€ªçš„æ±‰è¯ºå¡”

<https://www.acwing.com/problem/content/98/>

> é¢˜æ„ï¼šå››å¡”æ±‰è¯ºå¡”é—®é¢˜ã€‚æ±‚åœ¨ç»™å®š $n$ ä¸ªåœ†ç›˜çš„æƒ…å†µä¸‹çš„æœ€å°‘ç§»åŠ¨æ–¹æ¡ˆæ•°ã€‚
>
> æ€è·¯ï¼š
>
> - æˆ‘ä»¬å®šä¹‰ã€Œæœ€å°å®Œæˆå•å…ƒã€ä¸ºï¼šåœ¨æ»¡è¶³æ¸¸æˆè§„åˆ™çš„æƒ…å†µä¸‹ï¼Œå°†ä¸€åº§å¡”çš„æ‰€æœ‰åœ†ç›˜ç§»åŠ¨åˆ°å¦ä¸€åº§å¡”æ‰€éœ€çš„æœ€å°‘å¡”æ•°ã€‚é‚£ä¹ˆæ˜¾ç„¶çš„æœ€å°å®Œæˆå•å…ƒä¸º 3 åº§å¡”ã€‚å®šä¹‰ `d[i]` è¡¨ç¤ºä¸‰å¡”æ¨¡å¼ä¸‹ $i$ ä¸ªç›˜çš„æœ€å°‘ç§»åŠ¨æ¬¡æ•°ï¼Œ`f[i]` è¡¨ç¤ºå››å¡”æ¨¡å¼ä¸‹ $i$ ä¸ªç›˜çš„æœ€å°‘ç§»åŠ¨æ¬¡æ•°ã€‚
>
> - å¯¹äº 4 åº§å¡”çš„æƒ…å†µï¼Œç›¸å½“äºæœ€å°å®Œæˆå•å…ƒåˆå¤šäº† 1 åº§å¡”ã€‚é‚£ä¹ˆæ˜¾ç„¶å¤šå‡ºæ¥çš„è¿™åº§å¡”æœ‰ä¸¤ä¸ªå¤„ç½®æ–¹æ¡ˆï¼š
>
>     - å¦‚æœæˆ‘ä»¬ **ä¸åˆ©ç”¨** è¿™åº§å¡”ã€‚é‚£ä¹ˆè¿˜å‰© 3 åº§å¡”ï¼Œä¹Ÿå°±æ˜¯æœ€å°å®Œæˆå•å…ƒï¼Œæ­¤æ—¶çš„æœ€å°‘ç§»åŠ¨æ¬¡æ•°æ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯ `f[i] = d[i]`
>
>     - å¦‚æœæˆ‘ä»¬ **è¦åˆ©ç”¨** è¿™åº§å¡”ã€‚é‚£ä¹ˆæˆ‘ä»¬ **åªèƒ½åœ¨è¿™ä¸€åº§å¡”ä¸Š** æŒ‰è§„åˆ™æ”¾åœ†ç›˜ã€‚å› ä¸ºè¦ç¡®ä¿æœ€å°å®Œæˆå•å…ƒæ¥è®©å‰©ä½™çš„åœ†ç›˜ç§»åŠ¨åˆ°å¦ä¸€åº§å¡”ã€‚å¦‚æœè¿˜åœ¨åˆ«çš„å¡”ä¸Šæ”¾ç½®äº†åœ†ç›˜ï¼Œé‚£ä¹ˆå°†ä¸ç¬¦åˆæœ€å°å®Œæˆå•å…ƒçš„å®šä¹‰ï¼Œæ¸¸æˆæ— æ³•ç»“æŸã€‚å½“ç„¶æˆ‘ä»¬ä¸èƒ½å°†æ‰€æœ‰çš„åœ†ç›˜éƒ½å…ˆæ”¾åˆ°è¿™åº§å¡”ä¸Šï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹æ˜¯ä¸å¯èƒ½æˆç«‹çš„ï¼Œæˆ‘ä»¬ä¸å¯èƒ½è®©ä¸€ä¸ªã€Œæˆ‘ä»¬æ­£åœ¨æ±‚è§£çš„é—®é¢˜ã€ä½œä¸ºæˆ‘ä»¬çš„ç­”æ¡ˆã€‚ä¹Ÿå°±æ˜¯è¯´ $j<i$
>
>
> - è‡³æ­¤å››å¡”æ¨¡å¼ä¸‹ $i$ ä¸ªåœ†ç›˜æ¸¸æˆæ–¹æ¡ˆçš„ç»„æˆé›†åˆå·²å…¨éƒ¨ç¡®å®šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå³ï¼šåœ¨å››å¡”æ¨¡å¼ä¸‹ç§»åŠ¨ $j \in [0,i-1]$ ä¸ªåœ†ç›˜åˆ°å…¶ä¸­ä¸€åº§ç©ºå¡”ä¸Šï¼Œæ–¹æ¡ˆæ•°ä¸º $f[j]$ï¼›å‰©ä½™çš„ $i-j$ ä¸ªåœ†ç›˜å¤„äºæœ€å°å®Œæˆå•å…ƒçš„å±€é¢ï¼Œæ–¹æ¡ˆæ•°æ˜¯å”¯ä¸€çš„ $d[i-j]$ï¼›æœ€åå†å°†ä¸€å¼€å§‹ç§»åŠ¨çš„ $j$ ä¸ªåœ†ç›˜åœ¨å››å¡”æ¨¡å¼ä¸‹ç§»åŠ¨åˆ°åˆšæ‰å‰©ä½™åœ†ç›˜ç§»åŠ¨åˆ°çš„å¡”ä¸Šï¼Œæ–¹æ¡ˆæ•°ä¸º $f[j]$ã€‚
>
> ![é›†åˆåˆ’åˆ†](https://cdn.dwj601.cn/images/202408011452431.png)
>
> äºæ˜¯æœ€ç»ˆçš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š
>
> $$
> f_i = \min{ \{ f_j+d_{i-j}+f_j \} },\quad i \in [1, n],\quad j \in [0, i-1]
> $$
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$

```cpp
#include <bits/stdc++.h>

using ll = long long;
using namespace std;

void solve() {
    int n = 12;
    vector<int> d(n + 1);       // d[i] means move i pans to another tower with 3 towers
    vector<int> f(n + 1, 1e9);  // f[i] means move i pans to another tower with 4 towers
    
    d[1] = 1;
    for (int i = 1; i <= n; i++) {
        d[i] = 1 + 2 * d[i - 1];
    }
    f[1] = 1;
    for (int i = 1; i <= n; i++) {
        for (int j = 0; j <= i - 1; j++) {
            f[i] = min(f[i], f[j] + d[i - j] + f[j]);
        }
        cout << f[i] << "\n";
    }
}

signed main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    int T = 1;
//    std::cin >> T;
    while (T--) solve();
    return 0;
}
```

æ•°çš„è®¡ç®—

<https://www.luogu.com.cn/problem/P1028>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ•°å’Œä¸€ç§æ„é€ æ–¹æ³•ï¼Œå³å¯¹äºå½“å‰çš„æ•°ï¼Œå¯ä»¥åœ¨å…¶åé¢æ·»åŠ ä¸€ä¸ªæœ€å¤§ä¸ºå½“å‰ä¸€åŠå¤§çš„æ•°ï¼Œä»¥æ­¤ç±»æ¨æ„é€ æˆä¸€ä¸ªæ•°åˆ—ã€‚é—®ä¸€å…±å¯ä»¥æ„é€ å‡ºå¤šå°‘ä¸ªè¿™ç§æ•°åˆ—
>
> æ€è·¯ä¸€ï¼šdfs
>
> - éå¸¸æ˜¾ç„¶çš„ä¸€ä¸ªæœç´¢æ ‘ï¼Œç­”æ¡ˆå°±æ˜¯ç»“ç‚¹æ•°
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(\text{æ–¹æ¡ˆæ•°})$
>
> æ€è·¯äºŒï¼šdp
>
> - éå¸¸æ˜¾ç„¶çš„ä¸€ä¸ª dpï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª dp è®°å¿†æ•°ç»„ã€‚å…¶ä¸­ `dp[i]` è¡¨ç¤ºæ•°å­— `i` çš„æ„é€ æ–¹æ¡ˆæ€»æ•°ï¼Œé‚£ä¹ˆçŠ¶æ€è½¬ç§»æ–¹ç¨‹å°±æ˜¯
>
>     $$
>     dp [i] =\sum_{j = 1}^{\left\lfloor i/2 \right\rfloor}dp [j]+1
>     $$
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$

dfs ä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

int n, res;

void dfs(int x) {
    res++;
    for (int i = x >> 1; i >= 1; i--) {
        dfs(i);
    }
}

void solve() {
    cin >> n;
    dfs(n);
    cout << res << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

dp ä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

int n;

void solve() {
    cin >> n;

    vector<ll> dp(n + 1, 1);
    for (int i = 2; i <= n; i++) {
        for (int j = 1; j <= i >> 1; j++) {
            dp[i] += dp[j];
        }
    }

    cout << dp[n] << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

è§„åˆ’å…¼èŒå·¥ä½œ

<https://leetcode.cn/problems/maximum-profit-in-job-scheduling/description/>

> æ ‡ç­¾ï¼šçº¿æ€§ dpã€äºŒåˆ†ç­”æ¡ˆ
>
> é¢˜æ„ï¼šç»™å®š n ä»½å·¥ä½œçš„èµ·å§‹æ—¶é—´ã€ç»ˆæ­¢æ—¶é—´ã€æ”¶ç›Šå€¼ï¼Œç°åœ¨éœ€è¦ä¸é‡å æ—¶é—´çš„é€‰æ‹©å·¥ä½œä½¿å¾—æ”¶ç›Šæœ€å¤§
>
> æ€è·¯ï¼šåŠ¨æ€è§„åˆ’ã€äºŒåˆ†ç­”æ¡ˆã€‚ä¸ºäº†ä¸é‡ä¸æ¼çš„æšä¸¾æ¯ä¸€ä»½å·¥ä½œï¼Œæˆ‘ä»¬å°†å·¥ä½œæŒ‰ç…§ç»“æŸæ—¶é—´è¿›è¡Œæ’åºï¼Œç„¶åå°±å¯ä»¥æšä¸¾æ¯ä¸€ä»½å·¥ä½œäº†ã€‚æ¥ä¸‹æ¥è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•æ ¹æ®èµ·å§‹æ—¶é—´å’Œç»ˆæ­¢æ—¶é—´è¿›è¡Œå·¥ä½œçš„é€‰æ‹©ã€‚æ˜¾ç„¶çš„ï¼Œæ¯ä¸€ä»½å·¥ä½œæœ‰é€‰ä¸ä¸é€‰ä¸¤ç§çŠ¶æ€ï¼Œæ˜¯å¦é€‰æ‹©å–å†³äºæ”¶ç›Šæ˜¯å¦æ›´ä¼˜ï¼Œæˆ‘ä»¬è€ƒè™‘åŠ¨æ€è§„åˆ’ã€‚æˆ‘ä»¬å®šä¹‰çŠ¶æ€è¡¨ `f[i]` è¡¨ç¤ºåœ¨å‰ i ä¸ªå·¥ä½œä¸­é€‰æ‹©çš„æœ€å¤§å·¥ä½œæ”¶ç›Šï¼Œè¿”å›å€¼å°±æ˜¯ `f[n]`ï¼Œå…ˆçœ‹å›¾
>
> ![å›¾ä¾‹](https://cdn.dwj601.cn/images/202405281439070.png)
>
> 1. é€‰æ‹©ç¬¬ i ä¸ªå·¥ä½œï¼š`f[i] = f[r] + profit[i]`ï¼ˆå…¶ä¸­ r è¡¨ç¤º `[1,i-1]` ä»½å·¥ä½œä¸­ï¼Œç»“æŸæ—¶é—´æ—©äºå½“å‰å·¥ä½œèµ·å§‹æ—¶é—´çš„æœ€å³è¾¹çš„å·¥ä½œï¼Œåœ¨ `[1,i-1]` ä¸­äºŒåˆ†æŸ¥æ‰¾å³å¯ï¼‰
> 2. ä¸é€‰ç¬¬ i ä¸ªå·¥ä½œï¼š`f[i] = f[i - 1]`
>
> é€‰æ‹©æœ€å¤§å±æ€§è¿›è¡ŒçŠ¶æ€è½¬ç§»å³å¯ï¼š`f[i] = max(f[i - 1], f[r] + profit[i])`
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n\log n)$

```cpp
class Solution {
public:
    int jobScheduling(vector<int>& startTime, vector<int>& endTime, vector<int>& profit) {
        int n = startTime.size();
        vector<array<int, 3>> jobs(n + 1);

        for (int i = 1; i <= n; i++) {
            jobs[i] = {startTime[i - 1], endTime[i - 1], profit[i - 1]};
        }

        sort(jobs.begin() + 1, jobs.end(), [&](array<int, 3>& x, array<int, 3>& y){
            return x[1] < y[1];
        });

        vector<int> f(n + 1);
        for (int i = 1; i <= n; i++) {
            int l = 0, r = i - 1;
            while (l < r) {
                int mid = (l + r + 1) >> 1;
                if (jobs[mid][1] <= jobs[i][0]) l = mid;
                else r = mid - 1;
            }
            f[i] = max(f[i - 1], f[r] + jobs[i][2]);
        }

        return f[n];
    }
};
```

æœ€é•¿ä¸Šå‡å­åºåˆ—

<https://www.luogu.com.cn/problem/B3637>

> æ ‡ç­¾ï¼šçº¿æ€§ dpã€äºŒåˆ†æŸ¥æ‰¾
>
> é¢˜æ„ï¼šç»™å®šåºåˆ—ï¼Œæ±‚è§£å…¶ä¸­æœ€é•¿ä¸Šå‡å­åºåˆ— (Longest Increasing Subsequence, ç®€ç§° LIS) çš„é•¿åº¦ã€‚
>
> æ€è·¯ï¼šæˆ‘ä»¬é‡‡ç”¨åŠ¨æ€è§„åˆ’ã€‚
>
> **çŠ¶æ€å®šä¹‰**ï¼šå®šä¹‰çŠ¶æ€æ•°ç»„ `f[i]` è¡¨ç¤ºä»¥å…ƒç´  `a[i]` ç»“å°¾çš„æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ï¼Œæ˜¾ç„¶çš„åˆå§‹çŠ¶æ€å…¨éƒ½æ˜¯ `1`
>
> **çŠ¶æ€è½¬ç§»**ï¼š
>
> - **æš´åŠ›æšä¸¾**ã€‚é¦–å…ˆå¾ˆæ˜¾ç„¶çš„ `f[i]` ä¸€å®šæ˜¯ä» `[0,i-1]` ä¸­æ¯”å½“å‰å…ƒç´ å€¼å°çš„çŠ¶æ€è½¬ç§»è¿‡æ¥ï¼Œäºæ˜¯å¯ä»¥å¾ˆè½»æ¾çš„å†™å‡ºåŒé‡å¾ªç¯çš„ä»£ç ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^2)$ã€‚
>
> - **è´ªå¿ƒ+äºŒåˆ†ä¼˜åŒ–**ã€‚
>
>     - **å›é¡¾æœ´ç´ **ã€‚ä¼˜åŒ–éœ€è¦åœ¨ç†è§£è½¬ç§»æœ¬è´¨çš„åŸºç¡€ä¸Šå±•å¼€ï¼Œå› æ­¤æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹æœ´ç´ ç‰ˆçš„è½¬ç§»æ–¹æ¡ˆï¼šä» `[0,i-1]` ä¸­æ¯”å½“å‰å…ƒç´ å°çš„å…ƒç´  `a[j]` å¯¹åº”çš„æœ€é•¿ä¸Šå‡å­åºåˆ—é•¿åº¦ `f[j]` è½¬ç§»è¿‡æ¥ã€‚æˆ‘ä»¬æšä¸¾äº† `[0,i-1]` æ‰€æœ‰çš„çŠ¶æ€ç¡®ä¿äº†ä¸é‡ä¸æ¼ã€‚å¯¹äº `i = 6` æ¥è¯´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å…¶ä¸­ âœ” è¡¨ç¤ºè¿›å…¥äº† `if` çš„åˆ¤æ–­é€»è¾‘ã€‚æœ€ç»ˆæˆ‘ä»¬é€‰æ‹©ä» `j = 5` å¯¹åº”çš„ `f[j] = 3` è½¬ç§»è€Œæ¥ã€‚è¿™é‡Œçš„åˆ¤æ–­å‡†åˆ™ä¸ºï¼šå¯¹äºæ¯ä¸€ä¸ªå…ƒç´ ï¼Œéœ€è¦æ‰¾å‰é¢çš„å…ƒç´ ä¸­æ¯”å½“å‰å…ƒç´ å°çš„å…ƒç´ ã€‚
>
>         ![æšä¸¾å…ƒç´ ](https://cdn.dwj601.cn/images/202406211528778.png)
>
>     - **è½¬æ¢è§†è§’**ã€‚åŒæ ·å¯¹äºæ¯ä¸€ä¸ªå…ƒç´  `a[i]`ï¼Œæˆ‘ä»¬ä¸å†æŒ‰é¡ºåºæšä¸¾å‰é¢å·²ç»è®¡ç®—å‡ºæ¥çš„ `f[1:i-1]`ï¼Œè€Œæ˜¯é¢„å…ˆæŒ‰ç…§é•¿åº¦å­˜å‚¨æ‰€æœ‰çš„ `f[1:i-1]` ä»è€Œæšä¸¾é•¿åº¦ `j`ï¼Œæ˜¾ç„¶å¯ä»¥è´ªå¿ƒçš„ä»æœ€å¤§é•¿åº¦ `mxa_len` å¼€å§‹æšä¸¾ã€‚ä¸€æ—¦é‡åˆ°æ¯” `a[i]` å°çš„å…ƒç´ ï¼Œé‚£ä¹ˆ `f[i]` å°±ç­‰äºå½“å‰æšä¸¾çš„é•¿åº¦+1ï¼Œå³ `f[i] = j + 1`ã€‚å¯¹äº `i = 6` æ¥è¯´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™æ ·ä¹Ÿå¯ä»¥åšåˆ°ä¸é‡ä¸æ¼çš„æšä¸¾æ‰€æœ‰çŠ¶æ€ã€‚ä½†æ˜¯æ˜¾ç„¶çš„ï¼Œè¿™ç§æ–¹æ³•åªæ˜¯å˜ç›¸åœ°æšä¸¾äº†æ‰€æœ‰çš„å…ƒç´ ï¼Œä»ç„¶æ˜¯ $O(n^2)$ï¼Œå¹¶ä¸”å’Œæšä¸¾å…ƒç´ ç›¸æ¯”è¿˜å¤šäº†ä¸€ç‚¹æ€ç»´é‡å’Œä»£ç é‡ã€‚
>
>         ![æšä¸¾é•¿åº¦](https://cdn.dwj601.cn/images/202406211532051.png)
>
>     - **ä¼˜åŒ–è¯ç”Ÿ**ã€‚åœ¨æšä¸¾å…ƒç´ æ—¶ï¼Œå¹¶æ²¡æœ‰é¢å¤–æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å…ƒç´ å¹¶éå•è°ƒæ’åˆ—ï¼Œ`f[]` æ•°ç»„ä¹Ÿå¹¶éå•è°ƒã€‚ä½†è½¬æ¢åˆ°æšä¸¾é•¿åº¦ï¼Œè®©æˆ‘ä»¬æœ‰æœºä¼šè¿›è¡Œä¼˜åŒ–ï¼ä¸éš¾å‘ç°ï¼Œå¯¹äºæ¯ä¸€ä¸ªå…ƒç´  `a[i]`ï¼Œæˆ‘ä»¬åœ¨æŒ‰é•¿åº¦ `[1,max_len]` æšä¸¾å¯èƒ½çš„å°¾å…ƒç´  `f[1:i-1]` æ—¶ï¼Œç”±äº `max_len` æ¯ä¸€æ¬¡æ›´æ–°æ—¶çš„å¢é‡éƒ½æ˜¯ 1ï¼Œå› æ­¤ `[1,max_len]` çš„æ¯ä¸€ä¸ªå–å€¼éƒ½ä¸€å®šä¼šæœ‰å¯¹åº”çš„å…ƒç´ å­˜åœ¨ï¼è´ªå¿ƒçš„ï¼Œå¯¹äºåŒä¸€ä¸ªé•¿åº¦ä¸‹æ‰€æœ‰å­åºåˆ—çš„å°¾å…ƒç´ ï¼Œæˆ‘ä»¬åªå…³å¿ƒå…¶ä¸­å€¼æœ€å°çš„é‚£ä¸€ä¸ªå°¾å…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª `mi[]` æ•°ç»„æ¥å­˜å‚¨æ¯ä¸€ä¸ªé•¿åº¦ä¸‹å­åºåˆ—å°¾å…ƒç´ çš„æœ€å°å€¼ï¼Œå…¶ä¸­ `mi[i]` è¡¨ç¤ºé•¿åº¦ä¸º `i` çš„æœ€é•¿ä¸Šå‡å­åºåˆ—ä¸­ï¼Œæœ€å°çš„å°¾å…ƒç´ å€¼ã€‚è¿™æ ·åœ¨æšä¸¾é•¿åº¦ `[1,max_len]` æ—¶ï¼Œå°±ä¸å†éœ€è¦æšä¸¾æ¯ä¸€ä¸ªé•¿åº¦ä¸‹æ‰€æœ‰çš„å°¾å…ƒç´ ï¼Œä»…éœ€æšä¸¾æ¯ä¸€ä¸ªé•¿åº¦ä¸‹å”¯ä¸€çš„é‚£ä¸ªæœ€å°å°¾å…ƒç´ ã€‚ä½†å¦‚æœæ¯ä¸€ä¸ªé•¿åº¦éƒ½åˆšå¥½åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å²‚ä¸æ˜¯è¿˜æ˜¯éœ€è¦çº¿æ€§æšä¸¾ï¼Ÿæ›´è¿›ä¸€æ­¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ­¤æ—¶æ¯ä¸€ä¸ªé•¿åº¦å¯¹åº”çš„å”¯ä¸€å…ƒç´ ç»„æˆçš„åºåˆ—æ˜¯ä¸¥æ ¼å•è°ƒé€’å¢çš„ï¼ˆåè¯æ³•æ˜“è¯ï¼‰ï¼æœ‰äº†è¿™æ ·å•è°ƒçš„æ€§è´¨æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨äºŒåˆ†åŠ é€Ÿæšä¸¾ï¼Œè¿™æ ·å¯ä»¥å°†æšä¸¾çš„æ—¶é—´å¤æ‚åº¦ä¸¥æ ¼æ§åˆ¶åœ¨ $O(\log n)$ã€‚æ˜¾ç„¶çš„ï¼Œæˆ‘ä»¬å¸Œæœ›å½“å‰çš„å…ƒç´ å¯ä»¥æ‹¼æ¥åœ¨å°½å¯èƒ½é•¿çš„å­åºåˆ—åé¢ï¼Œå› æ­¤æ­¤å¤„çš„äºŒåˆ†ä½¿ç”¨çš„æ˜¯å¯»æ‰¾å³è¾¹ç•Œçš„æ¿å­ã€‚
>
>         ![ä¼˜åŒ–](https://cdn.dwj601.cn/images/202406211532875.png)
>
>     - **ä»£ç å®ç°**ã€‚æšä¸¾æ¯ä¸€ä¸ªå…ƒç´ è‚¯å®šæ˜¯å°‘ä¸äº†çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨ `mi[j]` è¡¨ç¤ºæœ€é•¿ä¸Šå‡å­åºåˆ—é•¿åº¦ä¸º `j` çš„åºåˆ—å°¾å…ƒç´ çš„æœ€å°å€¼ã€‚åˆå§‹çŠ¶æ€æ˜¾ç„¶å°±æ˜¯ `mi[1] = a[0]`ã€‚åœ¨æ¯ä¸€ä¸ªå…ƒç´ äºŒåˆ†æŸ¥è¯¢ã€Œæœ€å¤§çš„æ¯”å½“å‰å…ƒç´ å°çš„å…ƒç´ ã€æ—¶ï¼Œå¦‚æœæŸ¥å‡ºæ¥çš„å…ƒç´  `mi[r]` ç¡®å®æ¯”å½“å‰å…ƒç´ å°ï¼Œåˆ™éœ€è¦æ›´æ–° `mi[r+1]` çš„å€¼ï¼›åä¹‹å¦‚æœæŸ¥å‡ºæ¥çš„å…ƒç´  `mi[r]` æ¯”å½“å‰å…ƒç´ è¿˜å°ï¼Œåˆ™è¡¨æ˜äºŒåˆ†åˆ°äº†å·¦è¾¹ç•Œï¼Œæ­¤æ—¶ `r` ä¸€å®šæ˜¯ 1ï¼Œç›´æ¥ç”¨å½“å‰å…ƒç´ è¦†ç›– `mi[1]` å³å¯ã€‚
>
> **ç­”æ¡ˆè¡¨ç¤º**ã€‚æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ `max_len`
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n \log n)$

æš´åŠ›æšä¸¾å…ƒç´ 

```cpp
#include <bits/stdc++.h>

using ll = long long;
using namespace std;

void solve() {
    int n;
    cin >> n;

    vector<int> a(n);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }

    vector<int> f(n, 1);
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < i; j++) {
            if (a[i] > a[j]) {
                f[i] = max(f[i], f[j] + 1);
            }
        }
    }

    cout << *max_element(f.begin(), f.end()) << "\n";
}

signed main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    int T = 1;
//    std::cin >> T;
    while (T--) solve();
    return 0;
}
```

æš´åŠ›æšä¸¾é•¿åº¦

```cpp
#include <bits/stdc++.h>

using ll = long long;
using namespace std;

void solve() {
    int n;
    cin >> n;

    vector<int> a(n);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }

    vector<vector<int>> dp(n + 1, vector<int>());
    int max_len = 1;
    dp[1].push_back(a[0]);
    for (int i = 1; i < n; i++) {
        bool ok = false;
        // è´ªå¿ƒçš„ä»å·²ç»å‡ºç°è¿‡çš„æœ€å¤§é•¿åº¦å¼€å§‹æšä¸¾
        for (int j = max_len; j >= 1; j--) {
            // å¯¹äºå½“å‰é•¿åº¦ä¸‹çš„æ‰€æœ‰å…ƒç´ 
            for (int x: dp[j]) {
                if (a[i] > x) {
                    dp[j + 1].push_back(a[i]);
                    max_len = max(max_len, j + 1);
                    ok = true;
                    goto flag;
                }
            }
        }
        flag:
        if (!ok) {
            dp[1].push_back(a[i]);
        }
    }

    cout << max_len << "\n";
}

signed main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    int T = 1;
//    std::cin >> T;
    while (T--) solve();
    return 0;
}
```

è´ªå¿ƒäºŒåˆ†ä¼˜åŒ–

```cpp
#include <bits/stdc++.h>

using ll = long long;
using namespace std;

void solve() {
    int n;
    cin >> n;

    vector<int> a(n);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }

    vector<int> mi(n + 1, INT_MAX);
    int max_len = 1;
    mi[1] = a[0];
    for (int i = 1; i < n; i++) {
        int l = 1, r = max_len;
        while (l < r) {
            int mid = (l + r + 1) >> 1;
            if (a[i] > mi[mid]) l = mid;
            else r = mid - 1;
        }

        if (a[i] > mi[r]) {
            mi[r + 1] = min(mi[r + 1], a[i]);
            max_len = max(max_len, r + 1);
        } else {
            // æ­¤æ—¶é•¿åº¦ r ä¸€å®šæ˜¯ 1 å¹¶ä¸”å½“å‰å…ƒç´ æ˜¯é•¿åº¦ä¸º 1 çš„å­åºåˆ—å°¾å…ƒç´ ä¸­æœ€å°çš„
            mi[1] = a[i];
        }
    }

    cout << max_len << "\n";
}

signed main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    int T = 1;
//    std::cin >> T;
    while (T--) solve();
    return 0;
}
```

### ç½‘æ ¼å›¾ dp

è¿‡æ²³å’

<https://www.luogu.com.cn/problem/P1002>

> æ ‡ç­¾ï¼šç½‘æ ¼å›¾ dpã€dfs
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªçŸ©é˜µï¼Œç°åœ¨éœ€è¦ä»å·¦ä¸Šè§’èµ°åˆ°å³ä¸‹è§’ï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Ÿæœ‰ä¸€ä¸ªç‰¹æ®Šé™åˆ¶æ˜¯ï¼Œå¯¹äºå›¾ä¸­çš„ 9 ä¸ªç‚¹æ˜¯æ— æ³•é€šè¿‡çš„ã€‚
>
> æ€è·¯ä¸€ï¼šdfs
>
> - æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ·±æœçš„æ–¹æ³•ã€‚ä½†æ˜¯ä¼šè¶…æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä¼°ç®—æ—¶é—´å¤æ‚åº¦ï¼šå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬éƒ½éœ€è¦è®¡ç®—å½“å‰ç‚¹çš„å³ä¸‹è§’çš„çŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆæ€»è¿ç®—æ¬¡æ•°å°±è¿‘ä¼¼ä¸ºé˜¶ä¹˜çº§åˆ«ã€‚å½“ç„¶å®é™…çš„æ—¶é—´å¤æ‚åº¦ä¸ä¼šè¿™ä¹ˆå¤§ï¼Œä½†æ˜¯è¿™ç§åšæ³• $n*m$ ä¸€æ—¦è¶…è¿‡ 100 å°±å¾ˆå®¹æ˜“ tle
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(nm!)$
>
> æ€è·¯äºŒï¼šdp
>
> - æˆ‘ä»¬å¯ä»¥è€ƒè™‘ï¼Œå¯¹äºå½“å‰çš„ç‚¹ï¼Œå¯ä»¥ä»å“ªäº›ç‚¹èµ°è¿‡æ¥ï¼Œå¾ˆæ˜¾ç„¶å°±æ˜¯ä¸Šé¢ä¸€ä¸ªç‚¹å’Œå·¦è¾¹ä¸€ä¸ªç‚¹ï¼Œè€Œå¯¹äºèµ°åˆ°å½“å‰è¿™ä¸ªç‚¹çš„è·¯çº¿å°±æ˜¯èµ°åˆ°ä¸Šé¢çš„ç‚¹å’Œå·¦è¾¹çš„ç‚¹çš„è·¯çº¿ä¹‹å’Œï¼Œbase çŠ¶æ€å°±æ˜¯ `dp[1][1] = 1`ï¼Œå³èµ·ç‚¹çš„è·¯çº¿æ•°ä¸º 1
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(nm)$

dfs ä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

const int N = 30;

int n, m, a, b;
int res;
bool notsafe[N][N];

void init() {
    int px[9] = {0, -1, -2, -2, -1, 1, 2, 2, 1};
    int py[9] = {0, 2, 1, -1, -2, -2, -1, 1, 2};
    for (int i = 0; i < 9; i++) {
        int na = a + px[i], nb = b + py[i];
        if (na < 0 || nb < 0) continue;
        notsafe[na][nb] = true;
    }
}

void dfs(int x, int y) {
    if (x > n || y > m || notsafe[x][y]) {
        return;
    }

    if (x == n && y == m) {
        res++;
        return;
    }

    dfs(x, y + 1);
    dfs(x + 1, y);
}

void solve() {
    cin >> n >> m >> a >> b;
    init();
    dfs(0, 0);
    cout << res << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

dp ä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

const int N = 30;

int n, m, a, b;
bool notsafe[N][N];
ll dp[N][N];

void solve() {
    cin >> n >> m >> a >> b;

    // åˆå§‹åŒ–
    ++n, ++m, ++a, ++b;
    int px[9] = {0, -1, -2, -2, -1, 1, 2, 2, 1};
    int py[9] = {0, 2, 1, -1, -2, -2, -1, 1, 2};
    for (int i = 0; i < 9; i++) {
        int na = a + px[i], nb = b + py[i];
        if (na < 0 || nb < 0) continue;
        notsafe[na][nb] = true;
    }

    // dpæ±‚è§£
    dp[1][1] = 1;
    for (int i = 1; i <= n; i++) {
        for (int j = 1; j <= m; j++) {
            if (!notsafe[i - 1][j]) dp[i][j] += dp[i - 1][j];
            if (!notsafe[i][j - 1]) dp[i][j] += dp[i][j - 1];
        }
    }

    cout << dp[n][m] << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

æ‘˜æ¨±æ¡ƒ II

<https://leetcode.cn/problems/cherry-pickup-ii/>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ª $n$ è¡Œ $m$ åˆ—çš„ç½‘æ ¼å›¾ï¼Œæ¯ä¸ªæ ¼å­æ‹¥æœ‰ä¸€ä¸ªä»·å€¼ã€‚ç°åœ¨æœ‰ä¸¤ä¸ªäººåˆ†åˆ«ä»å·¦ä¸Šè§’å’Œå³ä¸Šè§’å¼€å§‹ç§»åŠ¨ï¼Œç§»åŠ¨æ–¹å¼ä¸ºã€Œå·¦ä¸‹ã€ä¸‹ã€å³ä¸‹ã€ä¸‰ä¸ªæ–¹å‘ï¼Œé—®ä¸¤äººæœ€ç»ˆæœ€å¤šä¸€å…±å¯ä»¥è·å¾—å¤šå°‘ä»·å€¼ï¼Ÿå¦‚æœä¸¤äººåŒæ—¶ç»è¿‡ä¸€ä¸ªä½ç½®ï¼Œåˆ™åªèƒ½ç®—ä¸€æ¬¡ä»·å€¼ã€‚
>
> æ€è·¯ï¼š
>
> - çŠ¶æ€å®šä¹‰ã€‚æœ€ç»ˆçŠ¶æ€ä¸€å®šæ˜¯ä¸¤äººéƒ½åœ¨æœ€åä¸€è¡Œçš„ä»»æ„ä¸¤åˆ—ï¼Œæˆ‘ä»¬å¦‚ä½•å®šä¹‰çŠ¶æ€å¯ä»¥ä¸é‡ä¸æ¼çš„è¡¨ç¤ºä¸¤äººçš„è¿åŠ¨çŠ¶æ€å‘¢ï¼Ÿå¯ä»¥å‘ç°ä¸¤äººå§‹ç»ˆåœ¨åŒä¸€è¡Œï¼Œä½†æ˜¯åˆ—æ•°ä¸ä¸€å®šç›¸åŒï¼Œæˆ‘ä»¬å®šä¹‰çŠ¶æ€ $f[i][j][k]$ è¡¨ç¤ºä¸¤äººèµ°åˆ°ç¬¬ $i$ è¡Œæ—¶ï¼Œä¸€äººåœ¨ç¬¬ $j$ åˆ—ï¼Œå¦ä¸€äººåœ¨ç¬¬ $k$ åˆ—æ—¶çš„æ€»ä»·å€¼ã€‚åˆ™ç­”æ¡ˆå°±æ˜¯ï¼š
>
>     $$
>     \max{(f [n-1][j] [k])}, j, k\in [0, m]
>     $$
>
> - çŠ¶æ€è½¬ç§»ã€‚æœ¬é¢˜éš¾ç‚¹åœ¨äºçŠ¶æ€å®šä¹‰ï¼Œä¸€æ—¦å®šä¹‰å¥½äº†ä»¥åçŠ¶æ€è½¬ç§»å°±ä¸å›°éš¾äº†ã€‚å¯¹äºå½“å‰çŠ¶æ€ $f[i][j][k]$ï¼Œæ ¹æ®ä¹˜æ³•åŸç†ï¼Œä¸¤äººå‡æœ‰ 3 ç§èµ°æ³•ï¼Œå› æ­¤å½“å‰çŠ¶æ€å¯ä»¥ä» $3\times 3=9$ ç§åˆæ³•çŠ¶æ€è½¬ç§»è¿‡æ¥ã€‚å–æœ€å¤§å€¼å³å¯ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(nm^2)$

```python
class Solution:
    def cherryPickup(self, g: List[List[int]]) -> int:
        n, m = len(g), len(g[0])
        f = [[[-1] * m for _ in range(m)] for _ in range(n)]
        f[0][0][m - 1] = g[0][0] + g[0][m - 1]
        for i in range(1, n):
            for j in range(m):
                for k in range(m):
                    # æšä¸¾ 9 ä¸ªå­é—®é¢˜
                    for p in range(j - 1, j + 2):
                        for q in range(k - 1, k + 2):
                            if 0 <= p < m and 0 <= q < m and f[i - 1][p][q] != -1:
                                f[i][j][k] = max(f[i][j][k], f[i - 1][p][q] + g[i][j] + (0 if j == k else g[i][k]))
        
        res = 0
        for j in range(m):
            for k in range(j, m):
                res = max(res, f[n - 1][j][k])
        
        return res
```

æ‘˜æ¨±æ¡ƒ

å¼±åŒ–ç‰ˆ $(n\le 50)$ ï¼š<https://leetcode.cn/problems/cherry-pickup/>

å¼ºåŒ–ç‰ˆ $(n\le300)$ ï¼š<https://codeforces.com/problemset/problem/213/C>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ª n è¡Œ n åˆ—çš„ç½‘æ ¼å›¾ï¼Œé—®ä»å·¦ä¸Šèµ°åˆ°å³ä¸‹ï¼Œå†ä»å³ä¸‹èµ°åˆ°å·¦ä¸Šæœ€å¤šå¯ä»¥è·å¾—å¤šå°‘ä»·å€¼ï¼Ÿä¸€ä¸ªå•å…ƒæ ¼åªèƒ½è¢«è®¡ç®—ä¸€æ¬¡ä»·å€¼ã€‚
>
> æ³¨ï¼šå¼±åŒ–ç‰ˆä¸­ -1 è¡¨ç¤ºä¸å¯è¾¾ï¼Œå¼ºåŒ–ç‰ˆæ²¡æœ‰ä¸å¯è¾¾çš„çº¦æŸã€‚[å¼ºåŒ–ç‰ˆ AC ä»£ç ](https://codeforces.com/contest/213/submission/278617557)
>
> æ€è·¯ä¸€ï¼šæš´åŠ› dp
>
> - é¦–å…ˆå¯¹äºæ¥å›é—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºä¸¤æ¬¡å»çš„é—®é¢˜ï¼Œå³é—®é¢˜ç­‰ä»·äºæ±‚è§£ã€Œä¸¤ä¸ªäººä»å·¦ä¸Šè§’èµ°åˆ°å³ä¸‹è§’ã€çš„æœ€å¤§æ”¶ç›Šã€‚
> - æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥å®šä¹‰å››ç»´çš„çŠ¶æ€ï¼Œå…¶ä¸­ $f[i][j][p][q]$ è¡¨ç¤ºç¬¬ä¸€ä¸ªäººèµ°åˆ° $(i,j)$ ä¸”ç¬¬äºŒä¸ªäººèµ°åˆ° $(p,q)$ æ—¶çš„æœ€å¤§æ”¶ç›Šã€‚ç›´æ¥æšä¸¾è¿™å››ä¸ªç»´åº¦ï¼Œç„¶åä» 4 ä¸ªåˆæ³•çš„å­é—®é¢˜è½¬ç§»è¿‡æ¥å³å¯ã€‚
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^4)$
>
> æ€è·¯äºŒï¼šä¼˜åŒ– dp
>
> - æ³¨æ„åˆ°é—®é¢˜å¯ä»¥è¿›ä¸€æ­¥ç­‰ä»·äºã€Œä¸¤ä¸ªäºº **åŒæ—¶** ä»å·¦ä¸Šè§’èµ°åˆ°å³ä¸‹è§’ã€çš„æœ€å¤§æ”¶ç›Šã€‚ä¹Ÿå°±æ˜¯ä¸¤ä¸ªäººåˆ°èµ·ç‚¹ $(0,0)$ çš„æ›¼å“ˆé¡¿è·ç¦»åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œå³ $i+j=p+q$ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå…¶ä¸­ä¸€ä¸ªäºº $(i,j)$ çš„ä½ç½®ç¡®å®šäº†ï¼Œåˆ™å¦ä¸€ä¸ªäººåªéœ€è¦æšä¸¾ä¸€ä¸ªä¸‹æ ‡ï¼Œå¦ä¸€ä¸ªä¸‹æ ‡å°±å¯ä»¥ $O(1)$ çš„ç¡®å®šäº†ã€‚å¯ä»¥å°†æ—¶é—´å¤æ‚åº¦é™ä½ä¸€ä¸ªç»´åº¦ã€‚
> - çŠ¶æ€å®šä¹‰ã€‚æˆ‘ä»¬å®šä¹‰ $f[k][i_1][i_2]$ è¡¨ç¤ºç¬¬ä¸€ä¸ªäººèµ°åˆ° $(i_1,k-i_1)$ ä¸”ç¬¬äºŒä¸ªäººèµ°åˆ° $(i_2,k-i_2)$ æ—¶çš„æœ€å¤§æ”¶ç›Šã€‚åˆ™æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ $f[2n-2][n-1][n-1]$ã€‚çŠ¶æ€è½¬ç§»åŒç†ï¼Œä» 4 ä¸ªåˆæ³•å­é—®é¢˜è½¬ç§»è¿‡æ¥å³å¯ã€‚
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^3)$

æš´åŠ› dpï¼š

```cpp
template<class T>
void chmax(T& a, T b) {
    a = max(a, b);
}

int di[4] = {-1, -1, 0, 0};
int dj[4] = {0, 0, -1, -1};
int dp[4] = {-1, 0, -1, 0};
int dq[4] = {0, -1, 0, -1};

class Solution {
public:
    int cherryPickup(vector<vector<int>>& g) {
        int n = g.size();
        int f[n][n][n][n];
        memset(f, -1, sizeof f);
        f[0][0][0][0] = g[0][0] == -1 ? -1 : g[0][0];
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < n; j++) {
                if (g[i][j] == -1) {
                    continue;
                }
                for (int p = 0; p < n; p++) {
                    for (int q = 0; q < n; q++) {
                        if (g[p][q] == -1) {
                            continue;
                        }
                        // æšä¸¾ 4 ä¸ªå­é—®é¢˜
                        for (int k = 0; k < 4; k++) {
                            int ni = i + di[k], nj = j + dj[k];
                            int np = p + dp[k], nq = q + dq[k];
                            if (ni >= 0 && nj >= 0 && np >= 0 && nq >= 0 && f[ni][nj][np][nq] != -1) {
                                chmax(f[i][j][p][q], f[ni][nj][np][nq] + g[i][j] + (i == p && j == q ? 0 : g[p][q]));
                            }
                        }
                    }
                }
            }
        }
        return f[n - 1][n - 1][n - 1][n - 1] == -1 ? 0 : f[n - 1][n - 1][n - 1][n - 1];
    }
};
```

ä¼˜åŒ– dpï¼š

```cpp
template<class T>
void chmax(T& a, T b) {
    a = max(a, b);
}

int dx[] = {0, 0, -1, -1};
int dy[] = {0, -1, 0, -1};

class Solution {
public:
    int cherryPickup(vector<vector<int>>& g) {
        int n = g.size();
        int f[2 * n - 1][n][n];
        memset(f, -1, sizeof f);
        f[0][0][0] = g[0][0] == -1 ? -1 : g[0][0];
        for (int k = 1; k <= 2 * n - 2; k++) {
            for (int i1 = 0; i1 < n; i1++) {
                for (int i2 = 0; i2 < n; i2++) {
                    int j1 = k - i1, j2 = k - i2;
                    if (j1 < 0 || j1 >= n || j2 < 0 || j2 >= n || g[i1][j1] == -1 || g[i2][j2] == -1) {
                        continue;
                    }
                    // æšä¸¾ 4 ä¸ªå­é—®é¢˜
                    for (int t = 0; t < 4; t++) {
                        int ni1 = i1 + dx[t], nj1 = k - ni1;
                        int ni2 = i2 + dy[t], nj2 = k - ni2;
                        if (ni1 >= 0 && nj1 >= 0 && ni2 >= 0 && nj2 >= 0 && f[k - 1][ni1][ni2] != -1) {
                            chmax(f[k][i1][i2], f[k - 1][ni1][ni2] + g[i1][j1] + (i1 == i2 && j1 == j2 ? 0 : g[i2][j2]));
                        }
                    }
                }
            }
        }
        return f[2 * n - 2][n - 1][n - 1] == -1 ? 0 : f[2 * n - 2][n - 1][n - 1];
    }
};
```

### æ ‘å½¢ dp

æ ‘çš„è·¯å¾„é—®é¢˜ï¼Œè€ƒè™‘å›æº¯ã€‚å¦‚ä½•æ›´æ–°å€¼ï¼Ÿå¦‚ä½•è¿”å›å€¼ï¼Ÿè§†é¢‘å­¦ä¹ ï¼š<https://www.bilibili.com/video/BV17o4y187h1/>ã€‚

æœ€å¤§ç¤¾äº¤æ·±åº¦å’Œ

<https://vijos.org/d/nnu_contest/p/1534>

> ç®—æ³•ï¼šæ ‘å½¢ dpã€BFS
>
> é¢˜æ„ï¼šç»™å®šä¸€æ£µæ ‘ï¼Œç°åœ¨éœ€è¦é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªç»“ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ï¼Œä½¿å¾—æ·±åº¦å’Œæœ€å¤§ã€‚æ·±åº¦çš„å®šä¹‰æ˜¯ä»¥æ¯ä¸ªç»“ç‚¹åˆ°æ ‘æ ¹æ‰€ç»å†çš„ç»“ç‚¹æ•°
>
> æ€è·¯ä¸€ï¼šæš´åŠ›
>
> - æ˜¾ç„¶å¯ä»¥ç›´æ¥éå†æ¯ä¸€ä¸ªç»“ç‚¹ï¼Œè®¡ç®—æ¯ä¸ªç»“ç‚¹çš„æ·±åº¦å’Œï¼Œç„¶åå–æœ€å¤§å€¼å³å¯
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$
>
> æ€è·¯äºŒï¼šæ ‘å½¢ dp
>
> ![æ ‘å½¢ dp å›¾è§£](https://cdn.dwj601.cn/images/202403182214257.png)
>
> - æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹äºå½“å‰çš„æ ¹ç»“ç‚¹ `fa`ï¼Œæˆ‘ä»¬é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªå­ç»“ç‚¹ `ch`ï¼Œå°† `ch` ä½œä¸ºæ–°çš„æ ¹ç»“ç‚¹ï¼ˆå¦‚å³å›¾ï¼‰ã€‚é‚£ä¹ˆå¯¹äºå½“å‰çš„ `ch` çš„æ·±åº¦å’Œï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© `fa` çš„æ·±åº¦å’Œè¿›è¡Œæ±‚è§£ã€‚æˆ‘ä»¬å‡è®¾ä»¥ `ch` ä¸ºå­æ ‘çš„ç»“ç‚¹æ€»æ•°ä¸º `x`ï¼Œé‚£ä¹ˆè¿™ `x` ä¸ªç»“ç‚¹åœ¨æ¢æ ¹ä¹‹åï¼Œç›¸å¯¹äº `ch` çš„æ·±åº¦å’Œï¼Œè´¡çŒ®äº† `-x` çš„æ·±åº¦ï¼›è€Œå¯¹äº `fa` çš„å‰©ä¸‹æ¥çš„ `n-x` ä¸ªç»“ç‚¹ï¼Œç›¸å¯¹äº `ch` çš„æ·±åº¦å’Œï¼Œè´¡çŒ®äº† `n-x` çš„æ·±åº¦ã€‚äºæ˜¯ `ch` çš„æ·±åº¦å’Œå°±æ˜¯ `façš„æ·±åº¦å’Œ` `-x+n-x`ï¼Œå³ï¼š
>
>     $$
>     dep [ch] = dep [fa]-x+n-x = dep [fa]+n-2\times x
>     $$
>
>     äºæ˜¯æˆ‘ä»¬å¾ˆå¿«å°±èƒ½æƒ³åˆ°åˆ©ç”¨å‰åå±‚çš„é€’æ¨å…³ç³»ï¼Œ$O(1)$ çš„è®¡ç®—å‡ºæ‰€æœ‰å­ç»“ç‚¹çš„æ·±åº¦å’Œã€‚
>
>     ä»£ç å®ç°ï¼šæˆ‘ä»¬å¯ä»¥å…ˆè®¡ç®—å‡º `base` çš„æƒ…å†µï¼Œå³ä»»é€‰ä¸€ä¸ªç»“ç‚¹ä½œä¸ºæ ¹ç»“ç‚¹ï¼Œç„¶ååŸºäºæ­¤è¿›è¡Œè¿­ä»£è®¡ç®—ã€‚åœ¨è¿­ä»£è®¡ç®—çš„æ—¶å€™éœ€è¦æ³¨æ„çš„ç‚¹å°±æ˜¯åœ¨ä¸€é `dfs` è®¡ç®—æŸä¸ªç»“ç‚¹çš„æ·±åº¦å’Œ `dep[root]` æ—¶ï¼Œå¦‚æœå¸Œæœ›åŒæ—¶è®¡ç®—å‡ºæ¯ä¸€ä¸ªç»“ç‚¹ä½œä¸ºå­æ ‘æ—¶ï¼Œå­æ ‘çš„ç»“ç‚¹æ•°ï¼Œæ˜¾ç„¶éœ€è¦åˆ†æ²»è®¡ç®—ä¸€æ³¢ã€‚å…³äºåˆ†æ²»çš„è®¡ç®—æˆ‘ç†Ÿç»ƒåº¦ä¸å¤Ÿé«˜ï¼Œ~~ç‰¹æ­¤æ ‡æ³¨ä¸€ä¸‹ debug äº† 3h çš„ç‚¹~~ï¼šå³åœ¨é€’å½’åˆ°æœ€åº•å±‚ï¼Œè¿›è¡Œå›æº¯è®¡ç®—çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä¸èƒ½ç»Ÿè®¡çˆ¶ç»“ç‚¹çš„ç»“ç‚¹å€¼ï¼ˆå› ä¸ºå»ºçš„æ˜¯åŒå‘å›¾ï¼Œæ‰€ä»¥ä¸€å®šä¼šæœ‰ä»çˆ¶ç»“ç‚¹å›æº¯çš„æƒ…å†µï¼‰ï¼Œé‚£ä¹ˆä¸ºäº†é¿å¼€è¿™ä¸ªç‚¹ï¼Œå°±éœ€è¦åœ¨ $O(1)$ çš„æ—¶é—´å¤æ‚åº¦å†…è·å¾—å½“å‰ç»“ç‚¹çš„çˆ¶ç»“ç‚¹çš„ç¼–å·ï¼Œä»è€Œè¿›è¡Œç‰¹åˆ¤ï¼Œé‡‡ç”¨çš„æ–¹å¼å°±æ˜¯å¢åŠ é€’å½’å‚æ•° `fa`ã€‚
>
> - æ²¡æœ‰è€ƒè™‘ä»çˆ¶ç»“ç‚¹å›æº¯çš„æƒ…å†µçš„ dfs ä»£ç 
>
>     ```cpp
>     void dfs(int now, int depth) {
>         if (!st[now]) {
>             st[now] = true;
>             dep[root] += depth;
>             for (auto& ch: G[now]) {
>                 dfs(ch, depth + 1);
>                 cnt[now] += cnt[ch];
>             }
>         }
>     }
>     ```
>
> - è€ƒè™‘äº†ä»çˆ¶ç»“ç‚¹å›æº¯çš„æƒ…å†µçš„ dfs ä»£ç 
>
>     ```cpp
>     void dfs(int now, int fa, int depth) {
>         if (!st[now]) {
>             st[now] = true;
>             dep[root] += depth;
>             for (auto& ch: G[now]) {
>                 dfs(ch, now, depth + 1);
>                 if (ch != fa) {
>                     cnt[now] += cnt[ch];
>                 }
>             }
>         }
>     }
>     ```
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$\Theta(2n)$

æš´åŠ›ä»£ç ï¼š

```cpp
const int N = 500010;

int n;
vector<int> G[N];
int st[N], dep[N];

void dfs(int id, int now, int depth) {
    if (!st[now]) {
        st[now] = 1;
        dep[id] += depth;
        for (auto& node: G[now]) {
            dfs(id, node, depth + 1);
        }
    }
}

void solve() {
    cin >> n;
    for (int i = 1; i <= n - 1; i++) {
        int a, b;
        cin >> a >> b;
        G[a].push_back(b);
        G[b].push_back(a);
    }

    int res = 0;

    for (int i = 1; i <= n; i++) {
        memset(st, 0, sizeof st);
        dfs(i, i, 1);
        res = max(res, dep[i]);
    }

    cout << res << "\n";
}
```

ä¼˜åŒ–ä»£ç ï¼š

```cpp
const int N = 500010;

int n, dep[N], root = 1;
vector<int> G[N], cnt(N, 1);;
bool st[N];

// å½“å‰ç»“ç‚¹ç¼–å· nowï¼Œå½“å‰ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ faï¼Œå½“å‰ç»“ç‚¹æ·±åº¦ depth
void dfs(int now, int fa, int depth) {
    if (!st[now]) {
        st[now] = true;
        dep[root] += depth;
        for (auto& ch: G[now]) {
            dfs(ch, now, depth + 1);
            if (ch != fa) {
                cnt[now] += cnt[ch];
            }
        }
    }
}

void bfs() {
    memset(st, 0, sizeof st);
    queue<int> q;
    q.push(root);
    st[root] = true;

    while (q.size()) {
        int fa = q.front(); // çˆ¶ç»“ç‚¹ç¼–å· fa
        q.pop();
        for (auto& ch: G[fa]) {
            if (!st[ch]) {
                st[ch] = true;
                dep[ch] = dep[fa] + n - 2 * cnt[ch];
                q.push(ch);
            }
        }
    }
}

void solve() {
    cin >> n;
    for (int i = 1; i <= n - 1; i++) {
        int a, b;
        cin >> a >> b;
        G[a].push_back(b);
        G[b].push_back(a);
    }

    dfs(root, -1, 1);
    bfs();

    cout << *max_element(dep, dep + n + 1) << "\n";
}
```

### é«˜ç»´ dp

æ ˆ

<https://www.luogu.com.cn/problem/P1044>

> é¢˜æ„ï¼šn ä¸ªæ•°ä¾æ¬¡è¿›æ ˆï¼Œéšæœºå‡ºæ ˆï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ç§å‡ºæ ˆåºåˆ—ï¼Ÿ
>
> **æ€è·¯ä¸€ï¼šdfs**
>
> - æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆæ„é€ æœç´¢æ ‘ï¼šå·²çŸ¥å¯¹äºå½“å‰çš„æ ˆï¼Œä¸€å…±æœ‰ä¸¤ç§çŠ¶æ€
>     - å…¥æ ˆ - å¦‚æœå½“å‰è¿˜æœ‰æ•°æ²¡æœ‰å…¥æ ˆ
>     - å‡ºæ ˆ - å¦‚æœå½“å‰æ ˆå†…è¿˜æœ‰å…ƒç´ 
> - æœç´¢å‚æ•°ï¼š`i,j` è¡¨ç¤ºå…¥æ ˆæ•°ä¸º `i` å‡ºæ ˆæ•°ä¸º `j` çš„çŠ¶æ€
> - æœç´¢ç»ˆæ­¢æ¡ä»¶
>     - å…¥æ ˆæ•° < å‡ºæ ˆæ•° - $i<j$
>     - å…¥æ ˆæ•° > æ€»æ•° $n$ - $i = n$
> - ç­”æ¡ˆçŠ¶æ€ï¼šå…¥æ ˆæ•°ä¸º nï¼Œå‡ºæ ˆæ•°ä¹Ÿä¸º n
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(\text{æ–¹æ¡ˆæ•°})$
>
> **æ€è·¯äºŒï¼šdp**
>
> - é‡‡ç”¨ä¸Šè¿° dfs æ—¶çš„çŠ¶æ€è¡¨ç¤ºæ–¹æ³•ï¼Œ`i,j` è¡¨ç¤ºå…¥æ ˆæ•°ä¸º `i` å‡ºæ ˆæ•°ä¸º `j` çš„çŠ¶æ€ã€‚
>
> - æˆ‘ä»¬åœ¨æœç´¢çš„æ—¶å€™ï¼Œè€ƒè™‘çš„æ˜¯æ¥ä¸‹æ¥å¯ä»¥æœç´¢çš„çŠ¶æ€
>
>     1. å³å‡ºæ ˆä¸€ä¸ªæ•°çš„çŠ¶æ€ - `i+1,j`
>
>     2. å’Œå…¥æ ˆä¸€ä¸ªæ•°çš„çŠ¶æ€ - `i,j+1`
>
>     å¦‚å›¾ï¼š
>
>     ![å›¾è§£](https://cdn.dwj601.cn/images/202403182214793.png)
>
>     è€Œæˆ‘ä»¬åœ¨ dp çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘çš„æ˜¯å­ç»“æ„çš„è§£æ¥å¾—å‡ºå½“å‰çŠ¶æ€çš„ç­”æ¡ˆï¼Œå°±éœ€è¦è€ƒè™‘ä¹‹å‰çš„çŠ¶æ€ã€‚å³å½“å‰çŠ¶æ€æ˜¯ä»ä¹‹å‰çš„å“ªäº›çŠ¶æ€è½¬ç§»è¿‡æ¥çš„ã€‚å’Œä¸Šè¿° dfs æ€è·¯æ˜¯ç›¸åçš„ã€‚æˆ‘ä»¬éœ€è¦è€ƒè™‘çš„æ˜¯
>
>     1. ä¸Šä¸€ä¸ªçŠ¶æ€å…¥æ ˆä¸€ä¸ªæ•°åˆ°å½“å‰çŠ¶æ€ - `i-1,j` $\to$ `i,j`
>     2. ä¸Šä¸€ä¸ªçŠ¶æ€å‡ºæ ˆä¸€ä¸ªæ•°åˆ°å½“å‰çŠ¶æ€ - `i,j-1` $\to$ `i,j`
>
>     - ç‰¹ä¾‹ï¼š$i=j$ æ—¶ï¼Œåªèƒ½æ˜¯ä¸Šè¿°ç¬¬äºŒç§çŠ¶æ€è½¬ç§»è€Œæ¥ï¼Œå› ä¸ºè¦å§‹ç»ˆä¿è¯å…¥æ ˆæ•°å¤§äºç­‰äºå‡ºæ ˆæ•°ï¼Œå³ $i \ge j$
>
>     å¦‚å›¾ï¼š
>
>     ![å›¾è§£](https://cdn.dwj601.cn/images/202403191805594.png)
>
> - æˆ‘ä»¬çŸ¥é“ï¼Œå…¥æ ˆæ•°ä¸€å®šæ˜¯å¤§äºç­‰äºå‡ºæ ˆæ•°çš„ï¼Œå³ $i\ge j$ã€‚äºæ˜¯æˆ‘ä»¬åœ¨æšä¸¾ $j$ çš„æ—¶å€™ï¼Œæšä¸¾çš„èŒƒå›´æ˜¯ $[1,i]$
>
> - $base$ çŠ¶æ€çš„æ„å»ºå–å†³äº $j=0$ æ—¶çš„æ‰€æœ‰çŠ¶æ€ï¼Œæˆ‘ä»¬çŸ¥é“æ²¡æœ‰ä»»ä½•æ•°å‡ºæ ˆä¹Ÿæ˜¯ä¸€ç§çŠ¶æ€ï¼Œäºæ˜¯
> 
>     $$
>     dp [i][0] = 0,(i = 1,2,3,..., n)
>     $$
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$

dfs ä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

int n, res;

// å…¥æ ˆiä¸ªæ•°ï¼Œå‡ºæ ˆjä¸ªæ•°
void dfs(int i, int j) {
    if (i < j || i > n) return;

    if (i == n && j == n) res++;

    dfs(i + 1, j);
    dfs(i, j + 1);
}

void solve() {
    cin >> n;
    dfs(0, 0);
    cout << res << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

dp ä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

const int N = 20;

int n;
ll dp[N][N]; // dp[i][j] è¡¨ç¤ºå…¥æ ˆæ•°ä¸ºiï¼Œå‡ºæ ˆæ•°ä¸ºjçš„æ–¹æ¡ˆæ€»æ•°

void solve() {
    cin >> n;

    // baseçŠ¶æ€ï¼šæ²¡æœ‰æ•°å‡ºæ ˆä¹Ÿæ˜¯ä¸€ç§çŠ¶æ€
    for (int i = 1; i <= n; i++) dp[i][0] = 1;

    // dpè½¬ç§»
    for (int i = 1; i <= n; i++)
        for (int j = 1; j <= i; j++)
            if (i == j) dp[i][j] = dp[i][j - 1];
            else dp[i][j] = dp[i - 1][j] + dp[i][j - 1];

    cout << dp[n][n] << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

æ‰¾å‡ºæ‰€æœ‰ç¨³å®šçš„äºŒè¿›åˆ¶æ•°ç»„ II

<https://leetcode.cn/problems/find-all-possible-stable-binary-arrays-ii/>

> é¢˜æ„ï¼šæ„é€ ä¸€ä¸ªä»…å«æœ‰ $n$ ä¸ª $0$ï¼Œ$m$ ä¸ª $1$ çš„æ•°ç»„ï¼Œä¸”é•¿åº¦è¶…è¿‡ $k$ çš„å­æ•°ç»„å¿…é¡»åŒæ—¶å«æœ‰ $0$ å’Œ $1$ã€‚ç»™å‡ºæ„é€ çš„æ€»æ–¹æ¡ˆæ•°å¯¹ $10^9+7$ å–ä½™åçš„ç»“æœã€‚
>
> æ€è·¯ï¼š
>
> - å®šä¹‰çŠ¶æ€è¡¨ã€‚æˆ‘ä»¬ä»å·¦åˆ°å³ç¡®å®šæ¯ä¸€ä½çš„æ•°å­—æ—¶ï¼Œéœ€è¦ç¡®å®šè¿™ä¹ˆä¸‰ä¸ªä¿¡æ¯ï¼šå½“å‰æ˜¯å“ªä¸€ä½ï¼Ÿè¿˜å‰©å‡ ä¸ª $0$ å’Œ $1$ï¼Ÿè¿™ä¸€ä½å¡« $0$ è¿˜æ˜¯ $1$ï¼Ÿå¯¹äºè¿™ä¸‰ä¸ªä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰çŠ¶æ€æ•°ç»„ $f[i][j][k]$ è¡¨ç¤ºå½“å‰å·²ç»é€‰äº† $i$ ä¸ª $0$ï¼Œ$j$ ä¸ª $1$ï¼Œä¸”ç¬¬ $i+j$ ä½å¡« $k$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚è¿™æ ·æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ $f[n][m][0]+f[n][m][1]$ã€‚
>
> - å®šä¹‰å­é—®é¢˜ã€‚ä»¥å½“å‰ç¬¬ $i+j$ ä½å¡« $0$ ä¸ºä¾‹ï¼Œå¡« $1$ åŒç†ï¼Œå³å½“å‰éœ€è¦ç»´æŠ¤çš„æ˜¯ $f[i][j][0]$ã€‚æ˜¾ç„¶çš„å¦‚æœå‰ä¸€ä½æ˜¯å’Œå½“å‰ä½ä¸åŒï¼Œå³ $1$ æ—¶ï¼Œå¯ä»¥ç›´æ¥è½¬ç§»è¿‡æ¥ï¼›å¦‚æœå‰ä¸€ä½å’Œå½“å‰ä½ç›¸åŒï¼Œå³ $0$ æ—¶ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°é•¿åº¦è¶…è¿‡ $k$ çš„è¿ç»­ $0$ å­æ•°ç»„ï¼Œå³å‰æ®µæ•°ç»„åˆšå¥½æ˜¯ä»¥ã€Œä¸€ä¸ª $1$ å’Œ $k$ ä¸ª $0$ ç»“å°¾çš„ã€åˆæ³•æ•°ç»„ï¼Œæ­¤æ—¶å†æ‹¼æ¥ä¸€ä¸ª $0$ å°±ä¸åˆæ³•äº†ã€‚
>
> - çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¸¤ä¸ªçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š
>
>     $$
>     \begin{aligned}
>     f [i][j] [0] = f [i - 1][j] [1] + f [i - 1][j] [0] - f [i - k - 1][j] [1] \\
>     f [i][j] [1] = f [i][j - 1] [0] + f [i][j - 1] [1] - f [i][j - k - 1] [0]
>     \end{aligned}
>     $$
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(nm)$

```cpp
class Solution {
public:
    int numberOfStableArrays(int n, int m, int k) {
        const int mod = 1e9 + 7;
        vector<vector<array<int, 2>>> f(n + 1, vector<array<int, 2>>(m + 1));

        for (int i = 0; i <= min(n, k); i++) {
            f[i][0][0] = 1;
        }
        for (int j = 0; j <= min(m, k); j++) {
            f[0][j][1] = 1;
        }

        for (int i = 1; i <= n; i++) {
            for (int j = 1; j <= m; j++) {
                f[i][j][0] = (f[i - 1][j][1] + f[i - 1][j][0]) % mod;
                if (i - k - 1 >= 0) {
                    f[i][j][0] = (f[i][j][0] - f[i - k - 1][j][1] + mod) % mod;
                }
                f[i][j][1] = (f[i][j - 1][0] + f[i][j - 1][1]) % mod;
                if (j - k - 1 >= 0) {
                    f[i][j][1] = (f[i][j][1] - f[i][j - k - 1][0] + mod) % mod;
                }
            }
        }

        return (f[n][m][0] + f[n][m][1]) % mod;
    }
};
```

å­¦ç”Ÿå‡ºå‹¤è®°å½• II

<https://leetcode.cn/problems/student-attendance-record-ii/description/>

> é¢˜æ„ï¼šæ„é€ ä¸€ä¸ªä»…å«æœ‰ $P,A,L$ ä¸‰ç§å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œä½¿å¾— $A$ æœ€å¤šå‡ºç° $1$ æ¬¡ï¼ŒåŒæ—¶ $L$ æœ€å¤šè¿ç»­å‡ºç° $2$ æ¬¡ã€‚é—®ä¸€å…±æœ‰å¤šå°‘ç§æ„é€ æ–¹æ¡ˆï¼Ÿå¯¹ $10^9+7$ å–æ¨¡ã€‚
>
> æ€è·¯ï¼š
>
> - æ¨¡æ‹Ÿåˆ†æé—®é¢˜ã€‚æˆ‘ä»¬ä»å‰å¾€åæ„é€ ã€‚å¯¹äºå½“å‰ç¬¬ $i$ ä¸ªå­—ç¬¦ $s[i]$ï¼Œæœ‰ $3$ ç§å¯èƒ½çš„é€‰é¡¹ï¼Œå…¶ä¸­ $P$ æ˜¯ä¸€å®šåˆæ³•çš„é€‰é¡¹ï¼Œ$A$ æ˜¯å¦åˆæ³•å–å†³äº $s[0:i-1]$ ä¸­çš„ $A$ çš„æ•°é‡ï¼Œ$L$ æ˜¯å¦åˆæ³•å–å†³äº $s[0:i-1]$ çš„æœ«å°¾è¿ç»­ $L$ çš„æ•°é‡ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ **è¢«åŠ¨è½¬ç§»** çš„åŠ¨æ€è§„åˆ’æ±‚è§£ã€‚
> - çŠ¶æ€å®šä¹‰ã€‚ä»ä¸Šè¿°åˆ†æä¸éš¾å‘ç°éœ€è¦ $3$ ç§çŠ¶æ€æ¥è¡¨ç¤ºæ‰€æœ‰æƒ…å†µï¼Œå› æ­¤æˆ‘ä»¬å®šä¹‰ $f[i][j][k]$ è¡¨ç¤ºæ„é€ ç¬¬ $i$ ä½æ—¶ï¼Œ$s[0:i]$ ä¸­å«æœ‰ $j$ ä¸ª $A$ ä¸”æœ«å°¾å«æœ‰è¿ç»­ $k$ ä¸ª $L$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚
> - åˆå§‹åŒ–ã€‚æ¯ä¸€ä½å¡«ä»€ä¹ˆå–å†³äºå‰ç¼€ $s[0:i-1]$ çš„æƒ…å†µï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åˆå§‹åŒ– $f[0][][]$ å³ç¬¬ $0$ ä½çš„æƒ…å†µã€‚æ˜¾ç„¶çš„ç¬¬ $0$ ä½ $P,A,L$ ä¸‰ç§éƒ½å¯ä»¥å¡«ï¼Œå¯¹åº”çš„å°±æ˜¯ $f[0][0][0] = f[0][1][0] = f[0][0][1] = 1$ï¼Œå…¶ä½™åˆå§‹åŒ–ä¸º $0$ å³å¯ã€‚
> - çŠ¶æ€è½¬ç§»ã€‚è€ƒè™‘ç¬¬ $i$ ä½çš„ä¸‰ç§æƒ…å†µï¼š
>     1. å¡« $P$ï¼šå¯ä»¥ç”¨å‰ç¼€çš„æ‰€æœ‰çŠ¶æ€æ¥æ›´æ–° $f[i][j][0]$
>     2. å¡« $A$ï¼šå¯ä»¥ç”¨å‰ç¼€ä¸­ä¸å« $A$ çš„æ‰€æœ‰çŠ¶æ€æ¥æ›´æ–° $f[i][1][0]$
>     3. å¡« $L$ï¼šå¯ä»¥ç”¨å‰ç¼€ä¸­æœ«å°¾ä¸è¶…è¿‡ $1$ ä½ $L$ çš„æ‰€æœ‰çŠ¶æ€æ¥æ›´æ–° $f[i][j][k]$
> - æœ€ç»ˆç­”æ¡ˆã€‚ä¸º $\displaystyle \sum_{j=0}^{1}\sum_{k=0}^{2}f[n-1][j][k]$ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$\Theta (6n)$

```cpp
class Solution {
public:
    int checkRecord(int n) {
        const int mod = 1e9 + 7;

        // f[i][j][k]è¡¨ç¤ºä»å·¦å¾€å³æ„é€ ç¬¬iä½æ—¶ï¼Œs[0:i]ä¸­å«æœ‰jä¸ªAä¸”å°¾éƒ¨å«æœ‰è¿ç»­kä¸ªLæ—¶çš„æ–¹æ¡ˆæ•°
        int f[n][2][3];
        memset(f, 0, sizeof f);

        // åˆå§‹åŒ–
        f[0][0][0] = f[0][1][0] = f[0][0][1] = 1;

        // è½¬ç§»
        for (int i = 1; i < n; i++) {
            // s[i]å¡«P
            for (int j = 0; j <= 1; j++) {
                for (int k = 0; k <= 2; k++) {
                    f[i][j][0] = (f[i][j][0] + f[i - 1][j][k]) % mod;
                }
            }
            // s[i]å¡«A
            for (int k = 0; k <= 2; k++) {
                f[i][1][0] = (f[i][1][0] + f[i - 1][0][k]) % mod;
            }
            // s[i]å¡«L
            for (int j = 0; j <= 1; j++) {
                for (int k = 1; k <= 2; k++) {
                    f[i][j][k] = (f[i][j][k] + f[i - 1][j][k - 1]) % mod;
                }
            }
        }

        // è®¡ç®—ç­”æ¡ˆ
        int res = 0;
        for (int j = 0; j <= 1; j++) {
            for (int k = 0; k <= 2; k++) {
                res = (res + f[n - 1][j][k]) % mod;
            }
        }
        return res;
    }
};
```

```python
class Solution:
    def checkRecord(self, n: int) -> int:
        mod = int(1e9 + 7)
        f = [[[0, 0, 0] for _ in range(2)] for _ in range(n)]
        f[0][0][0] = f[0][1][0] = f[0][0][1] = 1
        for i in range(1, n):
            # P
            for j in range(2):
                for k in range(3):
                    f[i][j][0] = (f[i][j][0] + f[i - 1][j][k]) % mod
            # A
            for k in range(3):
                f[i][1][0] = (f[i][1][0] + f[i - 1][0][k]) % mod
            # L
            for j in range(2):
                for k in range(1, 3):
                    f[i][j][k] = (f[i][j][k] + f[i - 1][j][k - 1]) % mod
        res = 0
        for j in range(2):
            for k in range(3):
                res = (res + f[n - 1][j][k]) % mod
        return res
```

### åŒºé—´ dp

å¯¹ç§°å±±è„‰

<https://www.acwing.com/problem/content/5169/>

æ¨¡æ‹Ÿï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^3)$

```cpp
#include <iostream>
#include <cmath>

using namespace std;

const int N = 5010;

int n;
int a[N];

int main() {
    cin >> n;
    
    for (int i = 1; i <= n; i++)
        cin >> a[i];
    
    // æšä¸¾åŒºé—´é•¿åº¦
    for (int len = 1; len <= n; len++) {
        int res = 2e9;
        // æšä¸¾ç›¸åº”é•¿åº¦çš„æ‰€æœ‰åŒºé—´
        for (int i = 1, j = i + len - 1; j <= n; i++, j++) {
            // è®¡ç®—åŒºé—´çš„ä¸å¯¹ç§°å€¼
            int l = i, r = j;
            int sum = 0;
            while (l < r) {
                sum += abs(a[l] - a[r]);
                l++, r--;
            }
            res = min(res, sum);
        }
        cout << res << ' ';
    }
    
    return 0;
}
```

dp ä¼˜åŒ–ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^2)$

```cpp
#include <iostream>
#include <cmath>
#include <cstring>

using namespace std;

const int N = 5010;

int n;
int a[N];

int dp[N][N]; // dp[i][j] è¡¨ç¤ºç¬¬ i åˆ° j çš„ä¸å¯¹ç§°å€¼
int res[N];   // res[len] è¡¨ç¤ºé•¿åº¦ä¸º len çš„å±±è„‰çš„æœ€å°ä¸å¯¹ç§°å€¼ 

int main() {
    cin >> n;
    
    for (int i = 1; i <= n; i++)
        cin >> a[i];
    
    memset(res, 0x3f, sizeof res);
    
    // é•¿åº¦ä¸º 1 çš„æƒ…å†µ
    res[1] = 0;
    
    // é•¿åº¦ä¸º 2 çš„æƒ…å†µ
    for (int i = 1, j = i + 1; j <= n; i++, j++) {
        dp[i][j] = abs(a[i] - a[j]);
        res[2] = min(res[2], dp[i][j]);
    }
    
    // é•¿åº¦ >= 3 çš„æƒ…å†µ 
    for (int len = 3; len <= n; len++) {
        for (int i = 1, j = i + len - 1; j <= n; i++, j++) {
            dp[i][j] = dp[i + 1][j - 1] + abs(a[i] - a[j]);
            res[len] = min(res[len], dp[i][j]);
        }
    }
    
    for (int i = 1; i <= n; i++)
        cout << res[i] << ' ';
    
    return 0;
}
```

### çŠ¶å‹ dp

Avoid K Palindrome

<https://atcoder.jp/contests/abc359/tasks/abc359_d>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n\le 1000$ çš„å­—ç¬¦ä¸² $s$ å’Œä¸€ä¸ªæ•´æ•° $k\le10$ï¼Œå…¶ä¸­å«æœ‰è‹¥å¹²ä¸ª `'A'`, `'B'` å’Œ `'?'`ã€‚å…¶ä¸­ `'?'` å¯ä»¥è½¬åŒ–ä¸º `'A'` æˆ– `'B'`ï¼Œå‡è®¾æœ‰ $q$ å’Œ `'?'`ï¼Œåˆ™ä¸€å…±å¯ä»¥è½¬åŒ–å‡º $2^q$ ä¸ªä¸åŒçš„ $s$ã€‚é—®æ‰€æœ‰è½¬åŒ–å‡ºçš„ $s$ ä¸­ï¼Œæœ‰å¤šå°‘æ˜¯ä¸å«æœ‰é•¿åº¦ä¸º $k$ çš„å›æ–‡å­ä¸²çš„ã€‚
>
> æ€è·¯ï¼šæœ€æš´åŠ›çš„åšæ³•å°±æ˜¯ 2^q æšä¸¾æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦ä¸²ï¼Œç„¶åå† O(n) çš„æ£€æŸ¥ï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦ä¸º $O(n2^n)$ï¼Œåªèƒ½é€šè¿‡ 20 ä»¥å†…çš„æ•°æ®ã€‚ä¸€èˆ¬å­—ç¬¦ä¸²å›æ–‡é—®é¢˜å¯ä»¥è€ƒè™‘ dpã€‚

åƒå¥¶é…ª

<https://www.luogu.com.cn/problem/P1433>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªå¹³é¢ç›´è§’åæ ‡ç³»ä¸ n ä¸ªç‚¹çš„åæ ‡ï¼Œèµ·ç‚¹åœ¨åæ ‡åŸç‚¹ã€‚é—®å¦‚ä½•é€‰æ‹©è¡Œè¿›è·¯çº¿ä½¿å¾—åˆ°è¾¾æ¯ä¸€ä¸ªç‚¹ä¸”æ€»è·¯ç¨‹æœ€çŸ­ 
> - æ€è·¯ä¸€ï¼šçˆ†æœã€‚é¢˜ä¸­çš„ $n \le 15$ ç›´æ¥æ— è„‘çˆ†æœï¼Œä½†æ˜¯ **TLE**ã€‚çˆ†æœçš„æ€è·¯ä¸ºï¼šæ¯æ¬¡é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œæ¥ä¸‹æ¥é€‰æ‹©å‰©ä½™çš„æ²¡æœ‰è¢«é€‰æ‹©è¿‡çš„ç‚¹ç»§ç»­æœç´¢ï¼ŒçŸ¥é“æ‰€æœ‰çš„ç‚¹å…¨éƒ¨éƒ½æœåˆ°ä¸ºæ­¢
>
>     æ—¶é—´å¤æ‚åº¦ï¼š$O(n!)$
>
> - æ€è·¯äºŒï¼šçŠ¶æ€å‹ç¼© DPã€‚
>
>     æ—¶é—´å¤æ‚åº¦ï¼š$O()$

çˆ†æœä»£ç 

```cpp
#include <bits/stdc++.h>
#define int long long
using namespace std;

const int N = 20;

int n;
double res = 4000.0;
bool vis[N];

struct Idx {
    double x, y;
} a[N];

double d(Idx be, Idx en) {
    return sqrt((be.x - en.x) * (be.x - en.x) + (be.y - en.y) * (be.y - en.y));
}

// çˆ¶ç»“ç‚¹åæ ‡ faï¼Œå½“å‰ç»“ç‚¹æ¬¡åº nowï¼Œå½“å‰è·¯å¾„é•¿åº¦ len 
void dfs(Idx fa, int now, double len) {
    vis[now] = true;
    
    if (count(vis + 1, vis + n + 1, true) == n) {
        res = min(res, len);
    }
    
    for (int i = 1; i <= n; i++)
        if (!vis[i])
            dfs(a[now], i, len + d(a[now], a[i]));
    
    vis[now] = false;
}

void solve() {
    cin >> n;
    for (int i = 1; i <= n; i++) {
        cin >> a[i].x >> a[i].y; 
    }
    
    for (int i = 1; i <= n; i++) {
        Idx fa = {0, 0};
        dfs(fa, i, d(fa, a[i]));
    }
    
    cout << fixed << setprecision(2) << res << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

çŠ¶å‹ dp ä»£ç 

```cpp

```

## å›¾è®º

å›¾è®ºçš„ã€Œä¾‹é¢˜è§£æã€ã€‚

### æ‹“æ‰‘

æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ—

<https://www.acwing.com/problem/content/850/>

> é¢˜æ„ï¼šè¾“å‡ºä¸€ä¸ªå›¾çš„æ‹“æ‰‘åºï¼Œä¸å­˜åœ¨åˆ™è¾“å‡º-1
>
> æ€è·¯ï¼š
>
> - é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“æ‹“æ‰‘å›¾çš„æ¦‚å¿µï¼Œæ„Ÿå®˜ä¸Šå°±æ˜¯ä¸€å¼ å›¾å¯ä»¥ä»ä¸€ä¸ªæ–¹å‘æ‹“å±•åˆ°å…¨å›¾ï¼Œç”¨æ•°å­¦è¯­è¨€å°±æ˜¯ï¼šè‹¥ä¸€ä¸ªç”±å›¾ä¸­æ‰€æœ‰ç‚¹æ„æˆçš„åºåˆ— A æ»¡è¶³ï¼šå¯¹äºå›¾ä¸­çš„æ¯æ¡è¾¹ (x, y)ï¼Œx åœ¨ A ä¸­éƒ½å‡ºç°åœ¨ y ä¹‹å‰ï¼Œåˆ™ç§° A æ˜¯è¯¥å›¾çš„ä¸€ä¸ªæ‹“æ‰‘åºåˆ—
> - æ¥ç€æˆ‘ä»¬å°±æƒ³è¦å¯»æ‰¾è¿™æ ·çš„åºåˆ— A äº†ï¼Œå¯ä»¥å‘ç°å¯¹äºæ¯ä¸€ä¸ªå¯æ‰©å±•çš„ç‚¹ï¼Œå…¥åº¦ä¸€å®šä¸º 0ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»è¿™äº›ç‚¹å¼€å§‹å®½æœï¼Œå°†æœåˆ°çš„ç‚¹çš„å…¥åº¦-1ï¼Œå³åˆ é™¤è¿™æ¡è¾¹ï¼Œç›´åˆ°æœ€åã€‚å¦‚æœå…¨å›¾çš„ç‚¹çš„å…¥åº¦éƒ½å˜ä¸ºäº† 0ï¼Œåˆ™æ­¤å›¾å¯æ‹“æ‰‘
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n+m)$

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 100010;

int n, m;
vector<int> G[N];

void solve() {
    // å»ºå›¾ 
    cin >> n >> m;
    vector<int> d(n + 1, 0);
    for (int i = 1; i <= m; i++) {
        int a, b;
        cin >> a >> b;
        d[b]++;
        G[a].push_back(b);
    }
    
    // é¢„å¤„ç†å®½æœèµ·å§‹ç‚¹é›†
    queue<int> q;
    for (int i = 1; i <= n; i++)
        if (!d[i])
            q.push(i);
    
    // å®½æœå¤„ç†
    vector<int> res;
    while (q.size()) {
        auto h = q.front();
        q.pop();
        res.push_back(h);
        
        for (auto& ch: G[h]) {
            d[ch]--;
            if (!d[ch]) q.push(ch);
        }
    }
    
    // è¾“å‡ºåˆæ³•æ‹“æ‰‘åº
    if (res.size() == n) {
        for (auto& x: res) {
            cout << x << " ";
        }
    } else {
        cout << -1 << "\n";
    }
}

int main() {
    solve();
    return 0;
}
```

Mad City

<https://codeforces.com/contest/1873/problem/H>

> æ ‡ç­¾ï¼šåŸºç¯æ ‘ã€æ‹“æ‰‘æ’åº
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªåŸºç¯æ ‘ï¼Œç°åœ¨å›¾ä¸Šæœ‰ä¸¤ä¸ªç‚¹ï¼Œåˆ†åˆ«å«åš Aï¼ŒBã€‚ç°åœ¨ B æƒ³è¦é€ƒè„± A çš„æŠ“æ•ï¼Œé—®å¯¹äºç»™å®šçš„å±€é¢ï¼ŒB èƒ½å¦æ°¸è¿œé€ƒç¦» A çš„æŠ“æ•
>
> æ€è·¯ï¼šæ€è·¯å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ† B æ‰€åœ¨ä½ç½®çš„ä¸¤ç§æƒ…å†µè®¨è®ºå³å¯
>
> 1. B ä¸åœ¨ç¯ä¸Šï¼šæ­¤æ—¶æˆ‘ä»¬è®°è·ç¦» B æœ€è¿‘çš„ç¯ä¸Šçš„é‚£ä¸ªç‚¹å« $tag$ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒçš„æ˜¯ A åˆ° tag ç‚¹çš„è·ç¦» $d_A$ å’Œ B åˆ° tag çš„è·ç¦» $d_B$ï¼Œå¦‚æœ $d_B < d_A$ï¼Œåˆ™ä¸€å®šå¯ä»¥é€ƒè„±ï¼Œå¦åˆ™ä¸€å®šä¸å¯ä»¥é€ƒè„±
> 2. B åœ¨ç¯ä¸Šï¼šæ­¤æ—¶æˆ‘ä»¬åªéœ€è¦åˆ¤æ–­å½“å‰çš„ A ç‚¹æ˜¯å¦ä¸ B çš„ä½ç½®é‡åˆå³å¯ï¼Œå¦‚æœé‡åˆé‚£å°±æ— æ³•é€ƒè„±ï¼Œåä¹‹ B ä¸€å®šå¯ä»¥é€ƒè„±ã€‚
>
> ä»£ç å®ç°ï¼š
>
> 1. å¯¹äºç¬¬ä¸€ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ° tag ç‚¹ä»¥åŠè®¡ç®— A å’Œ B åˆ° tag ç‚¹çš„è·ç¦»ï¼Œ
>
> æ—¶é—´å¤æ‚åº¦ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 200010;

int n, a, b;
vector<int> G[N];
int rd[N], tag, d[N];
bool del[N], vis[N];

void init() {
    for (int i = 1; i <= n; i++) {
        G[i].clear();        // å­˜æ— å‘å›¾ 
        rd[i] = 0;            // ç»Ÿè®¡æ¯ä¸€ä¸ªç»“ç‚¹çš„å…¥åº¦ 
        del[i] = false;        // æ‹“æ‰‘åˆ ç‚¹åˆ è¾¹æ—¶ä½¿ç”¨ 
        d[i] = 0;            // å›¾ä¸Šæ‰€æœ‰ç‚¹åˆ° tag ç‚¹çš„è·ç¦» 
        vis[i] = false;        // bfsè®¡ç®—è·ç¦»æ—¶ä½¿ç”¨ 
    }
}

void topu(int now) {
    if (rd[now] == 1) {
        rd[now]--;
        del[now] = true;
        for (auto& ch: G[now]) {
            if (del[ch]) continue;
            rd[ch]--;
            if (now == tag) {
                tag = ch;
            }
            topu(ch);
        }
    }
}

void bfs() {
    queue<int> q;
    q.push(tag);
    d[tag] = 0;
    
    while (q.size()) {
        auto now = q.front();
        vis[now] = true;
        q.pop();
        
        for (auto& ch: G[now]) {
            if (!vis[ch]) {
                d[ch] = d[now] + 1;
                q.push(ch);
                vis[ch] = true;
            }
        }
    }
}

void solve() {
    // åˆå§‹åŒ–
    cin >> n >> a >> b; 
    init();
    
    // å»ºå›¾ 
    for (int i = 1; i <= n; i++) {
        int u, v;
        cin >> u >> v;
        G[u].push_back(v), rd[v]++;
        G[v].push_back(u), rd[u]++;
    }
    
    // æ‹“æ‰‘åˆ è¾¹ & ç¼©bç‚¹
    tag = b;
    for (int i = 1; i <= n; i++) {
        topu(i);
    }

    // åˆ¤æ–­ç»“æœ & è®¡ç®—è·ç¦» 
    if (rd[b] == 2 && a != b) {
        // bç‚¹åœ¨ç¯ä¸Š
        cout << "Yes\n";
    } else {
        // bä¸åœ¨ç¯ä¸Š
        bfs();
        cout << (d[a] > d[b] ? "Yes\n" : "No\n");
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(0);
    int T = 1;
    cin >> T;
    while (T--) solve();
    return 0;
}
```

### äºŒåˆ†å›¾

æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾

<https://www.acwing.com/problem/content/862/>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ— å‘å›¾ï¼Œå¯èƒ½æœ‰é‡è¾¹å’Œè‡ªç¯ã€‚é—®æ˜¯å¦å¯ä»¥æ„æˆäºŒåˆ†å›¾ã€‚
>
> äºŒåˆ†å›¾çš„å®šä¹‰ï¼šä¸€ä¸ªå›¾å¯ä»¥è¢«åˆ†æˆä¸¤ä¸ªç‚¹é›†ï¼Œæ¯ä¸ªç‚¹é›†å†…éƒ¨æ²¡æœ‰è¾¹ç›¸è¿ï¼ˆå¯ä»¥ä¸æ˜¯è¿é€šå›¾ï¼‰
>
> æ€è·¯ï¼šåˆ©ç”¨ **æŸ“è‰²æ³•**ï¼Œéå†æ¯ä¸€ä¸ªè¿é€šåˆ†é‡ï¼Œé€‰æ‹©è¿é€šåˆ†é‡ä¸­çš„ä»»æ„ä¸€ç‚¹è¿›è¡ŒæŸ“è‰²æ‰©å±•
>
> - å¦‚æœæ‰©å±•åˆ°çš„ç‚¹æ²¡æœ‰æŸ“è¿‡è‰²ï¼Œåˆ™æŸ“æˆä¸å½“å‰ç‚¹ç›¸å¯¹çš„é¢œè‰²
> - å¦‚æœæ‰©å±•åˆ°çš„ç‚¹å·²ç»è¢«æŸ“è¿‡è‰²äº†ä¸”æŸ“çš„é¢œè‰²å’Œå½“å‰ç‚¹çš„é¢œè‰²ç›¸åŒï¼Œåˆ™æ— æ³•æ„æˆäºŒåˆ†å›¾ï¼ˆå¥‡æ•°ç¯ï¼‰
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n+e)$

```cpp
const int N = 100010;

int n, m;
vector<int> G[N], col(N);

bool bfs(int u) {
    queue<int> q;
    q.push(u);
    col[u] = 1;

    while (q.size()) {
        int now = q.front();
        q.pop();
        for (auto& ch: G[now]) {
            if (!col[ch]) {
                col[ch] = -col[now];
                q.push(ch);
            }
            else if (col[ch] == col[now]) {
                return false;
            }
        }
    }

    return true;
}

void solve() {
    cin >> n >> m;
    while (m--) {
        int u, v;
        cin >> u >> v;
        G[u].push_back(v);
        G[v].push_back(u);
    }

    // éå†æ¯ä¸€ä¸ªè¿é€šåˆ†é‡
    for (int i = 1; i <= n; i++) {
        if (!col[i]) {
            bool ok = bfs(i);
            if (!ok) {
                cout << "No\n";
                return;
            }
        }
    }

    cout << "Yes\n";
}
```

### æœ€å°ç”Ÿæˆæ ‘

Kruskal ç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘

<https://www.acwing.com/problem/content/861/>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ— å‘å›¾ï¼Œå¯èƒ½å«æœ‰é‡è¾¹å’Œè‡ªç¯ã€‚è¯•åˆ¤æ–­èƒ½å¦æ±‚è§£å…¶ä¸­çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œå¦‚æœå¯ä»¥ç»™å‡ºæœ€å°ç”Ÿæˆæ ‘çš„æƒå€¼
>
> æ€è·¯ï¼šæ ¹æ®æ•°æ®é‡ï¼Œå¯ä»¥å‘ç°é¡¶ç‚¹æ•°å¾ˆå¤§ï¼Œä¸é€‚ç”¨ $Prim$ ç®—æ³•ï¼Œåªèƒ½ç”¨ $Kruskal$ ç®—æ³•ï¼Œä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹è¯¥ç®—æ³•çš„æµç¨‹
>
> - è‡ªç¯é¦–å…ˆæ’é™¤ - æ˜¾ç„¶è¿™æ¡è¾¹è¿æ¥çš„â€œä¸¤ä¸ªâ€é¡¶ç‚¹æ˜¯ä¸å¯èƒ½é€‰è¿› $MST$ çš„
> - é¦–å…ˆå°†æ¯ä¸€ä¸ªç»“ç‚¹çœ‹æˆä¸€ä¸ªè¿é€šåˆ†é‡
> - æ¥ç€æŒ‰ç…§æƒå€¼å°†æ‰€æœ‰çš„è¾¹å‡åºæ’åºåï¼Œä¾æ¬¡é€‰æ‹©
>     - å¦‚æœé€‰å‡ºçš„è¿™æ¡è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹ä¸åœ¨ä¸€ä¸ªè¿é€šåˆ†é‡ä¸­ï¼Œåˆ™é€‰æ‹©è¿™æ¡è¾¹å¹¶å°†ä¸¤ä¸ªé¡¶ç‚¹æ‰€åœ¨çš„è¿é€šåˆ†é‡åˆå¹¶
>     - å¦‚æœé€‰å‡ºçš„è¿™æ¡è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹åœ¨åŒä¸€ä¸ªè¿é€šåˆ†é‡ä¸­ï¼Œåˆ™ä¸èƒ½é€‰æ‹©è¿™æ¡è¾¹ï¼ˆå¦åˆ™ä¼šä½¿å¾—æ„é€ çš„æ ‘å½¢æˆç¯ï¼‰
> - æœ€åç»Ÿè®¡é€‰æ‹©çš„è¾¹çš„æ•°é‡ $num$ è¿›è¡Œåˆ¤æ–­å³å¯
>     - $num=n-1$ï¼Œåˆ™å¯ä»¥ç”Ÿæˆæœ€å°ç”Ÿæˆæ ‘
>     - $num<n-1$ï¼Œåˆ™æ— æ³•ç”Ÿæˆæœ€å°ç”Ÿæˆæ ‘
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(e\log e)$â€‹ - å› ä¸ºæœ€å¤§çš„æ—¶é—´å¼€é”€åœ¨å¯¹æ‰€æœ‰çš„è¾¹çš„æƒå€¼è¿›è¡Œæ’åºä¸Š

C++

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

const int N = 100010;

struct edge {
    int a, b;
    int w;
};

int n, m;
vector<edge> edges;
vector<int> p(N);

int Find(int now) {
    if (p[now] != now) {
        p[now] = Find(p[now]);
    }
    return p[now];
}

void solve() {
    cin >> n >> m;
    for (int i = 1; i <= m; i++) {
        int a, b, w;
        cin >> a >> b >> w;
        if (a == b) {
            continue;
        }
        edges.push_back({a, b, w});
    }

    // æŒ‰ç…§è¾¹æƒå‡åºæ’åº
    sort(edges.begin(), edges.end(), [&](edge& x, edge& y) {
        return x.w < y.w;
    });

    // é€‰è¾¹
    for (int i = 1; i <= n; i++) {
        p[i] = i;
    }

    int res = 0, num = 0;

    for (auto& e: edges) {
        int pa = Find(e.a), pb = Find(e.b);
        if (pa != pb) {
            num++;
            p[pa] = pb;
            res += e.w;
        }

        if (num == n - 1) {
            break;
        }
    }

    // ç‰¹åˆ¤ï¼šé€‰å‡ºæ¥çš„è¾¹æ•°æ— æ³•æ„æˆä¸€æ£µæ ‘
    if (num < n - 1) {
        cout << "impossible\n";
        return;
    }

    cout << res << "\n";
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

Python

```python
def Find(x: int, p: list) -> int:
    if p[x] != x: p[x] = Find(p[x], p)
    return p[x]

def kruskal(n: int, m: int, edges: list) -> int:
    # æŒ‰è¾¹æƒå¯¹è¾¹è¿›è¡Œé™åºæ’åº
    edges.sort(key=lambda edge: edge[-1])

    # dsu åˆå§‹åŒ–
    p = [None] + [i for i in range(1, n + 1)]

    # é€‰è¾¹
    cnt = sum = 0
    for edge in edges:
        if cnt == n - 1: break

        pa, pb = Find(edge[0], p), Find(edge[1], p)
        if pa != pb:
            p[pa] = pb
            cnt += 1
            sum += edge[2]

    return sum if cnt == n - 1 else 0


if __name__ == "__main__":
    n, m = map(int, input().split())

    edges = []
    for i in range(m):
        edge = tuple(map(int, input().split()))
        edges.append(edge)

    res = kruskal(n, m, edges)

    if res: print(res)
    else: print("impossible")
```

JavaScript

```javascript
const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
});

let n = null;
let m = null;
const edges = [];

rl.on('line', line => {
    const [a, b, c] = line.split(' ').map(i => Number(i));
    if (n === null) {
        n = a;
        m = b;
    } else {
        edges.push([a, b, c]);
    }
});

rl.on('close', () => {
    const res = kurskal(n, m, edges);
    console.log(res === Infinity ? 'impossible' : res);
});

function Find(x, p) {
    if (p[x] != x) p[x] = Find(p[x], p);
    return p[x];
}

function kurskal(n, m, edges) {
    // å¯¹è¾¹è¿›è¡Œå‡åºæ’åº
    edges.sort((a, b) => a[2] - b[2]);
    
    // åˆå§‹åŒ– dsu
    p = [];
    for (let i = 1; i <= n; i++) p[i] = i;
    
    // é€‰è¾¹
    let cnt = 0, sum = 0;
    for (let [a, b, w] of edges) {
        if (cnt == n - 1) {
            break;
        }
        
        let pa = Find(a, p), pb = Find(b, p);
        if (pa !== pb) {
            cnt++;
            p[pa] = pb;
            sum += w;
        }
    }
    
    if (cnt === n - 1) return sum;
    else return Infinity;
}
```

Prim ç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘

<https://www.acwing.com/problem/content/860/>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªç¨ å¯†æ— å‘å›¾ï¼Œæœ‰é‡è¾¹å’Œè‡ªç¯ã€‚æ±‚å‡ºæœ€å°ç”Ÿæˆæ ‘
>
> æ€è·¯ï¼šæ ¹æ®é¢˜ç›®çš„æ•°æ®é‡ï¼Œå¯ä»¥ä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å‚¨çš„æ–¹æ³•é…åˆ $Prim$ ç®—æ³•æ±‚è§£æœ€å°ç”Ÿæˆæ ‘ï¼Œä¸‹é¢ç»™å‡ºè¯¥ç®—æ³•çš„æµç¨‹
>
> - é¦–å…ˆæ˜ç¡®ä¸€ä¸‹å˜é‡çš„å®šä¹‰ï¼š
>     - `g[i][j]` ä¸ºæ— å‘å›¾çš„é‚»æ¥çŸ©é˜µå­˜å‚¨ç»“æ„
>     - `MST[i]` è¡¨ç¤º $i$ å·ç‚¹æ˜¯å¦åŠ å…¥äº† $MST$ é›†åˆ
>     - `d[i]` è¡¨ç¤º `i` å·ç‚¹åˆ° $MST$ é›†åˆçš„æœ€çŸ­è¾¹é•¿åº¦
> - è‡ªç¯ä¸å­˜å‚¨ï¼Œé‡è¾¹åªä¿ç•™æœ€çŸ­çš„ä¸€æ¡
> - ä»»é€‰ä¸€ä¸ªç‚¹åˆ°é›†åˆ $MST$ ä¸­ï¼Œå¹¶ä¸”æ›´æ–° $d$ æ•°ç»„
> - é€‰æ‹©å‰©ä½™çš„ $n-1$ ä¸ªç‚¹ï¼Œæ¯æ¬¡é€‰æ‹©æœ‰ä»¥ä¸‹æµç¨‹
>     - æ‰¾åˆ°æœ€çŸ­è¾¹ï¼Œè®°å½•æœ€çŸ­è¾¹é•¿åº¦ $e$ å’Œç›¸åº”çš„åœ¨ $U-MST$ é›†åˆä¸­å¯¹åº”çš„é¡¶ç‚¹åºå· $v$
>     - å°† $v$ å·ç‚¹åŠ å…¥ $MST$ é›†åˆï¼ŒåŒæ—¶æ ¹æ®æ­¤æ—¶é€‰å‡ºçš„æœ€çŸ­è¾¹çš„é•¿åº¦æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æœ€å°ç”Ÿæˆæ ‘
>     - æ ¹æ® $v$ å·ç‚¹ï¼Œæ›´æ–° $d$ æ•°ç»„ï¼Œå³æ›´æ–°åœ¨é›†åˆ $U-MST$ ä¸­çš„ç‚¹åˆ° $MST$ é›†åˆä¸­çš„ç‚¹çš„äº¤å‰è¾¹çš„æœ€çŸ­é•¿åº¦
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

const int N = 510;

int n, m;
vector<vector<int>> g(N, vector<int>(N, INT_MAX));
vector<int> d(N, INT_MAX); // d[i]è¡¨ç¤ºiå·ç‚¹åˆ°MSTé›†åˆä¸­çš„æœ€çŸ­è¾¹é•¿åº¦
bool MST[N];
int res;

void prim() {
    // é€‰ä»»æ„ä¸€ä¸ªç‚¹åˆ°MSTä¸­å¹¶æ›´æ–°dæ•°ç»„
    MST[1] = true;
    for (int i = 1; i <= n; i++)
        if (!MST[i])
            d[i] = min(d[i], g[i][1]);

    // é€‰å‰©ä¸‹çš„n-1ä¸ªç‚¹åˆ°MSTä¸­
    for (int i = 2; i <= n; i++) {
        // 1. æ‰¾åˆ°æœ€çŸ­è¾¹
        int e = INT_MAX, v = -1; // e: æœ€çŸ­è¾¹é•¿åº¦ï¼Œv: æœ€çŸ­è¾¹ä¸åœ¨MSTé›†åˆä¸­çš„é¡¶ç‚¹
        for (int j = 1; j <= n; j++)
            if (!MST[j] && d[j] < e)
                e = d[j], v = j;

        // 2. åŠ å…¥MSTé›†åˆ
        MST[v] = true;
        if (e == INT_MAX) {
            // ç‰¹åˆ¤æ— æ³•æ„é€ MSTçš„æƒ…å†µ
            cout << "impossible\n";
            return;
        } else {
            res += e;
        }

        // 3. æ›´æ–°äº¤å‰è¾¹ - è¿­ä»£ï¼ˆè¦†ç›–æ›´æ–°ï¼‰
        for (int j = 1; j <= n; j++)
            if (!MST[j])
                d[j] = min(d[j], g[j][v]);
    }

    cout << res << "\n";
}

void solve() {
    cin >> n >> m;
    while (m--) {
        int a, b, w;
        cin >> a >> b >> w;

        if (a == b) {
            continue;
        }

        if (g[a][b] == INT_MAX) {
            g[a][b] = w;
            g[b][a] = w;
        } else {
            g[a][b] = min(g[a][b], w);
            g[b][a] = min(g[b][a], w);
        }
    }

    prim();
}

signed main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

### æœ€çŸ­è·¯

Dijkstra æ±‚æœ€çŸ­è·¯

æœ´ç´ ç‰ˆ - <https://www.acwing.com/problem/content/851/>

å †ä¼˜åŒ– - <https://www.acwing.com/problem/content/852/>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ­£è¾¹æƒçš„æœ‰å‘å›¾ï¼Œå¯èƒ½å­˜åœ¨é‡è¾¹ä¸è‡ªç¯ï¼Œé—® $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦æ˜¯å¤šå°‘ï¼Œå¦‚æœä¸å¯è¾¾å°±è¾“å‡º $-1$ã€‚
>
> æ€è·¯ä¸€ï¼šæœ´ç´ ç‰ˆã€‚ç‚¹æ•° $1\le n \le 500$ï¼Œè¾¹æ•° $1 \le m\le 10^5$
>
> - æ€è·¯ï¼šæ ¹æ®æ•°æ®é‡ï¼Œæˆ‘ä»¬é‡‡ç”¨é‚»æ¥çŸ©é˜µçš„æ–¹å¼å­˜å‚¨ã€Œç‚¹å°‘è¾¹å¤šã€çš„ç¨ å¯†å›¾ã€‚æˆ‘ä»¬å®šä¹‰ `d[i]` æ•°ç»„è¡¨ç¤ºèµ·ç‚¹åˆ° `i` å·ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚å…ˆå°†èµ·ç‚¹æ”¾å…¥ `SPT (Shortest Path Tree)` é›†åˆï¼Œç„¶åæ›´æ–°æ‰€æœ‰ `V-SPT` ä¸­çš„ç‚¹åˆ° `SPT` é›†åˆçš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚æ¥ç€å¾ªç¯ `n-1` æ¬¡è¿­ä»£æ›´æ–°å‰©ä½™çš„ `n-1` ä¸ªç‚¹ï¼Œæ¯æ¬¡è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆé€‰æ‹©è·ç¦»èµ·ç‚¹æœ€è¿‘çš„ç‚¹ `vex`ï¼Œç„¶åå°†è¯¥ç‚¹åŠ å…¥ `SPT` é›†åˆï¼Œæœ€ååˆ©ç”¨è¯¥ç‚¹æ›´æ–° `V-SPT` é›†åˆä¸­å’Œè¯¥ç‚¹æœ‰è¿è¾¹çš„ç‚¹åˆ°èµ·ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚æœ€ç»ˆçš„ `d[end]` å°±æ˜¯èµ·ç‚¹ `start` åˆ°ç»ˆç‚¹ `end` çš„æœ€çŸ­è·ç¦»ã€‚
> - æ€»ç»“ï¼šç®—æ³•æ•´ä½“é‡‡ç”¨è´ªå¿ƒä¸åŠ¨æ€è§„åˆ’çš„æ€è·¯ã€‚ä¸ $\text{Prim}$ ç®—æ³•ä»”ç»†æ¯”å¯¹å¯çŸ¥ï¼Œå…¶ä¸­çš„è´ªå¿ƒè¿‡ç¨‹å‡ ä¹ä¸€è‡´ï¼Œå³æ¯æ¬¡é€‰æ‹©åŠ å…¥ SPT é›†åˆçš„ç‚¹å‡ä¸ºå½“å‰å±€é¢ `V-SPT` é›†åˆä¸­è·ç¦»èµ·ç‚¹æœ€è¿‘çš„ç‚¹ã€‚è€ŒåŠ¨æ€è§„åˆ’çš„è¿‡ç¨‹ä½“ç°åœ¨ï¼Œåœ¨æ±‚è§£å‡ºé›†åˆ `V-SPT` ä¸­åˆ°é›†åˆ `STP` æœ€çŸ­è·ç¦»çš„ç‚¹ `vex` ä¹‹åï¼Œåˆ©ç”¨è¯¥ç‚¹å¯¹ã€Œåœ¨ `V-SPT` é›†åˆä¸”å’Œ vex ç‚¹æœ‰è¿è¾¹çš„ç‚¹ `i`ã€æ›´æ–° `d[i]` çš„è¿‡ç¨‹ã€‚æ›´æ–°å‰çš„çŠ¶æ€éƒ½æ˜¯åœ¨ä¹‹å‰çš„å­ç»“æ„ä¸‹çš„æœ€ä¼˜è§£ã€‚
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$
>
> æ€è·¯äºŒï¼šå †ä¼˜åŒ–ã€‚ç‚¹æ•° $1\le n \le 1.5 \times 10^5$ï¼Œè¾¹æ•° $1 \le m \le 1.5 \times 10^5$
>
> - æ€è·¯ï¼šæ ¹æ®æ•°æ®é‡ï¼Œæˆ‘ä»¬é‡‡ç”¨é‚»æ¥è¡¨çš„æ–¹å¼å­˜å‚¨ã€Œç‚¹å¤šè¾¹å°‘ã€çš„ç¨€ç–å›¾ã€‚å¦‚æœé‡‡ç”¨ä¸Šè¿°æœ´ç´  Dijkstra ç®—æ³•è¿›è¡Œæ±‚è§£å¿…ç„¶ä¼šå› ä¸ºç‚¹æ•°è¿‡å¤šè€Œè¶…æ—¶ï¼Œå› æ­¤æˆ‘ä»¬åˆ©ç”¨æ•°æ®ç»“æ„ã€Œå †ã€è¿›è¡Œæ—¶é—´å¼€é”€ä¸Šçš„ä¼˜åŒ–ã€‚ä¸éš¾å‘ç°æœ´ç´  Dijkstra ç®—æ³•åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¸»è¦æœ‰ä¸‰éƒ¨åˆ†ï¼š
>
>     1. é€‰æ‹©è·ç¦»èµ·ç‚¹æœ€è¿‘çš„ç‚¹ `vex`ã€‚å› ä¸ºéœ€è¦æšä¸¾æ‰€æœ‰çš„é¡¶ç‚¹ï¼Œå› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$
>     2. å°†è¯¥ç‚¹åŠ å…¥ `SPT` é›†åˆã€‚å› ä¸ºåªæ˜¯ç®€å•çš„æ‰“ä¸ªæ ‡è®°ï¼Œå› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$
>     3. åˆ©ç”¨è¯¥ç‚¹æ›´æ–° `V-SPT` é›†åˆä¸­å’Œè¯¥ç‚¹ç›¸è¿çš„ç‚¹åˆ°èµ·ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚å› ä¸ºæ­¤æ—¶æšä¸¾çš„æ˜¯è¯¥ç‚¹æ‰€æœ‰çš„è¿è¾¹ï¼Œè€Œé‚»æ¥è¡¨çš„å›¾å­˜å‚¨æ–¹å¼æ— æ³•è¿›è¡Œé‡è¾¹çš„åˆ é™¤ï¼Œå› æ­¤æœ€åæƒ…å†µä¸‹ä¼šæšä¸¾æ‰€æœ‰çš„è¾¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(m)$
>- æ—¶é—´å¤æ‚åº¦ï¼š
>     

æœ´ç´ ç‰ˆ C++ï¼š

```cpp
#include <bits/stdc++.h>

using ll = long long;
using namespace std;

int dijkstra_ori(std::vector<std::vector<int>>& g, int start, int end) {
    int n = g.size() - 1;
    std::vector<int> d(n + 1, INT_MAX >> 1);
    std::vector<bool> SPT(n + 1, false);
    
    // update start vex
    d[start] = 0;
    SPT[start] = true;
    for (int i = 1; i <= n; i++) {
        if (!SPT[i] && g[start][i] != INT_MAX >> 1) {
            d[i] = std::min(d[i], d[start] + g[start][i]);
        }
    }
    
    // update remain n-1 vex
    for (int k = 0; k < n - 1; k++) {
        int vex = -1;
        for (int i = 1; i <= n; i++) {
            if (!SPT[i] && (vex == -1 || d[i] < d[vex])) {
                vex = i;
            }
        }
        SPT[vex] = true;
        for (int i = 1; i <= n; i++) {
            if (!SPT[i] && g[vex][i] != INT_MAX >> 1) {
                d[i] = std::min(d[i], d[vex] + g[vex][i]);
            }
        }
    }
    
    return d[end] == INT_MAX >> 1 ? -1 : d[end];
}

void solve() {
    int n, m;
    cin >> n >> m;
    
    vector<vector<int>> g(n + 1, vector<int>(n + 1, INT_MAX >> 1));
    
    while (m--) {
        int u, v, w;
        cin >> u >> v >> w;
        g[u][v] = min(g[u][v], w);
    }
    
    cout << dijkstra_ori(g, 1, n) << "\n";
}

signed main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    int T = 1;
//    std::cin >> T;
    while (T--) solve();
    return 0;
}
```

æœ´ç´ ç‰ˆ Pythonï¼š

```python
import heapq
from collections import defaultdict
from typing import List, Tuple
import math
from itertools import combinations

II = lambda: int(input())
FI = lambda: float(input())
MII = lambda: tuple(map(int, input().split()))
LII = lambda: list(map(int, input().split()))


def dijkstra_ori(g: List[List[int]], start: int, end: int) -> int:
    n = len(g) - 1
    d = [10 ** 5] * (n + 1)
    SPT = [False] * (n + 1)
    
    d[start] = 0
    SPT[start] = True
    for i in range(1, n + 1):
        if not SPT[i] and g[start][i] != 10 ** 5:
            d[i] = min(d[i], d[start] + g[start][i])
    
    for _ in range(n - 1):
        vex = -1
        for i in range(1, n + 1):
            if not SPT[i] and (vex == -1 or d[i] < d[vex]):
                vex = i
        SPT[vex] = True
        for i in range(1, n + 1):
            if not SPT[i] and g[vex][i] != 10 ** 5:
                d[i] = min(d[i], d[vex] + g[vex][i])
    
    return -1 if d[end] == 10 ** 5 else d[end]


def solve() -> None:
    n, m = MII()
    g = [[10 ** 5] * (n + 1) for _ in range(n + 1)]
    for _ in range(m):
        u, v, w = MII()
        g[u][v] = min(g[u][v], w)
    print(dijkstra_ori(g, 1, n))


if __name__ == '__main__':
    T = 1
    # T = II()
    while T: solve(); T -= 1
```

å †ä¼˜åŒ–ç‰ˆ C++ï¼š

```cpp
```

å †ä¼˜åŒ–ç‰ˆ Pythonï¼š

```python

```

Floyd æ±‚æœ€çŸ­è·¯

<https://www.acwing.com/problem/content/856/>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªç¨ å¯†æœ‰å‘å›¾ï¼Œå¯èƒ½å­˜åœ¨é‡è¾¹ä¸è‡ªç¯ï¼Œç»™å‡ºå¤šä¸ªè¯¢é—®ï¼Œéœ€è¦ç»™å‡ºæ¯ä¸€ä¸ªè¯¢é—®çš„ä¸¤ä¸ªç‚¹ä¹‹å‰çš„æœ€çŸ­è·¯å¾„é•¿åº¦
>
> æ€è·¯ï¼šæˆ‘ä»¬é‡‡ç”¨åŠ¨æ€è§„åˆ’çš„æ€è·¯ã€‚åœ¨æ­¤ä½¿ç”¨å¤šé˜¶æ®µå†³ç­–çš„æ–¹æ³•ï¼Œå³æ¯ä¸€ä¸ªè·¯å¾„çŠ¶æ€ä¸ºé€‰æ‹© $1\to k$ ä¸ªç‚¹çš„æƒ…å†µä¸‹çš„æœ€çŸ­è·¯å¾„é•¿åº¦
>
> - çŠ¶æ€è¡¨ç¤ºï¼š`f[k][i][j]` è¡¨ç¤ºåœ¨å‰ $k$ ä¸ªé¡¶ç‚¹ä¸­è¿›è¡Œé€‰æ‹©ï¼ˆä¸­è½¬ï¼‰ï¼Œ$i$ å·ç‚¹åˆ° $j$ å·ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦
>- çŠ¶æ€è½¬ç§»ï¼šå¯¹äºç¬¬ $k$ ä¸ªé¡¶ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸­è½¬ï¼Œä¹Ÿå¯ä»¥ä¸ä¸­è½¬ã€‚
>     - å¯¹äºä¸é€‰æ‹©ä¸­è½¬çš„æƒ…å†µï¼š`f[k][i][j] = f[k-1][i][j]`
>    - å¯¹äºå¯é€‰æ‹©ä¸­è½¬çš„æƒ…å†µï¼š`f[k][i][j] = f[k-1][i][k] + f[k-1][k][j]`
>     - åœ¨å…¶ä¸­å–æœ€å°å€¼å³å¯ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ³¨æ„ç‚¹ï¼šå¯¹äºç¬¬äºŒç§æƒ…å†µï¼Œé€‰æ‹©æ˜¯æœ‰ä¸€ä¸ªçº¦æŸçš„ï¼šå³å¦‚æœé€‰æ‹©äº† $k$ å·ç‚¹è¿›è¡Œè½¬ç§»çš„è¯ï¼Œé‚£ä¹ˆ $i$ å·ç‚¹åˆ° $k$ å·ç‚¹ä»¥åŠ $k$ å·ç‚¹åˆ° $j$ å·ç‚¹éƒ½æ˜¯éœ€è¦æœ‰è·¯å¾„å¯è¾¾çš„ï¼Œä»è€Œå¯ä»¥é€‰æ‹©æœ€å°è·ç¦»
> - åˆå§‹åŒ–ï¼šå³é€‰æ‹© 0 ä¸ªç«™ç‚¹è¿›è¡Œä¸­è½¬æ—¶ï¼Œå³ `f[0][i][j]` çš„æƒ…å†µä¸­ï¼Œ
>     - å¦‚æœ $i$ å·ç‚¹ä¸ $j$ å·ç‚¹è‡ªç¯ï¼Œåˆ™å– $0$
>     - å¦‚æœ $i$ å·ç‚¹ä¸ $j$ å·ç‚¹ä¹‹é—´æœ‰è¾¹ï¼Œåˆ™å–é‡è¾¹çš„æœ€å°å€¼
>     - å¦‚æœ $i$ å·ç‚¹ä¸ $j$ å·ç‚¹ä¹‹é—´æ— è¾¹ï¼Œåˆ™åˆå§‹åŒ–ä¸ºæ­£æ— ç©·
> - ç­”æ¡ˆçŠ¶æ€ï¼šå¯¹äº $a$ å·ç‚¹åˆ° $b$ å·ç‚¹ä¹‹é—´çš„æœ€å°è·¯å¾„é•¿åº¦ï¼Œå°±æ˜¯ `f[n][a][b]`
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^3)$
> - ç©ºé—´å¤æ‚åº¦ï¼š$O(n^3)$
> 
> ç©ºé—´ä¼˜åŒ–æ¨å¯¼ï¼šæˆ‘ä»¬å°è¯•ä¼˜åŒ–æ‰è®°å¿†æ•°ç»„çš„ç¬¬ä¸€ç»´åº¦
> 
> - å¯¹äºä¸é€‰æ‹©çš„æƒ…å†µï¼šç”±äºå†³ç­–å±€é¢ $k$ æ˜¯ä»å‰å¾€åæšä¸¾ï¼Œæ•…å½“å‰çŠ¶æ€ `f[k][i][j]` å¯ä»¥ **ç›´æ¥ä¾èµ–äºå·²ç»æ›´æ–°å‡ºæ¥ä¸”ä¸ä¼šè¢«å½“å‰çŠ¶æ€ä¹‹åçš„çŠ¶æ€å†æ¬¡è¦†ç›–çš„æœ€ä¼˜å­ç»“æ„ `f[i][j]`**ã€‚å³ä¸Šä¸€ä¸ªå±€é¢çš„é€‰æ‹©æƒ…å†µï¼Œå°±æ˜¯ä¸é€‰æ‹©ç¬¬ $k$ ä¸ªé¡¶ç‚¹çš„æƒ…å†µ
>
> - å¯¹äºé€‰æ‹©çš„æƒ…å†µï¼šå¦‚æœåˆ é™¤ç¬¬ä¸€ç»´åº¦ï¼Œæˆ‘ä»¬æ‹…å¿ƒçš„æ˜¯å½“å‰çŠ¶æ€ `f[k][i][j]` ä¾èµ–çš„ä¸¤ä¸ªçŠ¶æ€ `f[i][k]` ä¸ `f[k][j]` ä¼šä¸ä¼šè¢«åç»­è¦†ç›–æ‰ï¼Œå³ **æˆ‘ä»¬ä¸ç¡®å®š `f[i][k]` ä¸ `f[k][j]` æ˜¯å¦æ˜¯å½“å‰ç¬¬ k ä¸ªå±€é¢çš„æœ€ä¼˜å­ç»“æ„**ã€‚å°è¯•æ¨å¯¼ï¼š
>
>     > ä¸ºäº†ç¡®å®š `f[i][k]` ä¸ `f[k][j]` æ˜¯å¦æ˜¯å½“å‰ç¬¬ $k$ ä¸ªå±€é¢çš„æœ€ä¼˜å­ç»“æ„ï¼Œå…¶å®å°±æ˜¯ç¡®å®šå¯¹äºå½“å‰ç¬¬ $k$ ä¸ªå±€é¢ï¼Œè¿™ä¸¤ä¸ªçŠ¶æ€ä¼šä¸ä¼šåœ¨å½“å‰çŠ¶æ€ `f[i][j]` ä¹‹åè¢«æ›´æ–°è¦†ç›–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çœ‹è¿™ä¸¤ä¸ªçŠ¶æ€æ˜¯ä»å“ªé‡Œè½¬ç§»è¿‡æ¥è¿›è¡Œæ›´æ–°çš„ã€‚å¦‚æœ `f[i][k]` ä¸ `f[k][j]` è¿™ä¸¤ä¸ªçŠ¶æ€çš„è½¬ç§»ä¼šä¾èµ–äºå½“å‰çŠ¶æ€ä¹‹åçš„çŠ¶æ€ï¼Œé‚£ä¹ˆåˆ é™¤ç¬¬ä¸€ç»´åº¦å°±æ˜¯é”™è¯¯çš„ï¼Œåä¹‹å°±æ˜¯æˆç«‹çš„ã€‚
>    >
>     > å°è¯•æ¨å¯¼ `f[i][k]` ä¸ `f[k][j]` ä»ä½•è½¬ç§»æ›´æ–°ï¼šåˆ©ç”¨æˆ‘ä»¬æœªåˆ é™¤ç»´åº¦æ—¶æ­£ç¡®çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹è¿›è¡Œæ¨æ¼”
>    >
>     > æˆ‘ä»¬çŸ¥é“ï¼š`f[k][i][k] = min(f[k-1][i][k], f[k-1][i][k] + f[k-1][k][k])`ï¼Œå…¶ä¸­çš„ `f[k-1][k][k]` å°±æ˜¯ä¸€ä¸ªè‡ªç¯çš„è·¯å¾„é•¿åº¦ï¼Œç”±äº $floyd$ ç®—æ³•çš„çº¦æŸæ¡ä»¶æ˜¯æ²¡æœ‰è´Ÿç¯ï¼Œå› æ­¤ `f[k-1][k][k]` ä¸€å®šå¤§äºé›¶ï¼Œæ•… `f[k][i][k]` ä¸€å®šå–å‰è€…ï¼Œå³ `f[k][i][k] = f[k-1][i][k]`
>    >
>     > åŒç†å¯çŸ¥ï¼š
>     >
>     > `f[k][k][j] = f[k-1][k][j]`
> 
>     åŸºäºä¸Šè¿°æ¨å¯¼æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå½“å‰ç¬¬ $k$ ä¸ªå†³ç­–å±€é¢ä¸­çš„ `f[k][i][k]` ä¸ `f[k][k][j]` æ˜¯ä¾èµ–äºä¸Šä¸€ä¸ªå†³ç­–å±€é¢ $k-1$ çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ **ä¸¤ä¸ªçŠ¶æ€ä¸€å®šæ˜¯æ—©äºå½“å‰çŠ¶æ€ `f[i][j]` è¢«æ›´æ–°è¦†ç›–çš„**ï¼Œæ•… `f[i][k]` ä¸ `f[k][j]` å°±æ˜¯å½“å‰ç¬¬ $k$ ä¸ªå±€é¢çš„æœ€ä¼˜å­ç»“æ„ï¼Œè¯æ¯•ï¼Œå¯ä»¥è¿›è¡Œç»´åº¦çš„åˆ é™¤
> 
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(n^3)$
> 
> - ç©ºé—´å¤æ‚åº¦ï¼š$O(n^2)$

ä¸ä¼˜åŒ–ç©ºé—´

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 210, INF = 0x3f3f3f3f;

int n, m, Q;
int f[N][N][N];

int main() {
    cin >> n >> m >> Q;
    
    // init
    memset(f, INF, sizeof f);
    
    // add edges and generate base
    while (m--) {
        int a, b, w;
        cin >> a >> b >> w;
        if (a == b) continue;                           // é‡è¾¹å°±ä¸èµ‹å€¼
        else if (f[0][a][b] == INF) f[0][a][b] = w;     // ç¬¬ä¸€æ¬¡åŠ è¾¹åˆ™ç›´æ¥èµ‹å€¼
        else f[0][a][b] = min(f[0][a][b], w);           // å†æ¬¡èµ‹è¾¹æƒå°±å–æœ€å°å€¼
    }
    
    // generate base again
    for (int i = 1; i <= n; i++)
        for (int j = 1; j <= n; j++)
            if (i == j) 
                f[0][i][j] = 0;                         // è‡ªç¯å–è¾¹æƒä¸º 0
    
    // dp 
    for (int k = 1; k <= n; k++)
        for (int i = 1; i <= n; i++)
            for (int j = 1; j <= n; j++) {
                // ä¸é€‰ç¬¬kä¸ªé¡¶ç‚¹
                f[k][i][j] = f[k - 1][i][j];
                
                // é€‰æ‹©ç¬¬kä¸ªé¡¶ç‚¹
                if (f[k - 1][i][k] != INF && f[k - 1][k][j] != INF)
                    f[k][i][j] = min(f[k][i][j], f[k - 1][i][k] + f[k - 1][k][j]);
            }

    // query
    while (Q--) {
        int a, b;
        cin >> a >> b;
        if (f[n][a][b] == INF) cout << "impossible\n";
        else cout << f[n][a][b] << "\n";
    }
    
    return 0;
}
```

ä¼˜åŒ–ç©ºé—´

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N = 210, INF = 0x3f3f3f3f;

int n, m, Q;
int f[N][N];

int main() {
    cin >> n >> m >> Q;
    
    // init
    for (int i = 1; i <= n; i++)
        for (int j = 1; j <= n; j++)
            if (i == j) f[i][j] = 0;
            else f[i][j] = INF;
            
    // base
    while (m--) {
        int a, b, w;
        cin >> a >> b >> w;
        if (a == b) continue;
        else if (f[a][b] == INF) f[a][b] = w;
        else f[a][b] = min(f[a][b], w);
    }
    
    // dp
    for (int k = 1; k <= n; k++)
        for (int i = 1; i <= n; i++)
            for (int j = 1; j <= n; j++)
                if (f[i][k] != INF && f[k][j] != INF)
                    f[i][j] = min(f[i][j], f[i][k] + f[k][j]);
    
    // query
    while (Q--) {
        int a, b;
        cin >> a >> b;
        if (f[a][b] == INF) cout << "impossible\n";
        else cout << f[a][b] << "\n";
    }
    
    return 0;
}
```

å…³é—­åˆ†éƒ¨çš„å¯è¡Œé›†åˆæ•°ç›®

<https://leetcode.cn/problems/number-of-possible-sets-of-closing-branches/>

> æ ‡ç­¾ï¼šäºŒè¿›åˆ¶æšä¸¾ã€æœ€çŸ­è·¯
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªå«æœ‰ $n$ ä¸ªé¡¶ç‚¹çš„æ— å‘å›¾ï¼Œå¦‚ä½•åˆ ç‚¹å¯ä»¥ä½¿å¾—å‰©ä½™çš„å›¾ä¸­é¡¶ç‚¹ä¸¤ä¸¤å¯è¾¾ä¸”æœ€å¤§è·ç¦»ä¸è¶…è¿‡ maxDistanceï¼Ÿè¿”å›æ‰€æœ‰åˆ ç‚¹çš„æ–¹æ¡ˆæ•°ã€‚
>
> æ€è·¯ï¼šç”±äº $n$ çš„æ•°æ®èŒƒå›´åªæœ‰ $1 \to 10$ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æšä¸¾æ‰€æœ‰çš„åˆ ç‚¹æ–¹æ¡ˆã€‚é‚£ä¹ˆå¦‚ä½•æ£€æŸ¥ä¸€ä¸ªæ–¹æ¡ˆçš„åˆæ³•æ€§å‘¢ï¼Ÿç›´æ¥ä½¿ç”¨æœ€çŸ­è·¯ç®—æ³•æ£€æŸ¥ã€Œæ‰€æœ‰é¡¶ç‚¹åˆ°æ¯ä¸€ä¸ªé¡¶ç‚¹ã€çš„æœ€è¿œè·ç¦»å³å¯ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨æœ´ç´  dijkstra ç®—æ³•ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(2^n \times n^3)$ - å…¶ä¸­æšä¸¾éœ€è¦ $O(2^n)$ã€è®¡ç®—æ‰€æœ‰é¡¶ç‚¹åˆ°æŸä¸ªé¡¶ç‚¹çš„æœ€è¿œè·ç¦»éœ€è¦ $O(n^2)$ã€æ£€æŸ¥æ‰€æœ‰é¡¶ç‚¹éœ€è¦ $O(n)$

```cpp
class Solution {
public:
    int numberOfSets(int n, int maxDistance, vector<vector<int>>& roads) {
        vector<vector<int>> g(n, vector<int>(n, INT_MAX >> 1));
        for (auto& r: roads) {
            int u = r[0], v = r[1], w = r[2];
            g[u][v] = g[v][u] = min(g[u][v], w);
        }

        auto get_max_dist = [&](int mask, int v) {
            vector<bool> SPT(n);
            vector<int> d(n, INT_MAX);
            
            d[v] = 0;
            SPT[v] = true;
            
            int cnt = 0;
            for (int i = 0; i < n; i++) {
                if (mask & (1 << i) && !SPT[i]) {
                    cnt++;
                    d[i] = min(d[i], d[v] + g[v][i]);
                }
            }

            for (int k = 1; k <= cnt - 1; k++) {
                int vex = -1;
                for (int i = 0; i < n; i++) {
                    if (mask & (1 << i) && !SPT[i] && (vex == -1 || d[i] < d[vex])) {
                        vex = i;
                    }
                }
                SPT[vex] = true;
                for (int i = 0; i < n; i++) {
                    if (mask & (1 << i) && !SPT[i]) {
                        d[i] = min(d[i], d[vex] + g[vex][i]);
                    }
                }
            }
            
            int max_dist = -1;
            for (int i = 0; i < n; i++) {
                if (mask & (1 << i)) {
                    max_dist = max(max_dist, d[i]);
                }
            }
            
            return max_dist;
        };

        int res = 0;
        for (int mask = 0; mask < 1 << n; mask++) {
            bool ok = true;
            for (int i = 0; i < n; i++) {
                if (mask & (1 << i) && get_max_dist(mask, i) > maxDistance) {
                    ok = false;
                    break;
                }
            }
            res += ok;
        }

        return res;
    }
};
```

```python
class Solution:
    def numberOfSets(self, n: int, maxDistance: int, roads: List[List[int]]) -> int:
        g = [[10 ** 6 for _ in range(n)] for _ in range(n)]
        for u, v, w in roads:
            g[u][v] = g[v][u] = min(g[u][v], w)
        
        def get_max_dist(mask: int, v: int):
            SPT = [False for _ in range(n)]
            d = [10 ** 6 for _ in range(n)]

            SPT[v] = True
            d[v] = 0

            cnt = 0
            for i in range(n):
                if mask & (1 << i) and not SPT[i]:
                    cnt += 1
                    d[i] = min(d[i], d[v] + g[v][i])
            
            for _ in range(cnt - 1):
                vex = -1
                for i in range(n):
                    if mask & (1 << i) and not SPT[i] and (vex == -1 or d[i] < d[vex]):
                        vex = i
                SPT[vex] = True
                for i in range(n):
                    if mask & (1 << i) and not SPT[i]:
                        d[i] = min(d[i], d[vex] + g[vex][i])
                
            max_dist = -1
            for i in range(n):
                if mask & (1 << i):
                    max_dist = max(max_dist, d[i])
            
            return max_dist

        res = 0
        for mask in range(1 << n):
            ok = True
            for i in range(n):
                if mask & (1 << i) and get_max_dist(mask, i) > maxDistance:
                    ok = False
                    break
            res += ok

        return res
```

### æœ€è¿‘å…¬å…±ç¥–å…ˆ


æ ‘çš„ç›´å¾„

<https://www.acwing.com/problem/content/5563/>

> é¢˜æ„ï¼šç»™å®šä¸€æ£µæ ‘ï¼Œåˆå§‹æ—¶å«æœ‰ 4 ä¸ªç»“ç‚¹åˆ†åˆ«ä¸º 1 åˆ° 4ï¼Œå…¶ä¸­ 1 å·ä¸ºæ ¹ç»“ç‚¹ï¼Œ2 åˆ° 4 å‡ä¸ºæ ¹ç»“ç‚¹çš„å¶å­ç»“ç‚¹ã€‚ç°åœ¨è¿›è¡Œ Q æ¬¡æ“ä½œï¼Œæ¯æ¬¡æŒ‡å®šä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç»“ç‚¹å‘å…¶æ’å…¥ä¸¤ä¸ªæ–°ç»“ç‚¹ä½œä¸ºå¶èŠ‚ç‚¹ã€‚ç°åœ¨éœ€è¦åœ¨æ¯æ¬¡æ“ä½œä»¥åè¾“å‡ºè¿™æ£µæ ‘çš„ç›´å¾„ã€‚æˆ‘ä»¬å®šä¹‰ **æ ‘çš„ç›´å¾„** ä¸ºï¼šæ ‘ä¸­è·ç¦»æœ€è¿œçš„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ã€‚
>
> æ€è·¯ä¸€ï¼šæš´åŠ›æœç´¢ã€‚
>
> - æˆ‘ä»¬å°†æ ‘é‡æ„ä¸ºæ— å‘å›¾ï¼Œå¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€çš„æ— å‘å›¾ï¼Œé¦–å…ˆä»ä»»æ„ä¸€ä¸ªå·²å­˜åœ¨çš„ç»“ç‚¹ A å¼€å§‹æœç´¢åˆ°è·ç¦»ä»–æœ€è¿œçš„ç‚¹ Bï¼Œç„¶åä» B ç‚¹å‡ºå‘æœç´¢åˆ°ç¦»ä»–æœ€è¿œçš„ç‚¹ Cï¼Œåˆ™ B ä¸ C ä¹‹é—´çš„è·ç¦»å°±æ˜¯å½“å‰çŠ¶æ€çš„æ ‘çš„ç›´å¾„ã€‚ç”±äºæ¯ä¸€ä¸ªçŠ¶æ€çš„æ ‘éƒ½è¦éå†ä¸¤éæ ‘ï¼Œäºæ˜¯æ—¶é—´å¤æ‚åº¦å°±æ˜¯å¹³æ–¹é˜¶
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(qn)$
>
> æ€è·¯äºŒï¼šæœ€è¿‘å…¬å…±ç¥–å…ˆ LCAã€‚
>
> - **ä»æ ‘çš„ç›´å¾„å‡ºå‘**ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæ ‘çš„ç›´å¾„ç”±ç›´å¾„çš„ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„è·ç¦»å†³å®šï¼Œå› æ­¤æˆ‘ä»¬ç€çœ¼äºè¿™ä¸¤ä¸ªç»“ç‚¹ $A$ å’Œ $B$ å±•å¼€ã€‚ä¸å¦¨è®¾å½“å‰å±€é¢ç›´å¾„çš„ä¸¤ä¸ªç»“ç‚¹å·²çŸ¥ä¸º $A$ å’Œ $B$ï¼Œç°åœ¨æ’å…¥ä¸¤ä¸ªå¶å­ç»“ç‚¹ $L_1$ å’Œ $L_2$ã€‚æ˜¯å¦æ”¹å˜äº†æ ‘çš„ç›´å¾„å¤§å°å–å†³äºæ–°æ’å…¥çš„ä¸¤ä¸ªç»“ç‚¹å¯¹äºå½“å‰æ ‘çš„å½±å“æƒ…å†µã€‚å¦‚æœ $L_1$ æˆ– $L_2$ å¯ä»¥æ›¿ä»£ $A$ æˆ– $B$ï¼Œåˆ™æ ‘çš„ç›´å¾„å°±ä¼šæ”¹å˜ã€‚å¾ˆæ˜¾ç„¶æ–°æ’å…¥çš„ä¸¤ä¸ªå¶å­ç»“ç‚¹å¯¹äºç›´å¾„çš„ä¸¤ä¸ªç«¯ç‚¹å½±å“æ˜¯åŒæ•ˆæœçš„ï¼Œå› æ­¤æˆ‘ä»¬ç»Ÿç§°æ–°æ’å…¥çš„å¶å­ç»“ç‚¹ä¸º $L$ã€‚
>
> - **ä»€ä¹ˆæ—¶å€™æ ‘çš„ç›´å¾„ä¼šæ”¹å˜**ï¼Ÿå¯¹äº $A$ã€$B$ å’Œ $L$ æ¥è¯´ï¼Œç›´å¾„æ˜¯å¦æ”¹å˜å–å†³äº $L$ èƒ½å¦æ›¿ä»£ $A$ æˆ– $B$ï¼Œä¸€å…±æœ‰å…­ç§æƒ…å†µã€‚æˆ‘ä»¬è®° $\text{dist}(A,L)=da$ï¼Œ$\text{dist}(B,L)=db$ï¼Œå½“å‰æ ‘çš„ç›´å¾„ä¸º $res$ï¼Œå…­ç§æƒ…å†µå¦‚ä¸‹ï¼š
>
>     1. $\text{max}(da, db) \le \text{res}$ï¼Œäº¤æ¢ $A$ å’Œ $B$ å¾—åˆ° $2$ ç§
>     2. $\text{min}(da,db) \ge \text{res}$ï¼Œäº¤æ¢ $A$ å’Œ $B$ å¾—åˆ° $2$ ç§
>     3. $\text{max}(da,db) >res,\text{min}(da,db) < \text{res}$ï¼Œäº¤æ¢ $A$ å’Œ $B$ å¾—åˆ° $2$â€‹ ç§
>
>     å¦‚å›¾ï¼šæˆ‘ä»¬åªéœ€è¦åœ¨å…¶ä¸­çš„æœ€å¤§å€¼ä¸¥æ ¼è¶…è¿‡å½“å‰æ ‘çš„ç›´å¾„ $\text{res}$ æ—¶æ›´æ–° **ç›´å¾„å¯¹åº”çš„ç»“ç‚¹** ä»¥åŠ **ç›´å¾„çš„é•¿åº¦** å³å¯
>
>     ![å…­ç§æƒ…å†µ](https://cdn.dwj601.cn/images/202403282344777.jpg)
>
> - **å¦‚ä½•å¿«é€Ÿè®¡ç®—æ ‘ä¸Šä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»**ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€è¿‘å…¬å…±ç¥–å…ˆ LCA ç®—æ³•ã€‚åˆ™æ ‘ä¸Šä»»æ„ä¸¤ç‚¹ $x,y$ ä¹‹é—´çš„è·ç¦» $\text{dist}(x,y)$ ä¸ºï¼š
> 
>     $$
>     \text{dist}(x, y) = \text{dist}(x, root) + \text{dist}(y, root) - 2 \times \text{dist}(\text{lca}(x, y), root)
>     $$
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(q \log n)$

æš´åŠ›æœç´¢ä»£ç 

```cpp
#include <iostream>
#include <cstring>
#include <vector>
#include <queue>
#include <stack>
#include <algorithm>
#include <unordered_map>
#include <set>
using namespace std;

const int N = 500010;

vector<int> g[N];
int d[N];
bool vis[N];
pair<int, int> res;     // first ä¸ºæœ€è¿œè·ç¦»ï¼›second ä¸ºå¯¹åº”ç»“ç‚¹ç¼–å·

void dfs(int pre, int now) {
    if (vis[now]) return;
    
    vis[now] = true;
    
    if (pre != -1) {
        d[now] = d[pre] + 1;
        if (d[now] > res.first) {
            res = {d[now], now};
        }
    }
    
    for (auto& ch: g[now]) {
        dfs(now, ch);
    }
}

void solve() {
    // init
    for (int i = 2; i <= 4; i++) {
        g[1].push_back(i);
        g[i].push_back(1);
    }
    
    int now = 4;
    
    int Q;
    cin >> Q;
    while (Q--) {
        int id;
        cin >> id;
        
        g[id].push_back(++now);
        g[now].push_back(id);
        
        g[id].push_back(++now);
        g[now].push_back(id);
        
        res = {-1, -1};
        
        // ç¬¬ä¸€è¶Ÿ
        memset(vis, false, sizeof vis);
        memset(d, 0, sizeof d);
        d[1] = 0;
        dfs(-1, 1);
        
        // ç¬¬äºŒè¶Ÿ
        memset(vis, false, sizeof vis);
        memset(d, 0, sizeof d);
        d[res.second] = 0;
        dfs(-1, res.second);
        
        cout << res.first << "\n";
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

LCA ä»£ç 

```cpp
#include <iostream>
#include <cstring>
#include <vector>
#include <queue>
#include <stack>
#include <algorithm>
#include <unordered_map>
#include <set>
using namespace std;

const int N = 1000010, M = 20;

int d[N];        // d[i] è¡¨ç¤º i å·ç‚¹åˆ°æ ¹ç»“ç‚¹çš„è·ç¦»
int to[N][M];    // to[i][j] è¡¨ç¤º i å·ç‚¹å‘ä¸Šè·³ 2^j æ­¥ååˆ°è¾¾çš„ç»“ç‚¹ç¼–å·

int lca(int a, int b) {
    if (d[a] < d[b]) swap(a, b);

    for (int k = M - 1; k >= 0; k--)
        if (d[to[a][k]] >= d[b])
            a = to[a][k];

    if (a == b) return a;

    for (int k = M - 1; k >= 0; k--)
        if (to[a][k] != to[b][k])
            a = to[a][k], b = to[b][k];

    return to[a][0];
}

int dist(int a, int b) {
    return d[a] + d[b] - 2 * d[lca(a, b)];
}

void solve() {
    int Q;
    cin >> Q;

    // init lca
    for (int i = 2; i <= 4; i++) {
        d[i] = 1;
        to[i][0] = 1;
    }

    int A = 2, B = 4, now = 4, res = 2;

    while (Q--) {
        int fa;
        cin >> fa;

        int L1 = ++now, L2 = ++now;

        // upd lca
        d[L1] = d[fa] + 1;
        d[L2] = d[fa] + 1;
        to[L1][0] = fa;
        to[L2][0] = fa;
        for (int k = 1; k <= M - 1; k++) {
            to[L1][k] = to[ to[L1][k-1] ][ k-1 ];
            to[L2][k] = to[ to[L2][k-1] ][ k-1 ];
        }

        int da = dist(A, L1), db = dist(B, L1);

        if (max(da, db) <= res) res = res;
        else if (min(da, db) >= res) {
            if (da > db) res = da, B = L1;
            else res = db, A = L1;
        } else {
            if (da > db) res = da, B = L1;
            else res = db, A = L1;
        }

        cout << res << "\n";
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

## åšå¼ˆè®º

åšå¼ˆè®ºçš„ã€Œä¾‹é¢˜è§£æã€ã€‚æ€è€ƒå¦‚ä½•å¿…èƒœæ€å’Œå¿…è´¥æ€æ˜¯ä»€ä¹ˆä»¥åŠå¦‚ä½•æ„é€ è¿™æ ·çš„å±€é¢ã€‚

Salyg1n and the MEX Game

<https://codeforces.com/contest/1867/problem/C>

> æ ‡ç­¾ï¼šåšå¼ˆã€è´ªå¿ƒã€äº¤äº’
>
> é¢˜é¢ï¼šå¯¹äºç»™å®š n ä¸ªæ•°çš„æ•°åˆ—ï¼Œå…ˆæ‰‹å¯ä»¥æ”¾å…¥ä¸€ä¸ªæ•°åˆ—ä¸­ä¸å­˜åœ¨çš„æ•°ï¼ˆ0-1e9ï¼‰ï¼Œåæ‰‹å¯ä»¥ä»æ•°åˆ—ä¸­æ‹¿æ‰ä¸€ä¸ªæ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ•°å¿…é¡»ä¸¥æ ¼å°äºåˆšæ‰å…ˆæ‰‹æ”¾å…¥çš„æ•°ã€‚ç»ˆæ­¢æ¡ä»¶ï¼šåæ‰‹æ²¡æ³•æ‹¿æ•°æˆ–è€…æ“ä½œæ¬¡æ•°è¾¾åˆ°äº† 2n+1 æ¬¡ã€‚é—®ï¼šå½“ä½ æ˜¯å…ˆæ‰‹æ—¶ï¼Œå¦‚ä½•æ”¾æ•°å¯ä»¥ä½¿å¾—æœ€ç»ˆæ•°åˆ—çš„ MEX å€¼æœ€å¤§ã€‚
>
> æ€è·¯ï¼šå…ˆæ‰‹æ¯æ¬¡æ”¾å…¥çš„æ•°ä¸€å®šæ˜¯å½“å‰æ•°åˆ—çš„ MEX å€¼ï¼Œæ­¤åä¸ç®¡åæ‰‹æ‹¿æ‰ä»€ä¹ˆæ•°ï¼Œå…ˆæ‰‹éƒ½å°†åˆšåˆšè¢«æ‹¿æ‰çš„æ•°æ”¾è¿›å»å³å¯ã€‚é‚£ä¹ˆæœ€å¤šæ“ä½œæ¬¡æ•°å°±åˆšå¥½æ˜¯ 2n+1 æ¬¡ï¼Œå› ä¸ºåŠ å…¥å½“å‰æ•°åˆ—å°±æ˜¯ä¸€ä¸ªä» 0 å¼€å§‹çš„è¿ç»­æ•´æ•°æ•°åˆ—ï¼Œé‚£ä¹ˆå…ˆæ‰‹æ”¾å…¥çš„æ•°å°±æ˜¯æœ€å¤§æ•° +1ï¼Œå³ nï¼Œé‚£ä¹ˆå‡å¦‚åæ‰‹ä» n-1 å¼€å§‹æ‹¿ï¼Œåæ‰‹æœ€å¤šæ‹¿ n æ¬¡ï¼Œå…ˆæ‰‹å†æ”¾ n æ¬¡ï¼Œé‚£ä¹ˆå°±æ˜¯ 2n+1 æ¬¡ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
#include <iostream>
#include <vector>

using namespace std;

int main()
{
	int T; cin >> T;
	
	while (T--)
	{
		int n; cin >> n;
		vector<int> a(n);
		
		for (int i = 0; i < n; i ++)
			cin >> a[i];
		
		int mex = n;
		for (int i = 0; i < n; i ++)
			if (a[i] != i)
			{
				mex = i;
				break;
			}
		
		cout << mex << endl;
		
		int remove;
		cin >> remove;
		
		while (remove != -1)
		{
			cout << remove << endl;
			cin >> remove;
		}
	}
	
	return 0;
} 
```

## è®¡ç®—å‡ ä½•

è®¡ç®—å‡ ä½•çš„ã€Œä¾‹é¢˜è§£æã€ã€‚

Minimum Manhattan Distance

<https://codeforces.com/gym/104639/problem/J>

> æ ‡ç­¾ï¼šäºŒç»´ã€æ•°å­¦
>
> é¢˜æ„ï¼šç»™å®šä¸¤ä¸ªåœ†çš„ç›´å¾„çš„ä¸¤ä¸ªç‚¹åæ ‡ï¼Œå…¶ä¸­çº¦æŸæ¡ä»¶æ˜¯ä¸¤ä¸ªåœ†ä¸€å®šæ˜¯å¤„åœ¨ç›¸ç¦»çš„ä¸¤ä¸ªè§’ä¸Šã€‚é—®å¦‚ä½•åœ¨ C2 åœ†ä¸Šæˆ–åœ†å†…æ‰¾åˆ°ä¸€ç‚¹ pï¼Œä½¿å¾—ç‚¹ p åˆ° C1 åœ†çš„æ‰€æœ‰ç‚¹çš„æ›¼å“ˆé¡¿è·ç¦»çš„æœŸæœ›å€¼æœ€å°
>
> æ€è·¯ï¼š
>
> - çœ‹ä¼¼éœ€è¦ç§¯åˆ†ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹äºç‚¹ p åˆ° C1 ä¸­æŸä¸ªç‚¹ q1 çš„æ›¼å“ˆé¡¿è·ç¦»ï¼Œæˆ‘ä»¬ä¸€å®šå¯ä»¥æ‰¾åˆ° q1 å…³äº C1 å¯¹ç§°çš„ç‚¹ q2ï¼Œé‚£ä¹ˆç‚¹ p åˆ° q1 å’Œ q2 çš„æ›¼å“ˆé¡¿è·ç¦»ä¹‹å’Œå°±æ˜¯ç‚¹ p åˆ° C1 çš„æ›¼å“ˆé¡¿è·ç¦»çš„ä¸¤å€ï¼ˆè¯æ˜å°±æ˜¯ä¸­çº¿å®šç†ï¼‰é‚£ä¹ˆæœŸæœ›çš„æœ€å°å€¼å°±æ˜¯ç‚¹ p åˆ° C1 çš„æ›¼å“ˆé¡¿è·ç¦»çš„æœ€å°å€¼ã€‚ç›®æ ‡è½¬åŒ–åï¼Œæˆ‘ä»¬å¼€å§‹æ€è€ƒå¦‚ä½•è®¡ç®—æ­¤ç›®æ ‡çš„æœ€å°å€¼ï¼Œæ€è·¯å¦‚ä¸‹å›¾
>
>     ![image-20240116175917260](https://cdn.dwj601.cn/images/202402252321057.png)
>
> æ³¨æ„ç‚¹ï¼š
>
> - double çš„è¯»å–é€Ÿåº¦å¾ˆæ…¢ï¼Œå¯ä»¥ç”¨ `int` or `long long` è¯»å…¥ï¼Œåç»­å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆæ˜¾ç¤º or å’Œæµ®ç‚¹æ•°è®¡ç®—ï¼‰
> - æ³¨æ„è¾“å‡ºç­”æ¡ˆçš„ç²¾åº¦æ§åˆ¶  `cout << fixed << setprecision(10) << res << "\n";`

```cpp
void solve() {
	double x1, y1, x2, y2;
	long long a, b, c, d;

	cin >> a >> b >> c >> d;
	x1 = (a + c) / 2.0;
	y1 = (b + d) / 2.0;

	cin >> a >> b >> c >> d;
	x2 = (a + c) / 2.0;
	y2 = (b + d) / 2.0;

	double r2 = sqrt((a - c) * (a - c) + (b - d) * (b - d)) / 2;

	cout << fixed << setprecision(10) <<  abs(x1 - x2) + abs(y1 - y2) - sqrt(2) * r2 << "\n";
}
```

ä¸‰è§’å½¢

<https://www.acwing.com/problem/content/5383/>

> æ ‡ç­¾ï¼šæšä¸¾
>
> é¢˜æ„ï¼šç»™å®šä¸¤ä¸ªç›´è§’ä¸‰è§’å½¢çš„ä¸¤æ¡ç›´è§’è¾¹çš„é•¿åº¦ a, bï¼Œé—®èƒ½ä¸èƒ½åœ¨åæ ‡è½´ä¸Šæ‰¾åˆ°ä¸‰ä¸ªæ•´æ•°ç‚¹ä½¿å¾—ä¸‰ç‚¹æ»¡è¶³è¯¥ç›´è§’ä¸‰è§’å½¢ä¸”ä¸‰éå‡ä¸ä¸åæ ‡è½´å‚ç›´
>
> æ€è·¯ï¼šé¦–å…ˆç¡®å®šä¸¤ä¸ªç›´è§’è¾¹çš„é¡¶ç‚¹ä¸ºåŸç‚¹ (0, 0)ï¼Œæ¥ç€æ ¹æ®å¯¹ç§°æ€§ç›´æ¥åœ¨ç¬¬ä¸€è±¡é™ä¸­æŒ‰ç…§è¾¹é•¿æšä¸¾å…¶ä¸­ä¸€ä¸ªé¡¶ç‚¹ Aï¼Œå¯¹äºæ¯ä¸€ä¸ªæšä¸¾åˆ°çš„é¡¶ç‚¹ Aï¼ŒæŒ‰ç…§æ–œç‡æšä¸¾æœ€åä¸€ä¸ªé¡¶ç‚¹ Bï¼Œå¦‚æœæ»¡è¶³é•¿åº¦ä»¥åŠä¸å¹³è¡Œäºåæ ‡è½´çš„æ¡ä»¶å°±æ˜¯åˆæ³•çš„ç‚¹ã€‚å¦‚æœå…¨éƒ¨æšä¸¾å®Œéƒ½æ²¡æœ‰æ‰¾åˆ°å°±æ˜¯æ²¡æœ‰åˆæ³•ç»„åˆï¼Œç›´æ¥è¾“å‡º NO å³å¯ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(a^2b)$

```cpp
#include <bits/stdc++.h>
using namespace std;

#define int long long

int a, b;

void solve() {
	cin >> a >> b;

	for (int i = 0; i <= a; i++) {
		for (int j = 0; j <= a; j++) {
			if (i * i + j * j == a * a && i && j) {
				int gcd = __gcd(i, j);
				int p = -i / gcd, q = j / gcd;
				int y = p, x = q;
				while (x * x + y * y < b * b) {
					x += q, y += p;
				}
				if (x * x + y * y == b * b && x != i && y != j) {
					cout << "YES\n";
					cout << 0 << ' ' << 0 << "\n";
					cout << i << ' ' << j << "\n";
					cout << x << ' ' << y << "\n";
					return;
				}
			}
		}
	}

	cout << "NO\n";
}

signed main() {
	ios::sync_with_stdio(false);
	cin.tie(nullptr), cout.tie(nullptr);
	int T = 1;
//	cin >> T;
	while (T--) solve();
	return 0;
}
```

å¥¶ç‰›è¿‡é©¬è·¯

<https://www.acwing.com/problem/content/5572/>

> æ ‡ç­¾ï¼šå‡¸åŒ…
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªäºŒç»´åæ ‡ç³»ï¼Œç°åœ¨æœ‰ä¸¤ä¸ªä¸œè¥¿å¯ä»¥è¿›è¡Œå¹³ç§»ã€‚
>
> - ä¸€ä¸ªæ˜¯èµ·å§‹ä½äº $(0,0)$ çš„å¥¶ç‰›ï¼Œå¯ä»¥æ²¿ç€ $y$ è½´ä»¥ $[0,u]$ çš„é€Ÿåº¦æ­£å‘æˆ–è´Ÿå‘ç§»åŠ¨
> - ä¸€ä¸ªæ˜¯èµ·å§‹ä½äºç¬¬ä¸€è±¡é™çš„å‡¸åŒ…å½¢çŠ¶çš„è½¦è¾†ï¼Œå¯ä»¥å‘ $x$ è½´è´ŸåŠè½´ä»¥æ’å®šçš„é€Ÿåº¦ $v$ ç§»åŠ¨
>
> åœ¨ç»™å®šå‡¸åŒ…çš„ $n$ ä¸ªé¡¶ç‚¹çš„æƒ…å†µä¸‹ï¼Œä»¥åŠä¸å…è®¸å¥¶ç‰›è¢«è½¦è¾†æ’åˆ°çš„æƒ…å†µä¸‹ï¼Œå¥¶ç‰›å‰è¿›åˆ° $(0,w)$ çš„æœ€çŸ­æ—¶é—´
>
> æ€è·¯ï¼šç”±äºæ˜¯å‡¸åŒ…ï¼Œå› æ­¤æ¯ä¸€ä¸ªé¡¶ç‚¹åŒæ—¶æ»¡è¶³çš„æ€§è´¨ï¼Œå°±å¯ä»¥ä»£è¡¨æ•´ä¸ªå‡¸åŒ…æ»¡è¶³çš„æ€§è´¨ã€‚é‚£ä¹ˆå¯¹äºå¥¶ç‰›å’Œå‡¸åŒ…ï¼Œå°±ä¸€å…±æœ‰ä¸‰ä¸ªå±€é¢ï¼š
>
> 1. å¥¶ç‰›é€Ÿåº¦è¶³å¤Ÿå¿«ã€‚å¯ä»¥ä½¿å¾—å¯¹äºä»»æ„ä¸€ä¸ªé¡¶ç‚¹ $(x,y)$ åœ¨åˆ°è¾¾ y è½´æ—¶ï¼Œéƒ½å°äºæ­¤æ—¶å¥¶ç‰›çš„ y å€¼ï¼Œç”¨æ—¶é—´æ¥è¡¨ç¤ºå°±æ˜¯ $\frac{y}{u} \le \frac{x}{v}$ï¼Œå³ $y \le \frac{u}{v}x$ï¼Œè¡¨ç¤ºå‡¸åŒ…ä¸Šæ‰€æœ‰çš„é¡¶ç‚¹éƒ½åœ¨ç›´çº¿ $y=\frac{u}{v}$ çš„ä¸‹æ–¹
> 2. å‡¸åŒ…é€Ÿåº¦è¶³å¤Ÿå¿«ã€‚å¯ä»¥ä½¿å¾—å¯¹äºä»»æ„ä¸€ä¸ªé¡¶ç‚¹ $(x,y)$ åœ¨åˆ°è¾¾ y è½´æ—¶ï¼Œéƒ½å¤§äºæ­¤æ—¶å¥¶ç‰›çš„ y å€¼ï¼Œç”¨æ—¶é—´æ¥è¡¨ç¤ºå°±æ˜¯ $\frac{y}{u} \ge \frac{x}{v}$ï¼Œå³ $y \ge \frac{u}{v}x$ï¼Œè¡¨ç¤ºå‡¸åŒ…ä¸Šæ‰€æœ‰çš„é¡¶ç‚¹éƒ½åœ¨ç›´çº¿ $y=\frac{u}{v}$ çš„ä¸Šæ–¹
> 3. ä¸Šè¿°ä¸¤ç§éƒ½ä¸æ»¡è¶³ï¼Œå³ç›´çº¿ $y=\frac{u}{v}$ ä¸å‡¸åŒ…ç›¸äº¤ã€‚æ­¤æ—¶å¥¶ç‰›å°±ä¸èƒ½ä¸€ç›´å…¨é€Ÿï¼ˆuï¼‰å‰è¿›åˆ°ç»ˆç‚¹äº†ï¼Œéœ€è¦è¿›è¡Œä¸€å®šçš„å‡é€Ÿ or è¿”å›æ“ä½œã€‚æœ‰ä¸€ä¸ªæ˜¾ç„¶çš„ç»“è®ºå°±æ˜¯ï¼Œå¯¹äºå‡é€Ÿ or è¿”å›çš„æ“ä½œï¼Œéƒ½å¯ä»¥ç­‰ä»·äºåé€€ä¸€æ®µè·ç¦»åå†å…¨é€Ÿï¼ˆuï¼‰å‰è¿›ï¼Œå› æ­¤å¯¹äºéœ€è¦å‡é€Ÿ or è¿”å›çš„æ“ä½œï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—å‡ºå½“å‰çŠ¶æ€ä¸‹åº”è¯¥åé€€çš„è·ç¦»å³å¯ã€‚å†ç®€æ´çš„ï¼Œæˆ‘ä»¬å°±æ˜¯éœ€è¦å¹³ç§»ç›´çº¿ $y=\frac{u}{v}$ï¼Œæ˜¾ç„¶åªèƒ½å‘ä¸‹å¹³ç§»è€Œéå‘ä¸Šå¹³ç§»ï¼Œå› æ­¤å…¶å®å°±æ˜¯è®¡ç®—å‡ºç›´çº¿ $y=\frac{u}{v}+b$ çš„æˆªè· $b$ ä½¿å¾—æœ€ç»ˆçš„ç›´çº¿ $y=\frac{u}{v}+b$ æ»¡è¶³ç¬¬äºŒç§æ¡ä»¶å³å¯ã€‚é‚£ä¹ˆå¦‚ä½•è®¡ç®—è¿™ä¸ª b å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶æˆ‘ä»¬å¯ä»¥éå†æ¯ä¸€ä¸ªé¡¶ç‚¹å–æ»¡è¶³æ‰€æœ‰é¡¶ç‚¹éƒ½åœ¨ç›´çº¿ $y=\frac{u}{v}+b$â€‹ ä¸Šæ–¹çš„æœ€å¤§æˆªè· b å³å¯ã€‚
>
> æ³¨æ„ç‚¹ï¼š
>
> - æµ®ç‚¹æ•°æ¯”è¾ƒæ³¨æ„ç²¾åº¦è¯¯å·®ï¼Œå°½å¯èƒ½å°†é™¤æ³•è½¬åŒ–ä¸ºä¹˜æ³•
> - åœ¨æ¯”è¾ƒç›¸ç­‰æ—¶å¯ä»¥å¼•å…¥ä¸€ä¸ªæ— ç©·å°é‡ $\epsilon=10^{-7}$
> - æ³¨æ„ç­”æ¡ˆè¾“å‡ºç²¾åº¦è¦æ±‚ï¼Œ$10^{-6}$ å°±éœ€è¦æˆ‘ä»¬å‡ºè‡³å°‘ $7$ ä½å°æ•°
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

C++

```cpp
#include <iostream>
#include <cstring>
#include <algorithm>
#include <iomanip>
using namespace std;
using ll = long long;

int main() {
	double n, w, v, u;
	cin >> n >> w >> v >> u;
	
	bool up = false, down = false;
	double b = 0;
	
	while (n--) {
		double x, y;
		cin >> x >> y;
        
        // é™¤æ³•æ— æ³•é€šè¿‡
		// if (y / x < u / v) down = true;
		// else if (y / x > u / v) up = true;
        
        // è½¬åŒ–ä¸ºä¹˜æ³•ä»¥åæ‰èƒ½é€šè¿‡
		if (y < u / v * x) down = true;
		else if (y > u / v * x) up = true;
        
		b = min(b, y - u / v * x);
	}
	
	if (up && down) cout << setprecision(7) << (w - b) / u;
	else cout << setprecision(7) << w / u;
	
	return 0;
}
```

Py

```python
read = lambda: map(int, input().split())

n, w, v, u = read()
k = u / v
b = 0
up = False
down = False

for _ in range(n):
    x, y = read()
    if (y < k * x): down = True
    if (y > k * x): up = True
    b = min(b, y - k * x)

if (up and down): print((w - b) / u)
else: print(w / u)
```

## æ•°è®º

æ•°è®ºçš„ã€Œä¾‹é¢˜è§£æã€ã€‚æ•´æ•°é—®é¢˜ã€‚

### è´¨æ•°

Divide and Equalize

> é¢˜æ„ï¼šç»™å®š $n$ ä¸ªæ•°ï¼Œé—®èƒ½å¦æ‰¾åˆ°ä¸€ä¸ªæ•° $num$ï¼Œä½¿å¾— $num^n = \prod_{i=1}^{n}a_i$
>
> åŸå§‹æ€è·¯ï¼šèµ·åˆæˆ‘çš„æ€è·¯æ˜¯äºŒåˆ†ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ä¸ªæ•°ä½¿å¾— n ä¸ªæ•°ç›¸ä¹˜ä¸ºåŸæ•°ç»„æ‰€æœ‰å…ƒç´ ä¹‹ç§¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¢„è®¡ç®—å‡ºæ‰€æœ‰æ•°ä¹‹ç§¯ï¼Œå¹¶ä¸”åœ¨æ•°ç»„æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹é—´è¿›è¡ŒäºŒåˆ†ï¼Œæ¯æ¬¡äºŒåˆ†å‡ºæ¥çš„æ•°è®¡ç®— n æ¬¡æ–¹è¿›è¡Œç¬”æ¯”è¾ƒå³å¯ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜æ˜¯ï¼Œæ•°æ®é‡æ˜¯ $10^4$ï¼Œè€Œæ•°å­—æœ€å¤§ä¸º $10^6$ï¼Œæœ€å¤§ä¹‹ç§¯ä¸º $10^{10}$ å—ï¼Ÿä¸æ˜¯ï¼æœ€å¤§ä¹‹å’Œæ‰æ˜¯ï¼Œæœ€å¤§ä¹‹ç§¯æ˜¯ $10^{6\times10^4}$
>
> æœ€ç»ˆæ€è·¯ï¼šæˆ‘ä»¬å¯ä»¥å°†é€‰æ•°çœ‹åšå¤šä¸ªæ°´æ± åŒ€æ°´çš„è¿‡ç¨‹ã€‚ç°åœ¨æ¯ä¸€ä¸ªæ°´æ± çš„æ°´é«˜éƒ½ä¸å®šï¼Œå¾ˆæ˜¾ç„¶æˆ‘ä»¬ä¸€å®šå¯ä»¥ä¸€ä¸ªå€¼ä½¿å¾—æ‰€æœ‰çš„æ°´æ± çš„é«˜åº¦ä¸€è‡´ï¼Œå³ $\frac{\sum_{i=1}^{n}a_i}{n}$ã€‚ä½†æ˜¯æˆ‘ä»¬æœ€ç»ˆçš„æ•°å­—æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæ˜¾ç„¶ä¸å¯ä»¥ç›´æ¥æ±‚å’Œç„¶åé™¤ä»¥ nï¼Œé‚£ä¹ˆåº”è¯¥å¦‚ä½•åˆ†é…å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“æ°´æ± ä¹‹æ‰€ä»¥å¯ä»¥ç›´æ¥é™¤ä»¥ nï¼Œæ˜¯å› ä¸ºæ°´çš„æœ€å°åˆ†é…å•ä½æ˜¯æ— ç©·å°ï¼Œå¯ä»¥éšæ„åˆ†å‰²ï¼›è€Œå¯¹äºæ•´æ•°è€Œè¨€ï¼Œæœ€å°åˆ†é…å•ä½æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ **è´¨å› å­**ï¼ä¸ºäº†é€šè¿‡åˆ†é…æœ€å°å•ä½ä½¿å¾—æœ€ç»ˆçš„â€œæ°´æ± é«˜åº¦ä¸€è‡´â€ï¼Œæˆ‘ä»¬éœ€è¦è®©æ¯ä¸€ä¸ªâ€œæ°´æ± â€è·å¾—çš„æ•°å€¼ç›¸åŒçš„è´¨å› å­æ•°é‡ç›¸åŒã€‚äºæ˜¯æˆ‘ä»¬åªéœ€è¦ç»Ÿè®¡ä¸€ä¸‹æ•°ç»„ä¸­æ‰€æœ‰æ•°çš„è´¨å› å­æ•°é‡å³å¯ã€‚å¦‚æœå¯¹äºæ¯ä¸€ç§è´¨å› å­çš„æ•°é‡éƒ½å¯ä»¥å‡åŒ€åˆ†é…æ¯ä¸€ä¸ªæ•°ï¼ˆå³æ•°é‡æ˜¯ n çš„æ•´æ•°å€ï¼‰ï¼Œé‚£ä¹ˆå°±ä¸€å®šå¯ä»¥æ‰¾åˆ°è¿™ä¸ªæ•°ä½¿å¾— $num^n = \prod_{i=1}^{n}a_i$

```cpp
void solve() {
	int n;
	cin >> n;

	// ç»Ÿè®¡æ‰€æœ‰æ•°å­—çš„æ‰€æœ‰è´¨å› æ•°
	unordered_map<int, int> m;
	for (int i = 0; i < n; i++) {
		int x;
		cin >> x;

		for (int k = 2; k <= x / k; k++) {
			if (x % k == 0) {
				while (x % k == 0) {
					m[k]++;
					x /= k;
				}
			}
		}

		if (x > 1) {
			m[x]++;
		}
	}

	// æŸ¥çœ‹æ¯ä¸€ç§è´¨å› æ•°æ˜¯å¦æ˜¯nçš„æ•´æ•°å€
	for (auto& x: m) {
		if (x.second % n) {
			cout << "No\n";
			return;
		}
	}

	cout << "Yes\n";
}
```

### æ•´é™¤

Deja Vu

<https://codeforces.com/contest/1891/problem/B>

> é¢˜æ„ï¼šç»™ç‚¹åºåˆ— a å’Œ bï¼Œå¯¹äº b ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´  $b_i$ï¼Œå¦‚æœ a ä¸­çš„å…ƒç´  $a_j$ èƒ½å¤Ÿæ•´é™¤ $2^{b_i}$ï¼Œåˆ™å°† $a_j$ åŠ ä¸Š $2^{b_i - 1}$ã€‚ç»™å‡ºæœ€åçš„ a åºåˆ—
>
> æ€è·¯ä¸€ï¼šæš´åŠ›æšä¸¾ã€‚
>
> - æˆ‘ä»¬å¾ˆå®¹æ˜“å°±æƒ³åˆ°æš´åŠ›çš„åšæ³•ï¼Œå³ä¸¤å±‚å¾ªç¯ï¼Œç¬¬ä¸€å±‚æšä¸¾ b ä¸­çš„å…ƒç´ ï¼Œç¬¬äºŒå±‚æšä¸¾ a ä¸­çš„å…ƒç´ ï¼Œå¦‚æœ a ä¸­çš„å…ƒç´ èƒ½å¤Ÿæ•´é™¤ 2 çš„ $b^i$ æ¬¡æ–¹ï¼Œå°±å°† a ä¸­ç›¸åº”çš„å…ƒç´ åŠ ä¸Šä¸€ä¸ªå€¼å³å¯ã€‚ä½†æ˜¯æ—¶é—´å¤æ‚åº¦è‚¯å®šè¿‡ä¸äº†ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(nm)$
>
> æ€è·¯äºŒï¼šæ•´é™¤ä¼˜åŒ–ã€‚
>
> - ç°åœ¨æˆ‘ä»¬å‡è®¾ a ä¸­æœ‰ä¸€ä¸ªæ•° $a_j$ æ˜¯ $2^{b_i}$ çš„æ•´æ•°å€ï¼ˆå…¶ä¸­ $b_i$ æ˜¯ b åºåˆ—ä¸­ç¬¬ä¸€ä¸ªæšä¸¾åˆ°çš„èƒ½å¤Ÿè®© $a_i$ æ•´é™¤çš„æ•°ï¼‰ï¼Œé‚£ä¹ˆå°±æœ‰ $a_j = k2^{b_i}(k=1,2,...,)$ï¼Œé‚£ä¹ˆ $a_j$ å°±è¦åŠ ä¸Š $2^{b_i-1}$ï¼Œäºæ˜¯ $a_j$ å°±å˜ä¸ºäº† $k2^{b_i}+2^{b_i-1}=(2k+1)2^{b_i-1}$ã€‚æ­¤å $a_j$ å°±ä¸€å®šæ˜¯ $2^t(t\in \left[ 1,b_i-1 \right])$ çš„å€æ•°ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯é¦–å…ˆæ‰¾åˆ° b åºåˆ—ä¸­ç¬¬ä¸€ä¸ªæ•° xï¼Œèƒ½å¤Ÿåœ¨ a ä¸­æ‰¾åˆ°æ•°æ˜¯ $2^x$ çš„æ•´æ•°å€ã€‚è¿™ä¸€æ­¥å¯ä»¥è¿™æ ·è¿›è¡Œï¼šå¯¹äº a ä¸­çš„æ¯ä¸€ä¸ªæ•°ï¼Œæˆ‘ä»¬è¿›è¡Œ 30 æ¬¡å¾ªç¯ç»Ÿè®¡å½“å‰æ•°æ˜¯å¦æ˜¯ $2^i$ çš„å€æ•°ï¼Œå¦‚æœæ˜¯å°±ç”¨å“ˆå¸Œè¡¨è®°å½•å½“å‰çš„ $i$ã€‚æœ€åæˆ‘ä»¬åœ¨éå†å¯»æ‰¾ x æ—¶ï¼Œåªéœ€è¦æŸ¥çœ‹å½“å‰çš„ x æ˜¯å¦è¢«å“ˆå¸Œè¿‡å³å¯ã€‚æ¥ç€æˆ‘ä»¬ç»Ÿè®¡ b åºåˆ—ä¸­ä» x å¼€å§‹çš„ä¸¥æ ¼é™åºåºåˆ— cï¼ˆç”±é¢˜æ„çŸ¥ï¼Œæ¬¡åºåˆ—çš„æ•°é‡ä¸€å®š $\le$ 30ï¼Œå› ä¸º b åºåˆ—ä¸­æ•°å€¼çš„å€¼åŸŸä¸º $[1~30]$ï¼‰ã€‚æœ€åæˆ‘ä»¬å†æŒ‰ç…§åŸæ¥çš„æ€è·¯ï¼ŒåŒé‡å¾ªç¯ a åºåˆ—å’Œ c åºåˆ—å³å¯ã€‚
>
> - æ—¶é—´å¤æ‚åº¦ï¼š$O(30n)$

```cpp
void solve() {
	int n, m;
	cin >> n >> m;

	vector<int> a(n + 1), b(m + 1);
	unordered_map<int, int> ha;

    // è¾¹è¯»è¾¹å“ˆå¸Œ
	for (int i = 1; i <= n; i++) {
		cin >> a[i];
		for (int j = 30; j >= 1; j--) {
			if (a[i] % (1 << j) == 0) {
				ha[j]++;
			}
		}
	}

	for (int i = 1; i <= m; i++) {
		cin >> b[i];
	}

	// å¯»æ‰¾bä¸­ç¬¬ä¸€ä¸ªèƒ½å¤Ÿè®©a[j]æ•´é™¤çš„æ•°b[flag]
	int flag = -1;
	for (int i = 1; i <= m; i++) {
		if (ha[b[i]]) {
			flag = i;
			break;
		}
	}

    // ç‰¹åˆ¤
	if (flag == -1) {
		for (int j = 1; j <= n; j++) {
			cout << a[j] << " \n"[j == n];
		}
		return;
	}

    // å¯»æ‰¾bä¸­ä»flagå¼€å§‹çš„ä¸¥æ ¼å•è°ƒé€’å‡çš„åºåˆ—c
	vector<int> c;
	c.push_back(b[flag]);
	for (; flag <= m; flag++) {
		if (b[flag] < c.back()) {
			c.push_back(b[flag]);
		}
	}

    // æš´åŠ›å¾ªç¯ä¸€éå³å¯
	for (int j = 1; j <= n; j++) {
		for (int k = 0; k < c.size(); k++) {
			if (a[j] % (1 << c[k]) == 0) {
				a[j] += 1 << (c[k] - 1);
			}
		}
	}

	for (int j = 1; j <= n; j++) {
		cout << a[j] << " \n"[j == n];
	}
}
```

### ç»„åˆæ•°å­¦

åºåˆ—æ•°é‡

<https://www.acwing.com/problem/content/5571/>

> é¢˜æ„ï¼šç»™å®š $i(i=1,2,\cdots,n)$ ä¸ªè‹¹æœï¼Œå°†å…¶åˆ†ç»™ $m$ ä¸ªäººï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ç§åˆ†é…æ–¹æ¡ˆï¼Œç»™å‡ºç»“æœå¯¹ $10^6+3$ å–æ¨¡çš„ç»“æœ
>
> æ€è·¯ï¼šæ•´æ•°åˆ†é…é—®é¢˜ã€‚æˆ‘ä»¬é‡‡ç”¨éš”æ¿æ³•ï¼Œéš”æ¿æ³•ç›¸å…³ä¾‹é¢˜è§è¿™ç¯‡åšå®¢ï¼š<https://www.acwing.com/solution/content/241669/>ã€‚ä¸‹é¢å¼€å§‹è®²è§£
>
> - åˆ©ç”¨ **éš”æ¿æ³•** æ¨å¯¼ç»“æœã€‚é¦–å…ˆæˆ‘ä»¬è€ƒè™‘å½“å‰å±€é¢ï¼Œå³åªæœ‰ i ä¸ªè‹¹æœçš„æƒ…å†µä¸‹çš„æ–¹æ¡ˆæ•°ã€‚äºæ˜¯é¢˜ç›®å°±æ˜¯ i ä¸ªè‹¹æœåˆ†ç»™ m ä¸ªäººï¼Œå…è®¸åˆ†åˆ° 0 ä¸ªã€‚äºæ˜¯å€Ÿé‰´ä¸Šè¿°é“¾æ¥ä¸­â€œå°‘åˆ†å‹â€çš„æ€è·¯ï¼Œå…ˆå€Ÿ m ä¸ªè‹¹æœï¼Œé‚£ä¹ˆæ­¤æ—¶å±€é¢ä¸­å°±æœ‰ i+m ä¸ªè‹¹æœï¼Œç°åœ¨å°±ç­‰ä»·äºå°† i+m ä¸ªè‹¹æœåˆ†ç»™ m ä¸ªäººï¼Œæ¯äººè‡³å°‘åˆ†å¾— 1 ä¸ªè‹¹æœã€‚ï¼ˆåˆ†å®Œä»¥åæ¯ä¸ªäººéƒ½è¿˜å›å»å°±è¡Œäº†ï¼‰ï¼Œæ­¤æ—¶çš„éš”æ¿æ“ä½œå°±æ˜¯â€æ ‡å‡†å‹â€ï¼Œå³ i+m ä¸ªè‹¹æœäº§ç”Ÿ i+m-1 ä¸ªé—´éš”ï¼Œåœ¨å…¶ä¸­æ’ m-1 å—æ¿ï¼Œä»è€Œå°†åˆ’åˆ†å‡ºæ¥çš„ m ä¸ªéƒ¨åˆ†åˆ†ç»™ m ä¸ªäººã€‚æ­¤æ—¶çš„åˆ’åˆ†æ–¹æ¡ˆå°±æ˜¯ $C_{i+m-1}^{m-1}$ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰çš„ iï¼Œç»“æœå°±æ˜¯
>
>     $$
>     \begin{aligned}
>     \sum_{i = 1}^n C_{i+m-1}^{m-1} &= C_{m}^{m-1} + C_{m+1}^{m-1} + \cdots + C_{n+m-1}^{m-1} \\
>     &= C_{m}^{1} + C_{m+1}^{2} + \cdots + C_{n+m-1}^{n} \\
>     &= (-C_{m}^{0}+C_{m}^{0})+C_{m}^{1} + C_{m+1}^{2} + \cdots + C_{n+m-1}^{n} \\
>     &= -C_{m}^{0}+(C_{m}^{0}+C_{m}^{1} + C_{m+1}^{2} + \cdots + C_{n+m-1}^{n}) \\
>     &= -1+(C_{m+1}^{1} + C_{m+1}^{2} + \cdots + C_{n+m-1}^{n}) \\
>     &= -1+(C_{m+2}^{2} + \cdots + C_{n+m-1}^{n}) \\
>     &= -1+C_{n+m}^n
>     \end{aligned}
>     $$
>
> - åˆ©ç”¨ **ä¹˜æ³•é€†å…ƒ** è®¡ç®—ç»„åˆæ•°ã€‚ç»“æœå·²ç»çŸ¥é“äº†ï¼Œç°åœ¨å¦‚ä½•è®¡ç®—ä¸Šè¿°è¡¨è¾¾å¼å‘¢ï¼Ÿç”±äº $n\times m$ è¶…è¿‡äº†å¸¸è§„é€’æ¨çš„ç»„åˆæ•°è®¡ç®—æ–¹æ³•å†…å­˜ç©ºé—´ï¼Œå› æ­¤æˆ‘ä»¬é‡‡ç”¨ä¹˜æ³•é€†å…ƒçš„æ€è·¯è®¡ç®—ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæœ¬é¢˜åœ¨è®¡ç®—æŸä¸ªæ•°å…³äº `1e6+3` çš„ä¹˜æ³•é€†å…ƒæ—¶ï¼Œä¸éœ€è¦åˆ¤æ–­ä¸¤è€…æ˜¯å¦äº’è´¨ï¼Œå› ä¸º `1e6+3` æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œå¹¶ä¸”æ•°æ®èŒƒå›´ä¸­çš„æ•°å‡å°äº `1e6+3`ï¼Œå› æ­¤ä¸¤æ•°ä¸€å®šäº’è´¨ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è´¹é©¬å°å®šç†è®¡ç®—ä¹˜æ³•é€†å…ƒ
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n\log 1e6)$

```cpp
#include <iostream>
using namespace std;
using ll = long long;

const int N = 7e5 + 10;
const int mod = 1e6 + 3;

int fact[N], infact[N];

int qmi(int a, int b, int p) {
    int res = 1 % p;
    while (b) {
        if (b & 1) res = (ll)res * a % p;
        a = (ll)a * a % p;
        b >>= 1;
    }
    return res;
}

void init() {
    fact[0] = 1, infact[0] = 1;
    for (int i = 1; i < N; i++) {
        fact[i] = (ll)fact[i - 1] * i % mod;
        infact[i] = (ll)infact[i - 1] * qmi(i, mod - 2, mod) % mod;
    }
}

int main() {
    init();
    
    int n, m;
    cin >> n >> m;
    
    cout << (ll)fact[n + m] * infact[n] % mod * infact[m] % mod - 1;
    
    return 0;
}
```

## æ€ç»´é¢˜

æ€ç»´é¢˜çš„ã€Œä¾‹é¢˜è§£æã€ã€‚

å›¾çš„éå†

<https://www.luogu.com.cn/problem/P3916>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæœ‰å‘å›¾ï¼Œæ±‚è§£æ¯ä¸€ä¸ªç‚¹å¯ä»¥åˆ°è¾¾çš„ç¼–å·æœ€å¤§çš„ç‚¹
>
> æ€è·¯ï¼šå¦‚æœä»æ­£å‘è€ƒè™‘ï¼Œå¾ˆæ˜¾ç„¶çš„ä¸€ä¸ªæš´åŠ›æ–¹æ³•å°±æ˜¯å¯¹äºæ¯ä¸€ä¸ªç‚¹éƒ½è·‘ä¸€é dfs æˆ–è€… bfs è·å–å¯è¾¾çš„æœ€å¤§ç‚¹ç¼–å·ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^2)$ï¼Œå¦‚æœæƒ³è¦åœ¨éå†çš„è¿‡ç¨‹ä¸­åŒæ—¶æ›´æ–°å…¶ä½™çš„ç‚¹ï¼Œé‚£åªæœ‰èµ·ç‚¹åˆ°æœ€å¤§ç‚¹ä¹‹é—´çš„ç‚¹å¯ä»¥è¢«æ›´æ–°ï¼Œå¯ä»¥é€šè¿‡é€’å½’æ—¶è®°å½•è·¯å¾„ç‚¹è¿›è¡Œï¼Œæ—¶é—´å¤æ‚åº¦å‡ ä¹ä¸å˜ã€‚æˆ‘ä»¬å°è¯•åå‘è€ƒè™‘ï¼š**åå‘å»ºè¾¹**ã€‚æ—¢ç„¶æ­£å‘è€ƒè™‘æ—¶éœ€è¦æ ‡è®°çš„ç‚¹ä¸ºæœ€å¤§ç‚¹ä¸èµ·ç‚¹çš„è·¯å¾„ï¼Œé‚£ä¸å¦‚ç›´æ¥ä»æœ€å¤§å€¼ç‚¹å¼€å§‹éå†æœç´¢ï¼Œåœ¨å°†æ‰€æœ‰çš„è¾¹å…¨éƒ¨åå‘ä»¥åï¼Œä»æœ€å¤§å€¼ç‚¹å¼€å§‹éå†å›¾ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨çº¿æ€§æ—¶é—´å¤æ‚åº¦å†…è§£å†³é—®é¢˜
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n+m)$

bfs ä»£ç 

```cpp
#include <iostream>
#include <queue>
#include <cstring>
#include <vector>
using namespace std;

const int N = 100010;

int n, m;
vector<int> g[N], res(N);

void bfs(int now) {
    queue<int> q;

    res[now] = now;
    q.push(now);
    
    while (q.size()) {
        int h = q.front();
        q.pop();
        for (auto& ch: g[h]) {
            if (!res[ch]) {
                res[ch] = now;
                q.push(ch);
            }
        }
    }
}

void solve() {
    cin >> n >> m;
    while (m--) {
        int a, b;
        cin >> a >> b;
        g[b].push_back(a);
    }

    for (int i = n; i >= 1; i--) {
        if (!res[i]) {
            bfs(i);
        }
    }
    
    for (int i = 1; i <= n; i++) {
        cout << res[i] << ' ';
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

dfs ä»£ç 

```cpp
#include <iostream>
#include <queue>
#include <cstring>
#include <vector>
using namespace std;

const int N = 100010;

int n, m, val;
vector<int> g[N], res(N);

void dfs(int now) {
    res[now] = val;
    for (auto& ch: g[now]) {
        if (!res[ch]) {
            dfs(ch);
        }
    }
}

void solve() {
    cin >> n >> m;
    while (m--) {
        int a, b;
        cin >> a >> b;
        g[b].push_back(a);
    }

    for (int i = n; i >= 1; i--) {
        if (!res[i]) {
            val = i;
            dfs(i);
        }
    }
    
    for (int i = 1; i <= n; i++) {
        cout << res[i] << ' ';
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

æœ€é•¿ä¸¥æ ¼é€’å¢å­åºåˆ—

<https://www.acwing.com/problem/content/5273/>

> æ ‡ç­¾ï¼šæ€ç»´ã€å“ˆå¸Œã€æ’åº
>
> é¢˜æ„ï¼šç»™å®šé•¿åº¦ä¸º n çš„åºåˆ—ï¼Œé—®å°†è¿™ä¸ªåºåˆ—æ‹¼æ¥ n æ¬¡åï¼Œæœ€é•¿ä¸¥æ ¼é€’å¢å­åºåˆ—çš„é•¿åº¦ä¸ºå¤šå°‘ï¼Ÿ
>
> æ€è·¯ï¼šå…¶å®æœ€ç»ˆçš„æ€è·¯å¾ˆç®€å•ï¼Œå°†é¢˜ç›®è½¬åŒ–ä¸ºåœ¨æ¯ä¸ªåºåˆ—ä¸­é€‰ä¸€ä¸ªæ•°ï¼Œä¸€å…±å¯ä»¥é€‰å‡ºå¤šå°‘ä¸ªä¸åŒçš„æ•°ã€‚ä½†æ˜¯åœ¨äº§ç”Ÿè¿™æ ·çš„æƒ³æ³•ä¹‹å‰ï¼Œå…ˆè®²ä¸€ä¸‹æˆ‘çš„æ€è€ƒè¿‡ç¨‹ã€‚æˆ‘å°†åºåˆ—è„‘è¡¥å‡ºä¸€å¹…æ•£ç‚¹æŠ˜çº¿å›¾ï¼Œç„¶åå°†è¿™äº›ç‚¹æŠ•å½±åˆ° y è½´ä¸Šï¼Œæœ€ç»ˆæŠ•å½±ç‚¹çš„ä¸ªæ•°å°±æ˜¯ç­”æ¡ˆçš„æ•°é‡ï¼Œä½†æ˜¯æŠ•å½±ä¼šæœ‰é‡åˆï¼Œå› æ­¤ç­”æ¡ˆæœ€å¤šå°±æ˜¯ n ä¸ªæ•°ï¼Œæœ€å°‘ 1 ä¸ªæ•°ï¼Œä»è€Œæƒ³åˆ°å°±æ˜¯åœ¨ n ä¸ªåºåˆ—ä¸­é€‰æ•°ï¼Œé€‰çš„æ•°ä¾æ¬¡å¢å¤§å³å¯ï¼Œç›¸åº”çš„å°±æ˜¯ä¸€ä¸ªæ±‚åºåˆ—ä¸é‡å¤æ•°çš„ä¸ªæ•°çš„è¿‡ç¨‹ã€‚å»é‡å³å¯ã€‚
>
> æ³¨æ„ç‚¹ï¼šç”±äº C++ çš„ STL çš„ unique å‡½æ•°çš„å‰ææ˜¯ä¸€ä¸ªæœ‰åºçš„åºåˆ—ï¼Œå› æ­¤åœ¨ unique ä¹‹å‰éœ€è¦å°†åºåˆ—è¿›è¡Œæ’åºã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
#include <bits/stdc++.h>
using namespace std;

int main()
{
    int T;
    cin >> T;

    while (T--)
    {
        int n;
        cin >> n;

        vector<int> a;
        for (int i = 0; i < n; i++)
        {
            int x;
            cin >> x;
            a.emplace_back(x);
        }

        sort(a.begin(), a.end());
        a.erase(unique(a.begin(), a.end()), a.end());

        cout << a.size() << endl;
    }

    return 0;
}
```

ä¸‰å…ƒç»„

<https://www.acwing.com/problem/content/5280/>

> æ ‡ç­¾ï¼šåˆ†è®¨ã€ç»„åˆæ•°å­¦
>
> é¢˜æ„ï¼šåœ¨ä¸€ä¸ªåºåˆ—ä¸­å¦‚ä½•é€‰æ‹©ä¸€ä¸ªä¸‰å…ƒç»„ï¼Œä½¿å¾—ä¸‰ä¸ªæ•°ä¹‹ç§¯æœ€å°ï¼Œç»™å‡ºæƒ…å†µæ•°
>
> æ€è·¯ï¼šé¦–å…ˆå¾ˆå®¹æ˜“å¾—çŸ¥ï¼Œè¿™ä¸‰ä¸ªæ•°ä¸€å®šæ˜¯åºåˆ—æ’åºåçš„å‰ä¸‰ä¸ªæ•°ï¼Œé‚£ä¹ˆå°±æ˜¯å¯¹è¿™ä¸‰ä¸ªæ•°å¯èƒ½çš„æƒ…å†µè¿›è¡Œè®¨è®º
>
> - æƒ…å†µ 1ï¼š**å‰ä¸‰ä¸ªæ•°éƒ½ç›¸ç­‰** `ï¼ˆ2 2 2 2 2 4 5ï¼‰`ï¼Œåˆ™å°±æ˜¯åœ¨æ‰€æœ‰çš„ `a[0]` ä¸­é€‰ 3 ä¸ªï¼Œæƒ…å†µæ•°å°±æ˜¯ $C_{cnt\_a[0]}^{3}$
> - æƒ…å†µ 2ï¼š**å‰ä¸‰ä¸ªæ•°ä¸­æœ‰ä¸¤ä¸ªæ•°ç›¸ç­‰**ï¼Œç”±äºæ•°ç»„ç»è¿‡äº†æ’åºï¼Œå› æ­¤æƒ…å†µ 2 åˆ†ä¸ºä¸¤ç§æƒ…å†µ
>     - å‰ä¸¤ä¸ªæ•°ç›¸ç­‰ `ï¼ˆ1 1 3 3 3 5ï¼‰`ï¼Œåˆ™å°±æ˜¯åœ¨æ‰€æœ‰çš„ `a[2]` ä¸­é€‰ 1 ä¸ªï¼Œæƒ…å†µæ•°å°±æ˜¯ $C_{cnt\_a[2]}^{1}$
>     - åä¸¤ä¸ªæ•°ç›¸ç­‰ `ï¼ˆ1 2 2 2 4 6ï¼‰`ï¼Œåˆ™å°±æ˜¯åœ¨æ‰€æœ‰çš„ `a[1]` ä¸­é€‰ 2 ä¸ªï¼Œæƒ…å†µæ•°å°±æ˜¯ $C_{cnt\_a[1]}^{2}$
> - æƒ…å†µ 3ï¼š**å‰ä¸‰ä¸ªæ•°ä¸­å…¨éƒ½ä¸ç›¸ç­‰** `ï¼ˆ1 2 4 4 4 5 7ï¼‰`ï¼Œè¿™å°±æ˜¯åœ¨æ‰€æœ‰çš„ `a[2]` ä¸­é€‰ 1 ä¸ªï¼Œæƒ…å†µæ•°å°±æ˜¯ $C_{cnt\_a[2]}^{1}$
>
> å¯ä»¥å‘ç°ä¸Šè¿°æƒ…å†µ 2 çš„ç¬¬ä¸€ç§å’Œæƒ…å†µ 3 çš„ç­”æ¡ˆç›¸ç­‰ï¼Œæ•…åˆ†ä¸ºä¸‰ç§æƒ…å†µå³å¯ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;

typedef long long ll;

// è®¡ç®—ç»„åˆæ•° C_{a}^{b}
ll calc(ll a, ll b) {
    ll fz = 1, fm = 1;
    for (int i = 0, num = a; i < b; i++, num--) {
        fz *= num;
    }
    for (int i = 1; i <= b; i++) {
        fm *= i;
    }
    return fz / fm;
}

int main() {
    int n; cin >> n;
    vector<int> a(n);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }
    
    sort(a.begin(), a.begin() + n);
    
    ll res = 0;
    
    if (a[0] == a[1] && a[1] == a[2]) {
        // æƒ…å†µ1ï¼šå‰ä¸‰ä¸ªæ•°éƒ½ç›¸ç­‰ï¼ˆ2 2 2 2 2 4 5ï¼‰ï¼Œåˆ™å°±æ˜¯åœ¨æ‰€æœ‰çš„a[0]ä¸­é€‰3ä¸ª
        ll cnt = count(a.begin(), a.begin() + n, a[0]);
        res = calc(cnt, 3);
    } else if (a[0] == a[1] || (a[0] != a[1] && a[1] != a[2])) {
        // æƒ…å†µ2ï¼šå‰ä¸¤ä¸ªæ•°ç›¸ç­‰ï¼ˆ1 1 3 3 3 4 5ï¼‰ or ä¸‰ä¸ªæ•°éƒ½ä¸ç›¸ç­‰ï¼ˆ1 2 4 4 4 5 7ï¼‰ï¼Œåˆ™å°±æ˜¯åœ¨æ‰€æœ‰çš„a[2]ä¸­é€‰2ä¸ª
        res = count(a.begin(), a.begin() + n, a[2]);
    } else {
        // æƒ…å†µ3ï¼šåä¸¤ä¸ªæ•°ç›¸ç­‰ï¼ˆ1 2 2 2 4 6ï¼‰ï¼Œåˆ™å°±æ˜¯åœ¨æ‰€æœ‰çš„a[1]ä¸­é€‰2ä¸ª
        ll cnt = count(a.begin(), a.begin() + n, a[1]);
        res = calc(cnt, 2);
    }
    
    cout << res << "\n";
    
    return 0;
}
```

åˆ é™¤å…ƒç´ 

<https://www.acwing.com/problem/content/5281/>

> æ ‡ç­¾ï¼šåˆ†è®¨
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ’åˆ—ä¸º 1~nï¼Œå®šä¹‰ä¸€ä¸ªæ•°â€œæœ‰ä»·å€¼â€ä¸ºå½“å‰æ•°çš„å‰é¢æ²¡æœ‰æ•°æ¯”å½“å‰çš„æ•°å¤§ã€‚ç°åœ¨éœ€è¦åˆ é™¤ä¸€ä¸ªæ•°ï¼Œä½¿å¾—åºåˆ—ä¸­å¢åŠ å°½å¯èƒ½å¤šçš„â€œæœ‰ä»·å€¼â€çš„æ•°ï¼Œå¦‚æœè¿™ä¸ªæ•°æœ‰å¤šä¸ªï¼Œåˆ™åˆ é™¤æœ€å°çš„é‚£ä¸ªæ•°
>
> æœ€å¼€å§‹æƒ³åˆ°çš„æ€è·¯ï¼šæšä¸¾æ¯ä¸€ä¸ªæ•°ï¼Œå¦‚æœåˆ é™¤ï¼Œåˆ™åºåˆ—ä¸­ä¼šå¢åŠ å¤šå°‘ä¸ªâ€œæœ‰ä»·å€¼â€çš„æ•°ï¼Œç®—æ³•è®¾è®¡å¦‚ä¸‹ï¼š
>
> 1. é¦–å…ˆåˆ¤æ–­æ¯ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯æœ‰ä»·å€¼çš„æ•°
>     - åˆ›å»ºä¸€ä¸ªå˜é‡æ¥è®°å½•å½“å‰æ•°çš„å‰é¢åºåˆ—çš„æœ€å¤§å€¼
>     - æ¯”è¾ƒåˆ¤æ–­å½“å‰æ•°å’Œå‰æ–¹æœ€å¤§å€¼çš„å…³ç³»ï¼Œå¦‚æœå°äºï¼Œåˆ™æ— ä»·å€¼ï¼Œåä¹‹æœ‰ä»·å€¼
> 2. æ¥ç€æšä¸¾æ¯ä¸€ä¸ªæ•°ï¼Œå¦‚æœåˆ é™¤è¯¥æ•°ï¼Œåˆ™åºåˆ—ä¼šæŸå¤±å¤šå°‘ä¸ªæœ‰ä»·å€¼çš„æ•°
>     - é¦–å…ˆåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯æœ‰ä»·å€¼çš„æ•°ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å½“å‰æŸå¤±å€¼ -1
>     - æ¥ç€åˆ¤æ–­åˆ é™¤å½“å‰æ•°å¯¹åç»­çš„å½±å“ :star: ï¼šæˆ‘ä»¬åœ¨æšä¸¾åç»­æ•°çš„æ—¶å€™ï¼Œèµ·å§‹çš„ newdï¼ˆå‰é©±é™¤æ‰ a [i] çš„æœ€å¤§å€¼ï¼‰åº”è¯¥å°±æ˜¯å½“å‰çš„ dï¼Œåªä¸è¿‡éœ€è¦ä½¿ç”¨æ–°å˜é‡ newd è€Œé d æ˜¯å› ä¸ºè¿™ä¸€æ­¥ä¸æ•´ä½“æ— å…³ï¼Œä¸å¯ä»¥æ”¹å˜æ•´ä½“çš„ dã€‚å¦åˆ™ä¼šå‡ºç°é”™è¯¯ï¼Œæ¯”å¦‚å¯¹äº `4 3 5 1 2`ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æšä¸¾åç»­æ•°çš„æ—¶å€™ç›´æ¥å¯¹ d è¿›è¡Œè¿­ä»£ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€è½® d å°±ä¼šè¢«æ›´æ–°ä¸º 5ï¼Œå°±å†ä¹Ÿæ— æ³•æ›´æ–°äº†
> 3. æœ€ç»ˆæ ¹æ®ç»´æŠ¤çš„æŸå¤±å€¼æ•°ç»„ cnt å³å¯æ±‚è§£
> 4. æ—¶é—´å¤æ‚åº¦ $O(n^2)$
>
> ä¼˜åŒ–çš„æ€è·¯ï¼š
>
> 1. åŒæ ·æ˜¯æšä¸¾æ¯ä¸€ä¸ªæ•°ï¼Œå¦‚æœå½“å‰æ•°å­—æ˜¯æœ‰ä»·å€¼çš„æ•°ï¼Œé‚£ä¹ˆ cnt [a[i]]å°± -1
>
>     - å–å†³äºå½“å‰æ•°å­—å‰é¢æ˜¯å¦æœ‰æ¯”å®ƒå¤§çš„æ•°ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆå°±æ˜¯æœ‰ä»·å€¼çš„
>
> 2. æ¥ä¸‹æ¥æˆ‘ä»¬ä¸éœ€è¦éå† j = i+1 åˆ° j = n-1ï¼Œè€Œæ˜¯è®¨è®ºå½“å‰æ•° a [i] ä¸æ˜¯æœ‰ä»·å€¼æ•°æ—¶çš„æ‰€æœ‰æƒ…å†µã€‚ç°åœ¨æˆ‘ä»¬æƒ³è¦ç»´æŠ¤ cnt æ•°ç»„ã€‚ä¸éš¾å‘ç°ï¼Œå¯¹äºæŸä¸ªä½ç½®ä¸Šçš„æ•° a [k]ï¼Œèƒ½å¦æˆä¸ºæœ‰ä»·å€¼çš„æ•°åªå–å†³äºå‰æ’åºåˆ—æ˜¯å¦æœ‰æ¯”ä»–å¤§çš„æ•°ä»¥åŠå¤§çš„æ•°çš„ä¸ªæ•°ã€‚é‚£ä¹ˆç†è®ºä¸Šæˆ‘ä»¬åœ¨æšä¸¾ a [i] çš„æ—¶å€™ç»´æŠ¤ cnt [1~i-1] å°±å¯ä»¥ç¡®ä¿ cnt æ•°ç»„çš„æ­£ç¡®æ€§äº†ã€‚
>
>     - å‡è®¾ a [k] çš„å‰æ’æœ‰ä¸€ä¸ªæ¯”å®ƒå¤§çš„æ•° dï¼šé‚£ä¹ˆæŠŠ d å»æ‰ä¹‹åï¼Œa [k] å°±ä¼šä»æ— ä»·å€¼å˜ä¸ºæœ‰ä»·å€¼
>    - å‡è®¾ a [k] çš„å‰æ’æœ‰è‡³å°‘ä¸¤ä¸ªæ¯”å®ƒå¤§çš„æ•° d1, d2,...dj...ï¼šé‚£ä¹ˆä¸ç®¡å»æ‰å“ªä¸€ä¸ª $d_j$ï¼Œæˆ‘ä»¬éƒ½æ²¡æ³•è®© a [k] å˜å¾—æœ‰ä»·å€¼
>
>     å¦‚æ­¤ä¸€æ¥ï¼Œcnt æ•°ç»„å°±å¯ä»¥æ­£ç¡®ç»´æŠ¤äº†
>
> 3. æœ€ç»ˆæ ¹æ®ç»´æŠ¤çš„æŸå¤±å€¼æ•°ç»„ cnt å³å¯æ±‚è§£
>
> 4. æ—¶é—´å¤æ‚åº¦ $O(n)$

æš´åŠ›ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    int n;
    cin >> n;
    
    vector<int> a(n);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }
    
    // åˆ¤æ–­æ¯ä¸ªæ•°æ˜¯å¦æ˜¯æœ‰ä»·å€¼çš„æ•°
    int d = 0; // å‰æ–¹åºåˆ—ä¸­çš„æœ€å¤§å€¼
    vector<bool> is_val(n + 1);
    for (int i = 0; i < n; i++) {
        if (a[i] > d) {
            is_val[a[i]] = true;
            d = a[i];
        }
    }
    
    // æšä¸¾æ¯ä¸€ä¸ªæ•°ï¼Œè®¡ç®—åˆ é™¤è¯¥æ•°ä¹‹åä¼šå¢åŠ çš„æœ‰ä»·å€¼çš„æ•°çš„ä¸ªæ•° 
    d = 0; // åŒä¸Š
    vector<int> cnt(n + 1); // cnt[x]è¡¨ç¤ºåˆ é™¤æ•°xä¹‹åå¯ä»¥å¢åŠ çš„æœ‰ä»·å€¼çš„æ•°çš„ä¸ªæ•°
    for (int i = 0; i < n; i++) {
        if (is_val[a[i]]) {
            cnt[a[i]]--;
        }
        
        int newd = d; // å»æ‰a[i]åçš„å‰æ–¹åºåˆ—çš„æœ€å¤§å€¼ newd
        for (int j = i + 1; j < n; j++) {
            if (is_val[a[j]]) {
                if (a[j] < newd) {
                    cnt[a[i]]--;
                }
            } else {
                if (a[j] > newd) {
                    cnt[a[i]]++;
                }
            }
            if (a[j] > newd) {
                newd = a[j];
            }
        }
        
        // æ›´æ–°å‰æ–¹åºåˆ—çš„æœ€å¤§å€¼ d
        if (a[i] > d) {
            d = a[i];
        }
    }

    // æ‰¾å‡ºå¯ä»¥å¢åŠ çš„æœ‰ä»·å€¼çš„æ•°çš„æœ€å¤§ä¸ªæ•° ma
    int ma = -n - 1;
    for (int i = 0; i < n; i++) {
        if (cnt[a[i]] > ma) {
            ma = max(ma, cnt[a[i]]);
        }
    }

    // ç­”æ¡ˆæ˜¯æ»¡è¶³ä¸ªæ•°çš„æœ€å°çš„æ•°å­—
    int res = 0;
    for (int i = 1; i <= n; i++) {
        if (cnt[i] == ma) {
            res = i;
            break;
        }
    }
    
    cout << res << "\n";
    
    return 0;
}
```

ä¼˜åŒ–ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    int n; 
    cin >> n;
    
    vector<int> a(n);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }
     
    vector<int> cnt(n + 1);     // cnt[x]è¡¨ç¤ºåˆ é™¤æ•°xä¹‹åå¯ä»¥å¢åŠ çš„æœ‰ä»·å€¼çš„æ•°çš„ä¸ªæ•°
    int d1 = 0, d2 = 0;         // d1: æœ€å¤§å€¼, d2: æ¬¡å¤§å€¼
    for (int i = 0; i < n; i++) {
        if (a[i] > d1) {
            // å‰æ–¹åºåˆ— æ²¡æœ‰æ•°æ¯”å½“å‰çš„æ•°å¤§
            cnt[a[i]]--;
        } else if (a[i] > d2) {
            // å‰æ–¹åºåˆ— åªæœ‰ä¸€ä¸ªæ•°æ¯”å½“å‰å¤§
            cnt[d1]++;
        }
        
        // æ›´æ–°æœ€å¤§å€¼d1å’Œæ¬¡å¤§å€¼d2
        if (a[i] > d1) d2 = d1, d1 = a[i];
        else if (a[i] > d2) d2 = a[i];
    }
    
    // æ‰¾åˆ°å¯ä»¥å¢åŠ çš„æœ€å¤§å€¼
    int ma = -1;
    for (int i = 1; i <= n; i++) {
        if (cnt[i] > ma) {
            ma = cnt[i];
        }
    }
    
    // å–å…ƒç´ çš„æœ€å°å€¼
    int res = n + 1;
    for (int i = 1; i <= n; i++) {
        if (cnt[i] == ma) {
            res = i;
            break;
        }
    }
    
    cout << res << "\n";
    
    return 0;
}
```

Sorting with Twos

<https://codeforces.com/contest/1891/problem/A>

> æ ‡ç­¾ï¼šæ„é€ 
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªåºåˆ—ï¼Œç°åœ¨éœ€è¦é€šè¿‡ä»¥ä¸‹æ–¹æ³•å¯¹åºåˆ—è¿›è¡Œå‡åºæ’åº
>
> - å¯ä»¥é€‰æ‹©å‰ $2^m$ ä¸ªæ•°æ‰§è¡Œ $-1$ çš„æ“ä½œï¼ˆä¿è¯ä¸ä¼šè¶Šç•Œçš„æƒ…å†µä¸‹ï¼‰
>
> ç°åœ¨éœ€è¦ç¡®å®šç»™å®šçš„åºåˆ—ç»è¿‡ k æ¬¡ä¸Šè¿°åèƒ½å¦å˜ä¸ºå‡åºåºåˆ—
>
> æ€è·¯ï¼šæˆ‘ä»¬å¯ä»¥å°†æ¯ $2^k$ ä¸ªæ•°çœ‹æˆä¸€ä¸ªæ•°ï¼Œå¯ä»¥ä¸æ–­çš„-1ã€‚é‚£ä¹ˆå¯ä»¥å‘ç°æ‰§è¡Œä¸€å®šçš„æ¬¡æ•°åï¼Œä¸€å®šå¯ä»¥å®ç°å‡åºåºåˆ—ã€‚ä½†æ˜¯ç°åœ¨æ˜¯ $2^k$ ä¸ªæ•°ï¼Œé‚£ä¹ˆåªéœ€è¦è¿™ç›¸é‚»åŒºæ®µçš„æ•°æ˜¯å‡åºå³å¯ï¼Œå³ $2^{k-1} \to 2^k$ ä¹‹é—´çš„æ•°æ˜¯å‡åºå³å¯ã€‚æŒ‰åŒºé—´è¿›è¡Œåˆ¤æ–­å³å¯
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
void judge(vector<int>& a, int l, int r, bool& ok, int n) {
    for (int i = l + 1; i <= r && i <= n; i++) {
        if (a[i] < a[i - 1]) {
            ok = false;
            return;
        }
    }
}
 
void solve() {
    int n;
    cin >> n;
 
    vector<int> a(n + 1);
    for (int i = 1; i <= n; i++) {
        cin >> a[i];
    }
 
    bool ok = true;
    judge(a, 3, 4, ok, n);
    judge(a, 5, 8, ok, n);
    judge(a, 9, 16, ok, n);
    judge(a, 17, 20, ok, n);
 
    if (ok) {
        cout << "YES\n";
    } else {
        cout << "NO\n";
    }
}
```

æŒ‡é’ˆè¿åŠ¨â€‹

<https://www.acwing.com/problem/content/description/5468>

> æ ‡ç­¾ï¼šæ¨¡æ‹Ÿ
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªåºåˆ—ï¼Œå’Œä¸€ä¸ªä»ç¬¬ä¸€ä¸ªæ•°å¼€å§‹çš„æŒ‡é’ˆï¼Œè‹¥å½“å‰æŒ‡çš„æ•°ä¸º 0 åˆ™è¾“å‡ºå½“å‰æ•°çš„ä¸‹æ ‡ç»“æŸç¨‹åºï¼Œè‹¥ä¸ä¸º 0 åˆ™å…¨ä½“æ­£æ•°å‡ä¸€å¹¶å°†æŒ‡é’ˆåç§»ï¼Œè‹¥æŒ‡é’ˆè¶Šç•Œåˆ™é‡æ–°æŒ‡å‘ç¬¬ä¸€ä¸ªæ•°ã€‚é—®æœ€ç»ˆæŒ‡å‘ç¬¬å‡ ä¸ªæ•°
>
> æ€è·¯ï¼š
> - ç¬¬ä¸€å±‚æ€è·¯ï¼šçº¯æš´åŠ›ã€‚å³æŒ‰ç…§é¢˜æ„è¿›è¡Œæ¨¡æ‹Ÿï¼Œæ—¶é—´å¤æ‚åº¦ $O(n \times \max (a_i))$
> - ç¬¬äºŒå±‚æ€è·¯ï¼šæšä¸¾ä¼˜åŒ–ã€‚å‡è®¾å½“å‰æšä¸¾åˆ°äº†ç¬¬ k æ¬¡ï¼Œè‹¥ç¬¬ä¸€æ¬¡é‡åˆ°å½“å‰çš„æ•°å°äº kï¼Œåˆ™è¯¥æ•°å°±æ˜¯ç»ˆæ­¢æŒ‡å‘çš„æ•°ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n \times \max(a_i))$
> - ç¬¬ä¸‰å±‚æ€è·¯ï¼šæ•°åˆ—ä¼˜åŒ–ã€‚

å¥—é¤è®¾è®¡

<https://www.acwing.com/problem/content/5480/>

> æ ‡ç­¾ï¼šå“ˆå¸Œ
>
> é¢˜æ„ï¼šç»™å®š n ä¸ªé£Ÿç‰©ï¼Œå…¶ä¸­å¯èƒ½æœ‰ç›¸åŒç§ç±»çš„ï¼Œç°åœ¨éœ€è¦è®¾è®¡ä¸€ä¸ªé£Ÿç‰©å¥—é¤åŒ…å« k ä¸ªé£Ÿç‰©ï¼Œé—®å¦‚ä½•è®¾è®¡å¥—é¤å¯ä»¥ä½¿å¾—äº§ç”Ÿçš„å¥—é¤æ•°æœ€å¤šï¼Œç»™å‡ºæœ€å¤šæ•°é‡çš„å¥—é¤æ•°
>
> æ€è·¯ï¼šå¦‚æœä¸é™å®šå¥—é¤ä¸­é£Ÿç‰©çš„ç§ç±»æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä»æœ€å¤šå¯ç”Ÿäº§çš„å¥—é¤æ•° $\left \lfloor \frac{n}{k} \right \rfloor$ å¼€å§‹é™åºæ£€æŸ¥ï¼Œç›´åˆ°ä¸€å¥—éƒ½æ— æ³•ç”Ÿäº§ä¸ºæ­¢ï¼ˆå³ä¸€å¥—éœ€è¦çš„é£Ÿç‰©æ•°è¶…è¿‡äº†æ€»çš„é£Ÿç‰©æ•°ï¼‰ã€‚æ£€æŸ¥çš„é€»è¾‘å¾ˆç®€å•ï¼Œæˆ‘ä»¬çŸ¥é“å¯¹äºå½“å‰çš„å¥—é¤æ•° $i$ï¼Œæ¯ä¸€ç§é£Ÿç‰©çš„æ•°é‡å¦‚æœè¶…è¿‡äº† $i$ï¼Œå°±è‡³å°‘å¯ä»¥å¯¹å¥—é¤è´¡çŒ® $1$ ä¸ªé£Ÿç‰©çš„æ•°é‡ã€‚æˆ‘ä»¬ç»Ÿè®¡å½“å‰éœ€è¦å¥—é¤æ•°çš„å±€é¢ä¸‹ï¼Œæ‰€æœ‰é£Ÿç‰©å¯ä»¥è´¡çŒ®çš„é£Ÿç‰©æ•°é‡ $cnt$ï¼Œå¦‚æœè¶…è¿‡äº†éœ€è¦çš„å¥—é¤æ•° $i$ï¼Œæ˜¾ç„¶æ˜¯å¯ä»¥æ»¡è¶³éœ€æ±‚çš„å¥—é¤æ•°çš„ã€‚ä¸ºäº†æ±‚å¾—æœ€å¤§çš„å¥—é¤æ•°ï¼Œä»é™åºå¼€å§‹æ£€æŸ¥ç›´åˆ°å¯ä»¥æ»¡è¶³å³å¯ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2)$

```cpp
#include <iostream>
#include <unordered_map>
using namespace std;
typedef long long ll;

const int N = 110;

int n, k, a[N];
unordered_map<int, int> v;

void solve() {
    cin >> k >> n;
    for (int i = 1; i <= n; i++) {
        cin >> a[i];
        v[a[i]]++;
    }
    
    int res = 0;
    
    int i; // å½“å‰éœ€è¦ç”Ÿäº§çš„å¥—é¤æ•°
    for (i = n / k; i >= 1; i--) {
        // æ‰€æœ‰é£Ÿç‰©å¯¹äºå½“å‰å¥—é¤éœ€è¦çš„é£Ÿç‰©æ•°é‡å¯ä»¥è´¡çŒ®çš„æœ€å¤§é£Ÿç‰©æ•°é‡
        int cnt = 0; 
        for (auto& x: v) {
            // æ¯ç§é£Ÿç‰©å¯¹äºå½“å‰å¥—é¤éœ€è¦çš„é£Ÿç‰©æ•°é‡å¯ä»¥è´¡çŒ®çš„æœ€å¤§é£Ÿç‰©æ•°é‡
            cnt += x.second / i;
        }
        if (cnt >= k) {
            res = i;
            break;
        }
    }
    
    cout << res << "\n";
}

int main() {
    ios::sync_with_stdio(false), cin.tie(0), cout.tie(0);
    int T = 1;
//    cin >> T;
    while(T--) solve();
    return 0;
}
```

åˆ†ç­

<https://www.acwing.com/problem/content/5481/>

> æ ‡ç­¾ï¼šè´ªå¿ƒã€åˆ†è®¨
>
> é¢˜æ„ï¼šç»™å®š $n \times k$ ä¸ªå­¦ç”Ÿï¼Œéœ€è¦å°†è¿™äº›å­¦ç”Ÿåˆ†æˆ $n$ ç»„ï¼Œæ¯ç»„ $k$ ä¸ªäººï¼Œç¬¬ $i$ ä¸ªå­¦ç”Ÿæœ‰ä¸€ä¸ªå±æ€§å€¼ $a_i$ ã€‚é—®å¦‚ä½•åˆ†ç»„å¯ä»¥ä½¿å¾—åœ¨æ»¡è¶³ä»»æ„ä¸¤ç»„å­¦ç”Ÿä¸­æœ€å°å€¼ç›¸å·®ä¸è¶…è¿‡ $lim$ çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ç»„æœ€å°å€¼ä¹‹å’Œæœ€å¤§ï¼Œç»™å‡ºè¿™ä¸ªæœ€å¤§å€¼
>
> æ€è·¯ï¼šä¸€å¼€å§‹è§‰å¾—æ˜¯äºŒåˆ†ç­”æ¡ˆï¼Œä½†æ˜¯ä¸çŸ¥é“åœ¨å·²çŸ¥ç­”æ¡ˆçš„æƒ…å†µä¸‹å¦‚ä½•æ£€æŸ¥ï¼Œå› ä¸ºæˆ‘ä¸çŸ¥é“åº”è¯¥å¦‚ä½•åˆ†ç»„æœ€ä¼˜ï¼Œæœªé‚ã€‚é‡è¯»é¢˜ç›®å‘ç°é¢˜ä¸­çš„ lim çº¦æŸä¸æ˜¯ç›¸é‚»ä¸¤ç»„ï¼Œè€Œæ˜¯ä»»æ„ä¸¤ç»„ï¼Œæ€è·¯æ‰“å¼€ï¼Œé‚£æˆ‘ç›´æ¥æ ¹æ®è¿™ä¸ªæ¡ä»¶å°†æ»¡è¶³çº¦æŸçš„æ‰€æœ‰å­¦ç”Ÿæšä¸¾å‡ºæ¥ï¼ˆå¾ˆæ˜¾ç„¶æ˜¯ç›¸å¯¹äºæ•°å€¼æœ€å°çš„å­¦ç”Ÿè€Œè¨€ï¼‰ï¼Œç„¶åè®¾è®¡å¦‚ä½•å°†è¿™äº›å­¦ç”Ÿå®‰æ’åˆ° n ç»„ä¸”ä¿è¯ä»–ä»¬æ˜¯ç»„é‡Œæœ€å°çš„å³å¯ã€‚å…ˆçœ‹ä¸‹é¢çš„å­¦ç”Ÿç¼–å· - å­¦ç”Ÿå±æ€§ç¤ºæ„å›¾ï¼š
>
> ![å­¦ç”Ÿç¼–å· - å­¦ç”Ÿå±æ€§ç¤ºæ„å›¾](https://cdn.dwj601.cn/images/202403030040949.png)
>
> å¾ˆæ˜¾ç„¶æˆ‘ä»¬éœ€è¦å°†è¿™ $n \times k$ ä¸ªå­¦ç”ŸæŒ‰æ•°å€¼å‡åºæ’åºï¼Œä¸ºäº†æ»¡è¶³ä»»æ„ä¸¤ç»„çš„æœ€å°å€¼ä¸è¶…è¿‡ $lim$ï¼Œæˆ‘ä»¬æ‰¾åˆ°å‰ $r$ ä¸ªå­¦ç”Ÿæ»¡è¶³æ¯”æœ€å°çš„å­¦ç”Ÿè¶…è¿‡çš„æ•°ä¸è¶…è¿‡ $lim$ å³å¯ã€‚æ¥ä¸‹æ¥å°±æ˜¯ä»è¿™ $r$ ä¸ªå­¦ç”Ÿä¸­é€‰æ‹©å‡º $n$ ä¸ªå®‰æ’åˆ° $n$ ä¸ªç»„ä¸­ï¼Œå³å¯æ»¡è¶³é¢˜ä¸­ $lim$ çš„é™åˆ¶ï¼Œç°åœ¨å°±æ˜¯è€ƒè™‘å¦‚ä½•åˆ†ç»„å¯ä»¥ä½¿å¾—ç­”æ¡ˆæœ€å¤§äº†ã€‚ä¸éš¾å‘ç°ä¸€å…±æœ‰ä¸‰ç§æƒ…å†µ
>
> - $r<n$ ï¼šå³å¯é€‰æ‹©äººæ•°éƒ½æ²¡æœ‰ç»„æ•°å¤šã€‚é‚£ä¹ˆåˆ†å®Œç»„ä»¥åè‚¯å®šæ— æ³•æ»¡è¶³ä»»æ„ä¸¤ç»„çš„æœ€å°å€¼ä¸è¶…è¿‡ $lim$ï¼Œç›´æ¥è¾“å‡º $0$ å³å¯
> - $r=n$ ï¼šå³å¯é€‰æ‹©äººæ•°å’Œç»„æ•°ç›¸ç­‰ã€‚è¿™ç§æƒ…å†µæœ€å¥½ç†è§£ï¼Œå°±æ˜¯å°†è¿™ $r(n)$ ä¸ªäººå®‰æ’åˆ° $n$ ç»„ï¼Œç­”æ¡ˆå°±æ˜¯è¿™ $r(n)$ ä¸ªäººæ•°å€¼ä¹‹å’Œ
> - $r>n$ ï¼šå³å¯é€‰æ‹©äººæ•°å¤šäºç»„æ•°ã€‚å¦‚æœçº¯ç²¹çš„è´ªå¿ƒï¼Œå°†ç¬¬ä¸€ä¸ªäººæ”¾åœ¨ç¬¬ä¸€ç»„ï¼Œç„¶åä»ç¬¬ $r$ ä¸ªäººå¼€å§‹å°† $n-1$ ä¸ªäººå®‰æ’åœ¨å‰©ä½™çš„ $n-1$ ç»„ã€‚è¿™æ ·çš„ç¡®å¯ä»¥æ»¡è¶³ç­”æ¡ˆæœ€å¤§ï¼Œä½†æ˜¯å¿½ç•¥äº†ä¸€ä¸ªç‚¹å°±æ˜¯ä»ç¬¬ $2$ ä¸ªäººå¼€å§‹çš„ $r-n$ ä¸ªäººä½•å»ä½•ä»ï¼Ÿå¦‚æœå…¨éƒ¨å®‰æ’åˆ°äº†ç¬¬ä¸€ç»„é‚£ä¸‡äº‹å¤§å‰ï¼Œå¦‚æœç¬¬ä¸€ç»„å¡ä¸è¿›å»å°±ä¸å¾—ä¸å®‰æ’åˆ°åˆ«çš„ç»„ï¼Œè¿™æ ·ç­”æ¡ˆå°±ä¸æ˜¯ä¸Šé¢è®¡ç®—çš„ç»“æœäº†ï¼Œåº”è¯¥æ›´å°æ‰å¯¹ï¼é‚£ä¹ˆåº”è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä»å¾€ç¬¬ä¸€ç»„å¡å‰©ä½™çš„äººå¾—åˆ°å¯å‘ï¼šå¦‚æœç¬¬ä¸€ç»„å¯ä»¥å®¹çº³å‰©ä½™çš„äººæ´»ç€è¿˜æœ‰ç©ºä½å°±å·²ç»æ»¡è¶³äº†ç¬¬äºŒç§æƒ…å†µï¼Œå°±å¯ä»¥ç›´æ¥è®¡ç®—ç»“æœï¼Œå¦‚æœç¬¬ä¸€ç»„æ— æ³•å®¹çº³ä»ç¬¬ $2$ ä¸ªäººå¼€å§‹çš„ $r-n$ ä¸ªäººï¼Œå°±å°†ç¬¬ $1+k$ ä¸ªäººä½œä¸ºä¸€ç»„çš„æœ€å°å€¼ï¼Œç»§ç»­è´ªå¿ƒçš„å®¹çº³ç´§è·Ÿç€çš„äººï¼Œä»è€Œç¡®ä¿å‰©ä¸‹çš„äººæ•°å€¼å°½å¯èƒ½çš„å¤§ã€‚å¦‚æ­¤å¾ªç¯çŸ¥é“å‡ºç° **å‰©ä½™çš„äººçš„æ•°é‡ = è¿˜æœªå®‰æ’æœ€å°å€¼çš„ç»„çš„æ•°é‡** ä¸ºæ­¢ï¼Œè®¡ç®—ç­”æ¡ˆæ€»å’Œå³å¯ï¼
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n \log n)$

```cpp
#include <iostream>
using namespace std;
typedef long long ll;

const int N = 1e5 + 10;

ll n, k, lim, a[N];

void solve() {
    cin >> n >> k >> lim;

    int num = n * k;

    for (int i = 1; i <= num; i++) cin >> a[i];

    sort(a + 1, a + num + 1);

    // æ‰¾åˆ°æœ€å¤§çš„æ»¡è¶³ lim é™åˆ¶çš„äººçš„ä¸‹æ ‡ r - çº¿æ€§æˆ–äºŒåˆ†å‡å¯
    int l = 1, r = num;
    while (l < r) {
        int mid = (l + r + 1) >> 1;
          if (a[mid] <= a[1] + lim) l = mid;
          else r = mid - 1;
    }

    ll res = 0;

    if (r < n) res = 0;
    else {
        res += a[1];
        int idx = 2;   // æŒ‡é’ˆ
        int in = 1;    // å·²å®‰æ’ä½œä¸ºç»„å†…æœ€å°å€¼çš„äººå‘˜æ•°
        int team = 1;  // å½“å‰ç»„å†…çš„äººå‘˜æ•°
        while (r - idx + 1 > n - in) { // å½“å¯é€‰æ‹©äººæ•°å¤šäºç»„æ•°æ—¶
            if (team < k) team++, idx++; // å¡å¾—ä¸‹å°±ç»§ç»­å¡
            else team = 1, res += a[idx], idx++, in++; // å¡ä¸ä¸‹å°±é‡å¼€ä¸€ç»„
        }
        for (int i = idx; i <= r; i++) {
            res += a[i];
        }
    }

    cout << res << "\n";
}

int main() {
    ios::sync_with_stdio(false), cin.tie(0), cout.tie(0);
    int T = 1;
//    cin >> T;
    while(T--) solve();
    return 0;
}
```

åŒç«¯é˜Ÿåˆ—

<https://www.acwing.com/problem/content/5484/>

> æ ‡ç­¾ï¼šè´ªå¿ƒã€åˆ†è®¨
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªåºåˆ—ï¼Œæ¯æ¬¡å¯ä»¥ä»åºåˆ—å¤´æˆ–å°¾å–å‡ºä¸€ä¸ªæ•°ï¼Œåœ¨æ»¡è¶³ï¼šæŒ‰å–å‡ºæ•°çš„é¡ºåºæ˜¯å‡åºåºåˆ—çš„æ¡ä»¶ä¸‹ï¼Œç»™å®šçš„åºåˆ—æœ€å¤šå¯ä»¥å–å‡ºå¤šå°‘æ•°ï¼Ÿ
>
> æ€è·¯ï¼šé¦–å…ˆå¾ˆå®¹æ˜“æƒ³åˆ°çš„å°±æ˜¯å“ªå¤´å°å–å“ªå¤´ï¼Œå› ä¸ºå–äº†è¾ƒå°è€…åè¾ƒå¤§è€…å¯ä»¥åç»­ç»§ç»­è¢«é€‰æ‹©ï¼Œåä¹‹åˆ™ä¸èƒ½ã€‚å½“ç„¶ï¼Œè¿˜éœ€è¦è€ƒè™‘çš„ä¸€ä¸ªç‚¹å°±æ˜¯å¦‚æœè¾ƒå°è€…ä¸ç¬¦åˆé¢˜æ„ï¼Œå³è¾ƒå°è€…æ¯”ä¸Šä¸€æ¬¡é€‰å‡ºæ¥çš„æ•°æ›´å°ä»è€Œæ— æ³•ç»„æˆä¸¥æ ¼å‡åºåºåˆ—æ—¶ï¼Œè¿˜æ˜¯å¾—è€ƒè™‘è¾ƒå¤§å€¼çš„é‚£ä¸€å¤´æ•°ã€‚æ¥ä¸‹æ¥è€ƒè™‘ç›¸ç­‰çš„æƒ…å†µï¼Œè‹¥ä¸¤å¤´æ•°å€¼ç›¸ç­‰ï¼Œé‚£ä¸€å®šåªèƒ½é€‰æ‹©ä¸€ç«¯ä¸”åç»­éƒ½åªèƒ½ä»é‚£ç«¯ç»§ç»­é€‰æ‹©ï¼Œæˆ‘ä»¬ç›´æ¥ä¸¤ç§æ–¹æ³•éƒ½è®¡ç®—ç»Ÿè®¡ä¸€éå¯é€‰æ‹©çš„æ•°çš„æ•°é‡ï¼Œå–è¾ƒå¤§è€…å³å¯
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
#include <iostream>
#include <queue>
#include <cstring>
#include <vector>
#include <unordered_map>
#include <algorithm>
#include <stack>
using namespace std;

const int N = 200010;

int n, a[N];

void solve() {
    cin >> n;
    for (int i = 1; i <= n; i++) cin >> a[i];
    
    int res = 0, top = -1, l = 1, r = n;
    while (l <= r) {
        // å·¦ç«¯æ˜¯è¾ƒå°å€¼
        if (a[l] < a[r]) {
            if (a[l] > top) {
                res++;
                top = a[l++];
            } else if (a[r] > top) {
                res++;
                top = a[r--];
            } else {
                break;
            }
        // å³ç«¯æ˜¯è¾ƒå°å€¼
        } else if (a[l] > a[r]) {
            if (a[r] > top) {
                res++;
                top = a[r--];
            } else if (a[l] > top) {
                res++;
                top = a[l++];
            } else {
                break;
            }
        // ä¸¤ç«¯æ•°å€¼ç›¸ç­‰
        } else { // a[l] == a[r]
            if (a[l] > top) {
                int lcnt = 1, rcnt = 1;
                for (int i = l + 1; i <= r; i++) {
                    if (a[i] > a[i - 1]) lcnt++;
                    else break;
                }
                for (int i = r - 1; i >= l; i--) {
                    if (a[i] > a[i + 1]) rcnt++;
                    else break;
                }
                res += max(lcnt, rcnt);
                break;
            } else {
                break;
            }
        }
    }

    cout << res;
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

ä½ è¯´çš„å¯¹ï¼Œä½†æ˜¯è¿™æ˜¯ç­¾åˆ° I

<https://hydro.ac/d/nnu_contest/p/P1201>

> é¢˜æ„ï¼šç»™å®šä¸¤ä¸ªå•è°ƒä¸å‡ä¸”åªå«æœ‰å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ï¼Œæ±‚è§£å…¶ä¸­æœ€é•¿å…¬å…±å­ä¸²é•¿åº¦
>
> æ€è·¯ï¼š
>
> - ä¸€çœ¼ dpï¼Ÿé”™è¯¯çš„ï¼Œé‚£æ—¶é—´å¤æ‚åº¦å°±æ˜¯ $O(n^2)$ï¼Œæ˜¾ç„¶ä¸å¯èƒ½ã€‚å¯ä»¥å‘ç°ä¸å¸¸è§„çš„æœ€é•¿å…¬å…±å­ä¸²çš„é¢˜ç›®ä¸åŒï¼Œæœ¬é¢˜ä¸­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å•è°ƒçš„ï¼Œè¿™ä¸ªæ€§è´¨ä¸€å®šå¾ˆæœ‰ç”¨ã€‚äº‹å®çš„ç¡®å¦‚æ­¤ã€‚
> - å¯¹äºå•è°ƒçš„ä¸¤ä¸ªå­—ç¬¦ä¸²è€Œè¨€ï¼Œå¦‚æœ **è¿ç»­çš„** å­—ç¬¦æ•°é‡ä¹‹å’Œç›¸ç­‰ï¼Œå³å¯¹äº $c_i,c_j$ ä¹‹é—´çš„æ‰€æœ‰çš„å­—ç¬¦å¯¹åº”çš„æ•°é‡éƒ½ç›¸ç­‰ $a[c_k]=b[c_k],(k=i+1,i+1, \cdots,j-1)$ï¼Œåˆ™è¯¥æ®µå­—ç¬¦ä¸²å°±ä¸€å®šæ˜¯å…¬å…±å­ä¸²ã€‚ç­”æ¡ˆå°±æ˜¯ $\displaystyle  \sum_{k=i+1}^{j-1}a[c_k]$ æˆ– $\displaystyle  \sum_{k=i+1}^{j-1}b[c_k]$ã€‚åœ¨æšä¸¾å­—ç¬¦æ—¶ï¼Œéœ€è¦ç‰¹åˆ¤ä¸€ä¸‹åªæœ‰ä¸€ç§å­—ç¬¦çš„æƒ…å†µã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$\Theta(n + 26^3)$

```cpp
#include <iostream>
#include <cstring>
#include <vector>
#include <queue>
#include <stack>
#include <algorithm>
#include <unordered_map>
#include <set>
using namespace std;

const int N = 26;

string s, t;
int a[N], b[N];

void solve() {
    cin >> s >> t;
    
    for (auto c: s) a[c - 'a']++;
    for (auto c: t) b[c - 'a']++;
    
    int res = -1;
    
    for (int i = 0; i < N; i++) {
        for (int j = i; j < N; j++) {
            if (j == i) res = max(res, min(a[i], b[j]));
            else {
                bool ok = true;
                int mid = 0;
                for (int k = i + 1; k <= j - 1; k++) {
                    if (a[k] != b[k]) ok = false;
                    mid += a[k];
                }
                
                if (ok) {
                    res = max(res, min(a[i], b[i]) + mid + min(a[j], b[j]));
                }
            }
        }
    }
    
    cout << res << "\n";
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);
    int T = 1;
//    cin >> T;
    while (T--) solve();
    return 0;
}
```

ä»åŒå€æ•°ç»„ä¸­è¿˜åŸåŸæ•°ç»„

<https://leetcode.cn/problems/find-original-array-from-doubled-array/description/>

> æ ‡ç­¾ï¼šè´ªå¿ƒ
>
> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªæ”¹å˜åæ•°ç»„ï¼Œé—®å…¶åŸå§‹æ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å®šä¹‰æ”¹å˜åæ•°ç»„ä¸ºåŸå§‹æ•°ç»„æ¯ä¸€ä¸ªå…ƒç´ ä¹˜ä»¥ 2 ä»¥ååŠ å…¥åŸå§‹æ•°ç»„ï¼Œå¹¶éšæœºæ‰“ä¹±å¾—åˆ°çš„æ•°ç»„
>
> æ€è·¯ï¼šç­”æ¡ˆä¸ä¸‹æ ‡æ— å…³ï¼Œæˆ‘ä»¬è€ƒè™‘å¯¹åŸå§‹æ•°ç»„å‡åºæ’åºã€‚åœ¨å“ˆå¸Œç»Ÿè®¡æ¯ä¸€ä¸ªå…ƒç´ å‡ºç°çš„é¢‘ç‡åï¼Œå¯ä»¥æšä¸¾æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœå½“å‰å…ƒç´ ä¸å½“å‰å…ƒç´ çš„äºŒå€éƒ½å­˜åœ¨ï¼Œåˆ™è¯´æ˜å½“å‰å…ƒç´ ä¸€å®šå­˜åœ¨äºåŸå§‹æ•°ç»„ä¸­ï¼Œæˆ‘ä»¬å°†å…¶åŠ å…¥ç­”æ¡ˆå¹¶å¯¹ä¸¤ä¸ªæ•°çš„é¢‘ç‡ç»Ÿè®¡å‡ä¸€ã€‚
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n\log n)$

```cpp
class Solution {
public:
    vector<int> findOriginalArray(vector<int>& changed) {
        vector<int> res;

        // å‰ªæï¼šåˆæ³•åŸå§‹æ•°ç»„ä¸€å®šæ˜¯å¶æ•°ä¸ª
        int n = changed.size();
        if (n & 1) return {};

        sort(changed.begin(), changed.end());
        unordered_map<int, int> cnt;
        for (int x: changed) cnt[x]++;

        for (int x: changed) {
            if (cnt[x] == 0) continue;

            cnt[x]--;
            if (cnt[x * 2]) {
                cnt[x * 2]--;
                res.push_back(x);
            }
            else {
                return {};
            }
        }

        return res;
    }
};
```

å¯è·å¾—çš„æœ€å¤§ç‚¹æ•°

<https://leetcode.cn/problems/maximum-points-you-can-obtain-from-cards/description/>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªåºåˆ—ï¼Œæ¯æ¬¡å¯ä»¥ä»å¤´æˆ–å°¾å–ä¸€ä¸ªå…ƒç´ å¹¶å¼¹å‡ºè¯¥å…ƒç´ ï¼Œé—®å¦‚ä½•å–æ•°å¯ä»¥ä½¿å¾—å–åˆ°çš„æ•°æ€»å’Œæœ€å¤§
>
> æ€è·¯ï¼š**å‰ç¼€å’Œã€åŒæŒ‡é’ˆ**ã€‚å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬é€‰åˆ°çš„æ•°çš„ç»„æˆä¸€å®šæ˜¯åŸæ•°ç»„çš„å¤´éƒ¨ä¸€éƒ¨åˆ†å’Œå°¾éƒ¨ä¸€éƒ¨åˆ†ï¼Œä»åé¢æ€è€ƒï¼Œå…¶å®å°±æ˜¯è®©ä¸­é—´ä¸€éƒ¨åˆ†çš„æ•°å€¼æ€»å’Œæœ€å°ï¼å› æ­¤æˆ‘ä»¬ç”¨å‰ç¼€å’Œè®°å½•ä¸€ä¸‹ç„¶ååŒæŒ‡é’ˆæšä¸¾åºåˆ—å³å¯ã€‚ä¹‹æ‰€ä»¥è®°å½•æœ¬åœ°æ˜¯å› ä¸ºåŒæŒ‡é’ˆå¥½ä¹…æ²¡å†™äº†ï¼Œè°ƒäº†å¥½ä¹… : (
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$

```cpp
class Solution {
public:
    int maxScore(vector<int>& cardPoints, int k) {
        int n = cardPoints.size();
        vector<int> s(n + 1, 0);
        for (int i = 1; i <= n; i++) {
            s[i] = s[i - 1] + cardPoints[i - 1];
        }

        int res = -1;
        int l = 1, r = l + n - k - 1;
        while (r <= n) {
            res = max(res, s[n] - (s[r] - s[l - 1]));
            l++, r++;
        }

        return res;
    }
};
```

ç¡®å®šä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ¥è¿‘

<https://leetcode.cn/problems/determine-if-two-strings-are-close/description/>

> é¢˜æ„ï¼šç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œä»»æ„æ¬¡ä¸‹é¢çš„æ“ä½œï¼šé—®åœ¨æ“ä½œåä½¿å¾—ä¸¤ä¸ªå­—ç¬¦ä¸²å®Œå…¨ç›¸ç­‰
>
> 1. äº¤æ¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä»»æ„ä¸¤ä¸ªå­—ç¬¦
> 2. äº¤æ¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä»»æ„ä¸¤ä¸ªç›¸åŒå­—ç¬¦çš„é›†åˆã€‚æ¯”å¦‚ $\underline {aa} c \underline{abb} \to \underline{bb}c\underline{baa}$
>
> æ€è·¯ï¼šä¸€é“çº¯çº¯æ€ç»´é¢˜ã€‚é¦–å…ˆå¯¹äºç¬¬ä¸€ä¸ªæ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²æ’åºå³å¯ï¼Œè‡³äºç¬¬äºŒä¸ªæ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ä¸¤ä¸ªå­—ç¬¦ä¸²å“ˆå¸Œå€¼ä¸­ï¼Œæ‰€æœ‰çš„é”®å…¨éƒ¨ç›¸ç­‰ï¼Œå³ä¸¤ä¸ªå­—ç¬¦ä¸²æ’åºå»é‡ååº”è¯¥å®Œå…¨ç›¸ç­‰ï¼ŒåŒæ—¶è¿˜éœ€è¦ç¡®ä¿ä¸¤ä¸ªå­—ç¬¦ä¸²å“ˆå¸Œçš„ç»“æœä¸­å€¼æ’åºçš„ç»“æœå®Œå…¨ç›¸ç­‰ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡æ“ä½œäºŒä½¿å¾—ä¸¤ä¸ªå­—ç¬¦ä¸²å®Œå…¨ç›¸ç­‰
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n \log n)$

```cpp
class Solution {
public:
    bool closeStrings(string word1, string word2) {
        // å‰ªæï¼šä¸¤ä¸ªå­—ç¬¦ä¸²é•¿åº¦ä¸ç›¸ç­‰ï¼Œåˆ™æ“ä½œåä¸€å®šä¸å¯èƒ½ç›¸ç­‰
        if (word1.size() != word2.size()) return false;

        // æ‰§è¡Œæ“ä½œ1
        sort(word1.begin(), word1.end());
        sort(word2.begin(), word2.end());
        
        // å‰ªæï¼šè‹¥ä¸¤ä¸ªå­—ç¬¦ä¸²æ’åºåç›¸ç­‰å°±ä¸éœ€è¦æ‰§è¡Œæ“ä½œ2äº†ï¼Œå·²ç»ç›¸ç­‰äº†
        if (word1 == word2) return true;

        // å“ˆå¸Œä¸¤ä¸ªå­—ç¬¦ä¸²çš„å­—ç¬¦ä¸å¯¹åº”å­—ç¬¦æ•°é‡
        unordered_map<char, int> a, b;
        for (auto& c: word1) a[c]++;
        for (auto& c: word2) b[c]++;
        
        // å‰ªæï¼šå­—ç¬¦ç§ç±»æ•°ä¸ä¸€æ ·ï¼Œåˆ™æ“ä½œ2åä¸€å®šä¸å¯èƒ½ç›¸ç­‰
        if (a.size() != b.size()) return false;
        
        // å‰ªæï¼šå­—ç¬¦ç§ç±»æ•°ä¸€æ ·ä½†æ˜¯ç§ç±»ä¸ä¸€æ ·ï¼Œåˆ™æ“ä½œ2åä¸€å®šä¸å¯èƒ½ç›¸ç­‰
        for (auto it: a) {
            if (b[it.first] == 0) {
                return false;
            }
        }
        
        // æ‰§è¡Œæ“ä½œ2ï¼šæ¯”è¾ƒæ‰€æœ‰ç§ç±»å­—ç¬¦çš„æ•°é‡
        vector<int> va, vb;
        for (auto& it: a) va.push_back(it.second);
        for (auto& it: b) vb.push_back(it.second);
        sort(va.begin(), va.end());
        sort(vb.begin(), vb.end());
        return va == vb;
    }
};
```

åŒä½å­—ç¬¦ä¸²è¿æ¥çš„æœ€å°é•¿åº¦

<https://leetcode.cn/problems/minimum-length-of-anagram-concatenation/>

> é¢˜æ„ï¼šç»™å®šä¸€ä¸ªç”±è‹¥å¹²ä¸ªåŒä½å­—ç¬¦ä¸² t ç»„æˆçš„å­—ç¬¦ä¸² sï¼Œé—®è¿™ä¸ªåŒä½å­—ç¬¦ä¸²æœ€çŸ­æ˜¯ä»€ä¹ˆï¼Ÿå®šä¹‰åŒä½å­—ç¬¦ä¸²ä¸ºå­—ç¬¦æ•°é‡ç›¸ç­‰ä¸”æ¯ç§å­—ç¬¦çš„æ•°é‡ç›¸ç­‰çš„å­—ç¬¦ä¸²
>
> é”™è¯¯æ€è·¯ï¼šå¾ˆæ˜¾ç„¶çš„ä¸€ä¸ªåˆ†é…é—®é¢˜ã€‚æˆ‘ä»¬é¢„ç»Ÿè®¡æ¯ä¸€ç§å­—ç¬¦çš„æ•°é‡ï¼Œå‡è®¾ç­”æ¡ˆåŒä½å­—ç¬¦ä¸²é•¿åº¦ä¸º lenï¼Œåˆ™æ˜¾ç„¶å°±éœ€è¦å°†æ‰€æœ‰çš„å­—ç¬¦ç­‰åˆ†ä¸º `s.size() / len` ä»½ï¼Œæ¯ä¸€ä»½çš„æ¯ä¸€ç§å­—ç¬¦æ•°é‡å‡ç›¸ç­‰ã€‚ä¹Ÿå°±æ˜¯æ¯ä¸€ç§å­—ç¬¦éƒ½éœ€è¦åˆ†ä¸º `s.size() / len` ä»½ã€‚ä¸ºäº†æœ€å°åŒ– lenï¼Œå°±éœ€è¦åˆ†å‡ºå°½å¯èƒ½å¤šçš„åŒä½å­—ç¬¦ä¸²ã€‚æ¯ä¸€ç§å­—ç¬¦å¯ä»¥åˆ†å‡ºçš„ä»½æ•°æ˜¯å…¶å› æ•°ï¼Œå–æ‰€æœ‰å­—ç¬¦å¯åˆ†å‡ºä»½æ•°çš„æœ€å¤§å€¼å°±æ˜¯æ±‚è§£æ¯ä¸€ç§å­—ç¬¦æ•°é‡çš„æœ€å¤§å…¬å› æ•°ï¼äºæ˜¯é—®é¢˜å°±è½¬åŒ–ä¸ºäº†æ±‚è§£æ¯ä¸€ç§å­—ç¬¦æ•°é‡çš„æœ€å¤§å…¬å› æ•°
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$
>
> æ­£ç¡®æ€è·¯ï¼šä¸Šè¿°æ€è·¯å¿½ç•¥äº†åŒä½å­—ç¬¦ä¸²å¿…é¡»å­˜åœ¨äºåŸå§‹å­—ç¬¦ä¸²ä¸­è¿™ä¸ªçº¦æŸã€‚æ­£ç¡®åšæ³•å°±æ›´åŠ æ— è„‘äº†ï¼Œç›´æ¥æšä¸¾å­—ç¬¦ä¸² s çš„æ¯ä¸€ä¸ªå› æ•°ï¼Œç„¶åæ£€æŸ¥æ‰€æœ‰é•¿åº¦çš„å­ä¸²æ˜¯å¦å¯ä»¥ä½œä¸ºåŒä½å­—ç¬¦ä¸²å³å¯
>
> æ—¶é—´å¤æ‚åº¦ï¼š$O(128 \times n)$

WA code

```cpp
class Solution {
public:
    int minAnagramLength(string s) {
        unordered_map<char, int> a;
        for (auto c: s) a[c]++;
        
        vector<int> v;
        for (auto& it: a) v.push_back(it.second);
        
        int gcd;
        if (v.size() == 1) gcd = v[0];
        else {
            gcd = __gcd(v[0], v[1]);
            for (int i = 2; i < v.size(); i++) {
                gcd = __gcd(gcd, v[i]);
            }
        }
        
        return s.size() / gcd;
    }
};
```

AC code

```cpp
class Solution {
public:
    int minAnagramLength(string s) {
        int n = s.size();
        
        vector<int> v;
        for (int i = 1; i <= n / i; i++) {
            if (n % i == 0) {
                v.push_back(i);
                v.push_back(n / i);
            }
        }

        int res = n + 1;

        for (int len: v) {
            bool ok = true;

            string pre = s.substr(0, len);
            sort(pre.begin(), pre.end());
            for (int i = len; i <= n - len; i += len) {
                string now = s.substr(i, len);
                sort(now.begin(), now.end());
                if (now != pre) {
                    ok = false;
                    break;
                }
            }

            if (ok) {
                res = min(res, len);
            }
        }

        return res;
    }
};
```
