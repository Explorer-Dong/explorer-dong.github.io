---
title: 进阶数据结构
---

## 并查集

## 拓展域并查集

参考：<https://www.luogu.com.cn/article/kx2if31n>

## 树状数组

## 线段树

## 二叉搜索树

二叉搜索树又叫二叉排序树、二叉查找树。

定义：根结点比左子树所有结点的值都大，比右子树所有结点的值都小。关键字唯一。

操作：增加、修改、查询、删除。

判定：想要判定一棵二叉树是否为二叉搜索树，只需要判断中序遍历的结果是不是递增的即可，可以采取中序遍历序列比对的方法，也可以在递归遍历二叉树的过程中通过记录前驱结点的值直接进行比较判断。时间复杂度 $O(n)$。

## 平衡二叉搜索树

**Treap**。二叉搜索树和堆的结合体。它通过维护两种性质来保持平衡：

>- **二叉搜索树性质**：每个节点的左子树的所有节点值小于该节点的值，右子树的所有节点值大于该节点的值。
>- **堆性质**：每个节点的优先级（通常随机生成）要大于或等于其子节点的优先级。
>
>**平衡机制**：
>
>- Treap 使用随机化优先级使得树的形状接近于理想的平衡树（期望树高为 $O(\log n)$）。
>- 通过旋转操作（左旋和右旋）在插入和删除时保持堆的性质。
>
>**优点**：
>
>- 实现相对简单。
>- 由于随机化的优先级，在期望情况下，树的高度是 $O(\log n)$。
>- 灵活性高，可以根据需要调整优先级函数。
>
>**缺点**：
>
>- 最坏情况下，树的高度可能退化为 $O(n)$（例如所有优先级相同或顺序生成的优先级），尽管发生概率很低。

**AVL 树**。是最早被发明出来的的自平衡二叉搜索树，1962 年由 Adelson-Velsky 和 Landis 发明。


定义：平衡因子为左子树的高度 - 右子树的高度，平衡二叉树的平衡因子绝对值 <= 1

构建：当插入结点进行构建时出现了有结点平衡因子的绝对值超过了 1，则进行“旋转”调整，旋转共分为 4 种

![旋转 - LL、LR](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202406292218546.png)

/// caption

旋转 - LL、LR

///

![旋转 - LR](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202406292218547.png)

/// caption

旋转 - LR

///

![旋转 - RL](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202406292218548.png)

/// caption

旋转 - RL

///

尝试模拟一遍下列序列的构造过程就可以理解了：

![例题](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202406292218549.png)

/// caption

例题

///

>- **平衡因子**：每个节点的左右子树高度差不能超过 $1$，且需要记录每个节点的高度。
>
>**平衡机制**：
>
>- 插入或删除节点后，如果某个节点的平衡因子不再为 $-1$、$0$ 或 $1$，就需要通过旋转（单旋转或双旋转）来恢复平衡。
>- 旋转操作包括：左旋转、右旋转、左右双旋转和右左双旋转。
>
>**优点**：
>
>- 严格的平衡条件保证了树的高度始终为 $O(\log n)$，因此搜索、插入和删除操作的时间复杂度为 $O(\log n)$。
>
>**缺点**：
>
>- 由于平衡条件严格，每次插入和删除后可能需要较多的旋转操作，从而导致实现较复杂，插入和删除操作的常数时间开销较大。

**红黑树**。一种较为宽松的自平衡二叉搜索树，由 Rudolf Bayer 于 1972 年发明。

> - **颜色属性**：每个节点都有红色或黑色两种颜色，通过这些颜色约束树的平衡性。
>
> **平衡机制**：
>
> - 通过遵循红黑树的五个性质来保持平衡：
>     1. 每个节点要么是红色，要么是黑色。
>     2. 根节点是黑色。
>     3. 叶子节点（NIL 节点）是黑色。
>     4. 如果一个节点是红色的，那么它的子节点必须是黑色（红节点不能连续出现）。
>     5. 从任一节点到其每个叶子节点的所有路径都包含相同数量的黑色节点。
> - 插入和删除操作可能破坏红黑树的性质，需要通过重新着色和旋转来恢复平衡。
>
> **优点**：
>
> - 红黑树的高度最多是 $\Theta (2  \log n)$，因此搜索、插入和删除操作的时间复杂度仍为 $O(\log n)$。
> - 由于平衡条件较为宽松，插入和删除操作需要的旋转操作通常比 AVL 树少，效率更高。
>
> **缺点**：
>
> - 实现较复杂，特别是插入和删除的平衡修复过程。
> - 虽然红黑树的搜索效率与 AVL 树相似，但由于平衡条件较宽松，实际应用中的树高度通常略高于 AVL 树，因此搜索操作的效率稍低。
